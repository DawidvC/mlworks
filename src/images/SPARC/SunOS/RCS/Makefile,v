head	1.71;
access;
symbols
	MLW_daveb_inline_1_4_99:1.71.1
	MLWorks_21c0_1999_03_25:1.71
	MLWorks_20c1_1998_08_20:1.66
	MLWorks_20c0_1998_08_04:1.66
	MLWorks_20b2c2_1998_06_19:1.66
	MLWorks_20b2_Windows_1998_06_12:1.66
	MLWorks_20b1c1_1998_05_07:1.65
	MLWorks_20b0_1998_04_07:1.62
	MLWorks_20b0_1998_03_20:1.61
	MLWorks_20m2_1998_02_16:1.57
	MLWorks_20m1_1997_10_23:1.55
	MLWorks_11r1:1.51.1.1.1.2.1
	MLWorks_workspace_97:1.55.2
	MLWorks_dt_wizard:1.55.1
	MLWorks_11c0_1997_09_09:1.51.1.1.1.2
	MLWorks_10r3:1.51.1.1.3
	MLWorks_10r2_551:1.51.1.1.2
	MLWorks_11:1.51.1.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.51.1.1
	MLWorks_20m0_1997_06_20:1.55
	MLWorks_1_0_r2c2_1997_06_14:1.51.1.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.51.1.1
	MLWorks_1_0_r2c1_1997_05_12:1.51.1
	MLWorks_BugFix_1997_04_24:1.51
	MLWorks_1_0_r2_Win32_1997_04_11:1.51
	MLWorks_1_0_r2_Unix_1997_04_04:1.51
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.49.3.1.1
	MLWorks_gui_1996_12_18:1.49.4
	MLWorks_1_0_Win32_1996_12_17:1.49.3
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.49.1.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.49.1.1
	MLWorks_1_0_Irix_1996_11_28:1.49.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.49.2
	MLWorks_1_0_Unix_1996_11_14:1.49.1
	MLWorks_Open_Beta2_1996_10_11:1.48.1
	MLWorks_License_dev:1.46.2
	MLWorks_1_open_beta_1996_09_13:1.46.1
	MLWorks_Open_Beta_1996_08_22:1.45
	MLWorks_Beta_1996_07_02:1.44
	MLWorks_Beta_1996_06_07:1.44
	MLWorks_Beta_1996_06_06:1.44
	MLWorks_Beta_1996_06_05:1.44
	MLWorks_Beta_1996_06_03:1.42
	MLWorks_Beta_1996_05_31:1.42
	MLWorks_Beta_1996_05_30:1.42;
locks; strict;
comment	@# @;


1.71
date	99.03.08.11.02.06;	author mitchell;	state Exp;
branches
	1.71.1.1;
next	1.70;

1.70
date	99.02.12.10.36.23;	author mitchell;	state Exp;
branches;
next	1.69;

1.69
date	98.10.21.13.44.04;	author jont;	state Exp;
branches;
next	1.68;

1.68
date	98.10.19.15.19.05;	author jont;	state Exp;
branches;
next	1.67;

1.67
date	98.08.25.13.10.58;	author jont;	state Exp;
branches;
next	1.66;

1.66
date	98.06.08.12.20.08;	author mitchell;	state Exp;
branches;
next	1.65;

1.65
date	98.05.06.14.51.02;	author jkbrook;	state Exp;
branches;
next	1.64;

1.64
date	98.04.20.12.27.46;	author jont;	state Exp;
branches;
next	1.63;

1.63
date	98.04.07.14.46.39;	author jont;	state Exp;
branches;
next	1.62;

1.62
date	98.03.31.12.01.03;	author jont;	state Exp;
branches;
next	1.61;

1.61
date	98.03.12.12.18.48;	author johnh;	state Exp;
branches;
next	1.60;

1.60
date	98.02.23.13.52.20;	author johnh;	state Exp;
branches;
next	1.59;

1.59
date	98.02.18.17.51.03;	author jont;	state Exp;
branches;
next	1.58;

1.58
date	98.02.10.16.31.40;	author jont;	state Exp;
branches;
next	1.57;

1.57
date	98.01.28.12.21.50;	author johnh;	state Exp;
branches;
next	1.56;

1.56
date	97.10.21.12.00.46;	author jont;	state Exp;
branches;
next	1.55;

1.55
date	97.05.29.16.15.30;	author jkbrook;	state Exp;
branches
	1.55.1.1
	1.55.2.1;
next	1.54;

1.54
date	97.05.23.10.14.32;	author jont;	state Exp;
branches;
next	1.53;

1.53
date	97.05.16.10.48.41;	author stephenb;	state Exp;
branches;
next	1.52;

1.52
date	97.05.08.17.15.30;	author jont;	state Exp;
branches;
next	1.51;

1.51
date	97.01.15.15.17.48;	author io;	state Exp;
branches
	1.51.1.1;
next	1.50;

1.50
date	96.12.18.13.36.13;	author matthew;	state Exp;
branches;
next	1.49;

1.49
date	96.10.23.13.25.28;	author jont;	state Exp;
branches
	1.49.1.1
	1.49.2.1
	1.49.3.1
	1.49.4.1;
next	1.48;

1.48
date	96.10.09.14.16.15;	author jont;	state Exp;
branches
	1.48.1.1;
next	1.47;

1.47
date	96.10.08.13.54.20;	author stephenb;	state Exp;
branches;
next	1.46;

1.46
date	96.09.04.14.25.07;	author jont;	state Exp;
branches
	1.46.1.1
	1.46.2.1;
next	1.45;

1.45
date	96.08.09.16.01.15;	author daveb;	state Exp;
branches;
next	1.44;

1.44
date	96.06.04.10.05.04;	author jont;	state Exp;
branches;
next	1.43;

1.43
date	96.06.04.09.36.39;	author jont;	state Exp;
branches;
next	1.42;

1.42
date	96.05.21.09.34.14;	author jont;	state Exp;
branches;
next	1.41;

1.41
date	96.05.17.09.41.54;	author stephenb;	state Exp;
branches;
next	1.40;

1.40
date	96.05.17.07.25.29;	author stephenb;	state Exp;
branches;
next	1.39;

1.39
date	96.05.16.16.49.25;	author jont;	state Exp;
branches;
next	1.38;

1.38
date	96.05.15.15.23.35;	author jont;	state Exp;
branches;
next	1.37;

1.37
date	96.04.29.12.10.07;	author jont;	state Exp;
branches;
next	1.36;

1.36
date	96.04.18.17.04.46;	author jont;	state Exp;
branches;
next	1.35;

1.35
date	96.03.28.13.18.19;	author stephenb;	state Exp;
branches;
next	1.34;

1.34
date	96.03.19.11.50.42;	author stephenb;	state Exp;
branches;
next	1.33;

1.33
date	96.03.18.14.33.41;	author daveb;	state Exp;
branches;
next	1.32;

1.32
date	96.03.15.17.09.51;	author daveb;	state Exp;
branches;
next	1.31;

1.31
date	96.03.11.17.05.02;	author daveb;	state Exp;
branches;
next	1.30;

1.30
date	96.03.05.16.32.34;	author jont;	state Exp;
branches;
next	1.29;

1.29
date	96.02.23.16.06.44;	author daveb;	state Exp;
branches;
next	1.28;

1.28
date	96.02.21.11.19.30;	author jont;	state Exp;
branches;
next	1.27;

1.27
date	96.01.30.15.24.31;	author jont;	state Exp;
branches;
next	1.26;

1.26
date	96.01.19.17.01.45;	author stephenb;	state Exp;
branches;
next	1.25;

1.25
date	96.01.09.12.23.35;	author matthew;	state Exp;
branches;
next	1.24;

1.24
date	95.12.13.14.43.01;	author jont;	state Exp;
branches;
next	1.23;

1.23
date	95.12.06.12.42.22;	author daveb;	state Exp;
branches;
next	1.22;

1.22
date	95.11.20.17.30.36;	author daveb;	state Exp;
branches;
next	1.21;

1.21
date	95.08.14.12.29.28;	author jont;	state Exp;
branches;
next	1.20;

1.20
date	95.07.20.11.50.36;	author jont;	state Exp;
branches;
next	1.19;

1.19
date	95.07.19.16.17.02;	author jont;	state Exp;
branches;
next	1.18;

1.18
date	95.07.18.09.18.53;	author jont;	state Exp;
branches;
next	1.17;

1.17
date	95.05.31.12.24.58;	author matthew;	state Exp;
branches;
next	1.16;

1.16
date	95.05.29.15.32.11;	author brianm;	state Exp;
branches;
next	1.15;

1.15
date	95.05.05.14.14.59;	author daveb;	state Exp;
branches;
next	1.14;

1.14
date	95.05.03.15.39.18;	author jont;	state Exp;
branches;
next	1.13;

1.13
date	95.04.20.17.30.24;	author daveb;	state Exp;
branches;
next	1.12;

1.12
date	95.03.08.12.17.49;	author matthew;	state Exp;
branches;
next	1.11;

1.11
date	95.03.02.14.25.03;	author matthew;	state Exp;
branches;
next	1.10;

1.10
date	95.03.01.11.49.34;	author jont;	state Exp;
branches;
next	1.9;

1.9
date	95.02.13.13.12.43;	author jont;	state Exp;
branches;
next	1.8;

1.8
date	95.02.10.14.00.07;	author jont;	state Exp;
branches;
next	1.7;

1.7
date	95.02.10.12.57.44;	author jont;	state Exp;
branches;
next	1.6;

1.6
date	95.02.08.15.59.11;	author jont;	state Exp;
branches;
next	1.5;

1.5
date	95.02.08.15.01.39;	author matthew;	state Exp;
branches;
next	1.4;

1.4
date	95.02.02.16.47.37;	author jont;	state Exp;
branches;
next	1.3;

1.3
date	95.02.02.13.08.56;	author jont;	state Exp;
branches;
next	1.2;

1.2
date	95.02.01.17.22.28;	author jont;	state Exp;
branches;
next	1.1;

1.1
date	95.02.01.17.13.52;	author jont;	state Exp;
branches;
next	;

1.46.1.1
date	96.09.13.11.27.08;	author hope;	state Exp;
branches;
next	;

1.46.2.1
date	96.10.07.16.17.41;	author hope;	state Exp;
branches;
next	;

1.48.1.1
date	96.10.17.11.37.34;	author hope;	state Exp;
branches;
next	;

1.49.1.1
date	96.11.14.13.05.27;	author hope;	state Exp;
branches
	1.49.1.1.1.1;
next	;

1.49.1.1.1.1
date	96.11.28.15.15.02;	author hope;	state Exp;
branches;
next	;

1.49.2.1
date	96.11.22.18.22.55;	author hope;	state Exp;
branches;
next	;

1.49.3.1
date	96.12.17.18.00.58;	author hope;	state Exp;
branches
	1.49.3.1.1.1;
next	;

1.49.3.1.1.1
date	97.02.24.11.52.40;	author hope;	state Exp;
branches;
next	;

1.49.4.1
date	96.12.18.09.56.20;	author hope;	state Exp;
branches;
next	;

1.51.1.1
date	97.05.12.10.51.02;	author hope;	state Exp;
branches
	1.51.1.1.1.1
	1.51.1.1.2.1
	1.51.1.1.3.1;
next	;

1.51.1.1.1.1
date	97.07.28.18.33.07;	author daveb;	state Exp;
branches;
next	1.51.1.1.1.2;

1.51.1.1.1.2
date	97.08.06.17.53.53;	author daveb;	state Exp;
branches
	1.51.1.1.1.2.1.1;
next	;

1.51.1.1.1.2.1.1
date	97.10.07.11.59.06;	author jkbrook;	state Exp;
branches;
next	;

1.51.1.1.2.1
date	97.09.08.17.26.13;	author daveb;	state Exp;
branches;
next	;

1.51.1.1.3.1
date	97.09.09.14.23.01;	author daveb;	state Exp;
branches;
next	;

1.55.1.1
date	97.09.10.19.42.00;	author brucem;	state Exp;
branches;
next	;

1.55.2.1
date	97.09.11.21.09.31;	author daveb;	state Exp;
branches;
next	1.55.2.2;

1.55.2.2
date	97.09.12.14.52.41;	author johnh;	state Exp;
branches;
next	1.55.2.3;

1.55.2.3
date	97.09.17.16.55.54;	author daveb;	state Exp;
branches;
next	1.55.2.4;

1.55.2.4
date	97.10.29.14.23.16;	author daveb;	state Exp;
branches;
next	1.55.2.5;

1.55.2.5
date	97.11.25.14.24.01;	author daveb;	state Exp;
branches;
next	1.55.2.6;

1.55.2.6
date	97.11.25.20.26.01;	author daveb;	state Exp;
branches;
next	1.55.2.7;

1.55.2.7
date	97.11.26.17.32.20;	author daveb;	state Exp;
branches;
next	1.55.2.8;

1.55.2.8
date	98.01.19.14.59.05;	author daveb;	state Exp;
branches;
next	;

1.71.1.1
date	99.04.01.18.08.17;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
New architecture and OS specific Makefile
@


1.71
log
@[Bug #30286]
Export Unix structure
@
text
@# ==== BUILD MLWORKS IMAGES ====
#
# Instructions
# ------------
# This makefile builds images in the usual way, but has extra targets
# called *-files for producing files containing lists of .mo's for use
# with the runtime system `-from' option.  This makes debugging using
# adb possible since adb will not accept the massive command lines
# generated for the normal rules.
#
# To build images from a source tree other than `..' use:
#
#   make SRC='source directory name' target...
#
# To build the file list for the parser relative to /usr/sml, for
# example, use:
#
#   make SRC=/usr/sml parser-files
#
# $Id: SPARC:SunOS:Makefile,v 1.70 1999/02/12 10:36:23 mitchell Exp $
#
#

all: pervasive.img lexer.img gui.img batch.img guib.img basis.img foreign.img xm.img

PLATFORM_DISTRIBUTED_IMAGES = xm.img

RUNTIME =	$(SRC)/rts/runtime-g
RUNTIMEOPTS =	-verbose -d 1 -delivery -batch
MODE = 		Release

LEXERSYS = 	basis/__sys_word \
		unix/unixos \
		unix/_unixos \
		unix/__unixos 
   
BASISSYS = 

BASISSYS2 = 	unix/unix \
		unix/__unix

INTERSYS = 	main/stack_interface \
		sparc/_stack_interface \
		sparc/__stack_interface \
		editor/editor \
		unix/_editor \
		unix/__editor

COMPILER1 =	utils/getenv \
		utils/messages \
		utils/__messages \
		unix/_unixgetenv \
		unix/__getenv \
		sparc/machtypes \
		sparc/_machtypes \
		sparc/__machtypes \
		main/machspec \
		utils/bignum \
		utils/_bignum \
		utils/__bignum_inf \
		sparc/_machspec \
		sparc/__machspec \
		utils/_bignumsize \
		utils/__bignum \
		basics/scons \
		basics/_scons \
		basics/__scons \
		debugger/debugger_types \
		debugger/_debugger_types \
		debugger/__debugger_types \
		lambda/lambdaprint \
		lambda/_lambdaprint \
		lambda/__lambdaprint \
		lambda/environprint \
		lambda/_environprint \
		lambda/__environprint \
		match/type_utils \
		match/_type_utils \
		match/__type_utils \
		match/match \
		match/_match \
		match/__match \
		lambda/lambda \
		lambda/lambdaoptimiser \
		typechecker/typerep_utils \
		typechecker/_typerep_utils \
		typechecker/__typerep_utils \
		rts/gen/implicit \
		rts/gen/__implicit \
		utils/inthashtable \
		utils/_inthashtable \
		utils/__inthashtable

COMPILER = $(COMPILER1) main/mlworks_io \
		main/_mlworks_io \
		main/__mlworks_io \
		lambda/_lambda \
		lambda/simpleutils \
		lambda/_simpleutils \
		lambda/__simpleutils \
		lambda/transsimple \
		lambda/_transsimple \
		lambda/__transsimple \
		lambda/lambdaflow \
		lambda/_lambdaflow \
		lambda/__lambdaflow \
		lambda/_simplelambda \
		lambda/__lambdaoptimiser \
		lambda/__lambda \
		utils/monoset \
		utils/intset \
		utils/_intsetlist \
		utils/mutablemonoset \
		harp/virtualregister \
		utils/mutableintset \
		harp/_virtualregister \
		harp/mirtypes \
		harp/_mirtypes \
		utils/_smallintset \
		harp/__mirtypes \
		main/machperv \
		sparc/_machperv \
		sparc/__machperv \
		rts/gen/tags \
		rts/gen/__tags \
		debugger/debugger_utilities \
		debugger/_debugger_utilities \
		debugger/__debugger_utilities \
		lambda/auglambda \
		lambda/_auglambda \
		lambda/__auglambda \
		main/library \
		main/_library \
		main/__library \
		harp/mirregisters \
		harp/_mirregisters \
		harp/__mirregisters \
		harp/mirprint \
		harp/_mirprint \
		harp/__mirprint \
		harp/mir_env \
		harp/_mir_env \
		harp/__mir_env \
		harp/mir_utils \
		harp/_mir_utils \
		harp/__mir_utils \
		harp/mirtables \
		harp/_mirtables \
		harp/__mirtables \
		harp/mir_cg \
		harp/_mir_cg \
		harp/__mir_cg \
		harp/mirprocedure \
		harp/registerpack \
		harp/_mirprocedure \
		harp/_registerpack \
		harp/__registerpack \
		harp/__mirprocedure \
		harp/registerallocator \
		harp/mirvariable \
		harp/_mirvariable \
		harp/registercolourer \
		harp/_registercolourer \
		harp/_registerallocator \
		utils/__smallintset \
		harp/__gccolourer \
		harp/__nongccolourer \
		harp/__fpcolourer \
		harp/__registerallocator \
		harp/__mirvariable \
		harp/stackallocator \
		harp/_stackallocator \
		harp/__stackallocator \
		harp/mirexpr \
		harp/_mirexpr \
		harp/__mirexpr \
		harp/miroptimiser \
		harp/_miroptimiser \
		harp/__miroptimiser \
		main/reals \
		main/_reals \
		main/__reals \
		main/code_module \
		main/__code_module \
		sparc/sparc_opcodes \
		sparc/_sparc_opcodes \
		sparc/__sparc_opcodes \
		sparc/sparc_assembly \
		sparc/_sparc_assembly \
		sparc/__sparc_assembly \
		sparc/sparc_schedule \
		sparc/_sparc_schedule \
		sparc/__sparc_schedule \
		main/mach_cg \
		sparc/_mach_cg \
		sparc/__sparc_mach_cg \
		sparc/__mach_cg \
		main/machprint \
		sparc/_machprint \
		sparc/__sparc_machprint \
		sparc/__machprint \
		rts/gen/__objectfile \
		rts/gen/objectfile \
		lambda/lambdamodule \
		lambda/_lambdamodule \
		lambda/__lambdamodule \
		main/enc_sub \
		main/_enc_sub \
		main/__enc_sub \
		basis/byte \
		basis/__byte \
		basis/__bin_stream_io \
		basis/bin_io \
		basis/_bin_io \
		basis/__bin_io \
		main/encapsulate \
		main/_encapsulate \
		main/__encapsulate \
		main/compiler \
		main/_compiler \
		main/__compiler \
		make/depend \
		make/_depend \
		make/__depend \
		utils/terminal \
		utils/__terminal \
                main/sectioned_file \
                main/_sectioned_file \
                main/__sectioned_file \
		main/proj_file \
		main/_proj_file \
		main/__proj_file \
		main/file_time \
		unix/__file_time \
		main/link_support \
		unix/_unix_link_support \
		unix/__link_support \
		dependency/module_name \
		dependency/_module_name \
		dependency/__module_name \
		dependency/module_dec \
		dependency/_module_dec \
		dependency/__module_dec \
		dependency/import_export \
		dependency/_import_export \
		dependency/__import_export \
		dependency/convert_ast \
		dependency/_convert_ast \
		dependency/__convert_ast \
		dependency/module_dec_io \
		dependency/_module_dec_io \
		dependency/__module_dec_io \
		dependency/ordered_set \
		dependency/__ordered_set \
		dependency/group_dag \
		dependency/_group_dag \
		main/project \
		main/_project \
		main/__project \
		main/object_output \
		sparc/__object_output \
		main/toplevel \
		main/_toplevel \
		main/__toplevel \
		main/version \
		main/__version \
		main/user_options \
		main/_user_options \
		main/__user_options

SYSTEM = unix

# ARCH_OS might be already set by the Solaris makefile, which includes
# this one.
ifeq (,$(ARCH_OS))
  ARCH_OS = SPARC/SunOS
endif

include ../../GNUmake

shell-files: force
	echo $(COMPILERMO) $(SHELLMO) > $@@

tty2-files: force
	echo $(INTERMO) $(TTYMO) > tty2-files

SET_PERVASIVE = MLWORKS_PERVASIVE=`pwd`/$(SRC)/pervasive/; \
                export MLWORKS_PERVASIVE

shell.img: typechecker.img $(COMPILERMO) $(SHELLMO)
	echo make: $@@
	$(SET_PERVASIVE)   ;    \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load typechecker.img -save $@@ \
		$(COMPILERMO) $(SHELLMO) MLWargs

TTY_LOADER = 'Shell.saveImage("tty.img", false);'

tty.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
	echo make: $@@ from typechecker.img
	$(SET_PERVASIVE)   ;    \
	echo $(TTY_LOADER) |    \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO) MLWargs

TTYB_LOADER = 'Shell.Project.openProject "$(SRC)/basis.mlp"; \
               Shell.Project.setConfiguration "$(ARCH_OS)"; \
               Shell.Project.setTargets ["require_all.sml", \
                                         "platform_specific_exports.sml"]; \
               Shell.Project.loadAll () ; \
               Shell.saveImage("ttyb.img", false);'

ttyb.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO) $(BASIS_AND_LOADERMO)
	echo make: $@@ from typechecker.img
	$(SET_PERVASIVE)      ;      \
	echo $(TTYB_LOADER) |      \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO) MLWargs

tty2.img: shell.img $(INTERMO) $(TTYMO)
	echo make: $@@ from shell.img
	echo $(TTY_LOADER) |    \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load shell.img \
		 $(INTERMO) $(TTYMO) MLWargs

GUI_LOADER = 'Shell.saveImage("gui.img", false);'

gui.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO)
	echo make: $@@ from typechecker.img
	$(SET_PERVASIVE)     ;      \
	echo $(GUI_LOADER) |      \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) MLWargs

GUIB_LOADER = 'Shell.Project.openProject "$(SRC)/basis.mlp"; \
               Shell.Project.setConfiguration "$(ARCH_OS)"; \
               Shell.Project.setTargets ["require_all.sml", \
                                         "platform_specific_exports.sml"]; \
               Shell.Project.loadAll () ; \
               Shell.saveImage("guib.img", false);'

guib.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) $(BASIS_AND_LOADERMO)
	echo make: $@@ from typechecker.img
	$(SET_PERVASIVE)      ;      \
	echo $(GUIB_LOADER) |      \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) MLWargs

gui2.img: shell.img $(INTERMO) $(XGUIMO)
	echo make: $@@ from shell.img
	echo $(GUI_LOADER) |      \
	$(RUNTIME) -MLWpass MLWargs $(RUNTIMEOPTS) -load shell.img \
		$(INTERMO) $(XGUIMO) MLWargs
@


1.71.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.71 1999/03/08 11:02:06 mitchell Exp $
@


1.70
log
@[Bug #190507]
Add new dependency files to makefile.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.69 1998/10/21 13:44:04 jont Exp $
d35 3
a37 1
		unix/__unixos
d39 2
a40 1
BASISSYS =
d307 2
a308 1
               Shell.Project.setTargets ["require_all.sml"]; \
d336 2
a337 1
               Shell.Project.setTargets ["require_all.sml"]; \
@


1.69
log
@[Bug #70196]
Add link support stuff
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.68 1998/10/19 15:19:05 jont Exp $
d235 19
@


1.68
log
@[Bug #70203]
Modify for alternative argument scheme
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.67 1998/08/25 13:10:58 jont Exp $
d232 3
@


1.67
log
@[Bug #70133]
Add COFF outputter
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.66 1998/06/08 12:20:08 mitchell Exp $
a264 2
CALL_RUNTIME  = $(RUNTIME) $(RUNTIMEOPTS)

d268 2
a269 3
	$(CALL_RUNTIME) -load typechecker.img -save $@@ \
		$(COMPILERMO) $(SHELLMO)

d277 2
a278 3
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)

a285 1

d290 2
a291 2
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
d296 2
a297 3
	$(CALL_RUNTIME) -load shell.img \
		 $(INTERMO) $(TTYMO)

d301 1
a301 1
gui.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) 
d305 2
a306 3
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO)

d318 2
a319 2
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO)
d321 1
a321 1
gui2.img: shell.img $(INTERMO) $(XGUIMO) 
d324 2
a325 3
	$(CALL_RUNTIME) -load shell.img \
		$(INTERMO) $(XGUIMO)

@


1.66
log
@[Bug #30418]
Add sectioned_file etc
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.65 1998/05/06 14:51:02 jkbrook Exp $
d235 2
@


1.65
log
@[Bug #30354]
Temporarily restore old FI to distribution
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.64 1998/04/20 12:27:46 jont Exp $
d224 3
@


1.64
log
@[Bug #70101]
Move getenv and messages into compiler and out of basi and parser
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.63 1998/04/07 14:46:39 jont Exp $
d24 1
a24 1
all: pervasive.img lexer.img gui.img batch.img guib.img basis.img xm.img
@


1.63
log
@[Bug #30312]
Add main/file_time and system/__file_time
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.62 1998/03/31 12:01:03 jont Exp $
a36 6
PARSERSYS =	utils/getenv \
		utils/messages \
		utils/__messages \
		unix/_unixgetenv \
		unix/__getenv

d46 6
a51 1
COMPILER1 =	sparc/machtypes \
@


1.62
log
@[Bug #70077]
Removing path, _unixpath, _win_ntpath and __path
These are replaced by OS.Path
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.61 1998/03/12 12:18:48 johnh Exp $
d228 2
@


1.61
log
@[Bug #30365]
Projects now use subprojects.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.60 1998/02/23 13:52:20 johnh Exp $
d41 1
a41 2
		unix/__getenv \
		unix/_unixpath
@


1.60
log
@[Bug #30362]
Add mode setting which also changes where the object files will live.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.59 1998/02/18 17:51:03 jont Exp $
d279 1
a279 1
TTYB_LOADER = 'Shell.Project.openProject "$(SRC)/mlworks.mlp"; \
d310 1
a310 1
GUIB_LOADER = 'Shell.Project.openProject "$(SRC)/mlworks.mlp"; \
@


1.59
log
@[Bug #70070]
Add terminal.mo and __terminal.mo to COMPILER
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.58 1998/02/10 16:31:40 jont Exp $
d30 1
@


1.58
log
@[Bug #70065]
Load messages and __messages before getenv
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.57 1998/01/28 12:21:50 johnh Exp $
d223 2
@


1.57
log
@[Bug #30071]
Merge in Project Workspace changes.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.56 1997/10/21 12:00:46 jont Exp $
d37 2
@


1.56
log
@[Bug #30089]
Removing OldOS
@
text
@d20 1
a20 2
# $Id: SPARC:SunOS:Makefile,v 1.55 1997/05/29 16:15:30 jkbrook Exp $
#
d90 3
a92 6
COMPILER = $(COMPILER1) main/io \
		main/_io \
		main/__io \
		basics/module \
		basics/_module \
		basics/__module \
d221 3
d238 6
a251 3
SET_SOURCE    = MLWORKS_SRC_PATH=`pwd`/$(SRC)/; \
                export MLWORKS_SRC_PATH

a254 3
SET_OBJECT    = MLWORKS_OBJ_PATH=%S/%C/$(ARCH_OS) ; \
		export MLWORKS_OBJ_PATH

a258 1
	$(SET_SOURCE)      ;    \
a259 1
	$(SET_OBJECT)	   ;    \
a267 2
	$(SET_SOURCE)      ;    \
	$(SET_OBJECT)	   ;    \
d274 6
a279 2
TTYB_LOADER = 'Shell.File.loadObject "../../../basis/require_all"; \
                 Shell.saveImage("ttyb.img", false);'
a282 2
	$(SET_SOURCE)         ;      \
	$(SET_OBJECT)	      ;    \
a298 2
	$(SET_SOURCE)        ;      \
	$(SET_OBJECT)	     ;    \
d305 5
a309 3

GUIB_LOADER = 'Shell.File.loadObject "../../../basis/require_all"; \
                 Shell.saveImage("guib.img", false);'
a312 2
	$(SET_SOURCE)         ;      \
	$(SET_OBJECT)	      ;    \
@


1.55
log
@[Bug #01749]
Moved __sys_word to LEXERSYS from LEXER1 in images/GNUmake
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.54 1997/05/23 10:14:32 jont Exp $
a64 3
		make/old_os \
		unix/_unix \
		unix/__old_os \
@


1.55.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55 1997/05/29 16:15:30 jkbrook Exp $
@


1.55.2.2
log
@[Bug #30071]
Redesign Compilation Manager -> Project Workspace.
New files: main/*proj_file.sml
@
text
@a233 3
		main/proj_file \
		main/_proj_file \
		main/__proj_file \
@


1.55.2.3
log
@[Bug #30071]
*project now requires proj_file (instead of the other way around).
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.2 1997/09/12 14:52:41 johnh Exp $
a227 3
		main/proj_file \
		main/_proj_file \
		main/__proj_file \
d234 3
@


1.55.2.4
log
@[Bug #30089]
Merged from trunk:
Removing OldOs.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.3 1997/09/17 16:55:54 daveb Exp $
d65 3
@


1.55.2.5
log
@[Bug #30326]
Renamed utils/*timer to utils/*mlworks_timer and main/*io to main/*mlworks_io.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.4 1997/10/29 14:23:16 daveb Exp $
d91 3
a93 3
COMPILER = $(COMPILER1) main/mlworks_io \
		main/_mlworks_io \
		main/__mlworks_io \
@


1.55.2.6
log
@[Bug #30071]
Source and object paths are redundant.  Need to use Shell.Project to build
guib.img.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.5 1997/11/25 14:24:01 daveb Exp $
d250 3
d256 3
d263 1
d265 1
d274 2
d287 2
d305 2
d313 3
a315 5
GUIB_LOADER = 'Shell.Project.openProject "../../../mlworks.mlp"; \
               Shell.Project.setConfiguration "SPARC/Solaris"; \
               Shell.Project.setTargets ["require_all.sml"]; \
               Shell.Project.loadAll () ; \
               Shell.saveImage("guib.img", false);'
d319 2
@


1.55.2.7
log
@[Bug #30071]
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.6 1997/11/25 20:26:01 daveb Exp $
d94 3
@


1.55.2.8
log
@[Bug #30071]
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55.2.7 1997/11/26 17:32:20 daveb Exp $
a238 6
# ARCH_OS might be already set by the Solaris makefile, which includes
# this one.
ifeq (,$(ARCH_OS))
  ARCH_OS = SPARC/SunOS
endif

d269 2
a270 6
TTYB_LOADER = 'Shell.Project.openProject "$(SRC)/mlworks.mlp"; \
               Shell.Project.setConfiguration "$(ARCH_OS)"; \
               Shell.Project.setTargets ["require_all.sml"]; \
               Shell.Project.loadAll () ; \
               Shell.saveImage("ttyb.img", false);'

d296 2
a297 2
GUIB_LOADER = 'Shell.Project.openProject "$(SRC)/mlworks.mlp"; \
               Shell.Project.setConfiguration "$(ARCH_OS)"; \
@


1.55.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.55 1997/05/29 16:15:30 jkbrook Exp $
@


1.54
log
@[Bug #30090]
Replace MLWorks.IO with TextIO where applicable
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.53 1997/05/16 10:48:41 stephenb Exp $
d32 2
a33 1
LEXERSYS =	unix/unixos \
@


1.53
log
@[Bug #30121]
Move to new FI: remove any reference to foreign.img
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.52 1997/05/08 17:15:30 jont Exp $
d32 1
a32 4
PARSERSYS =	basis/__word8 \
		basis/mono_vector \
		basis/__word8_vector \
		unix/unixos \
d34 3
a36 2
		unix/__unixos \
		utils/getenv \
a211 4
		basis/mono_array \
		basis/__word8_array \
		basis/substring \
		basis/__substring \
a213 17
		basis/__word8 \
		basis/__word8_vector \
		basis/__char_vector \
		basis/__char_array \
		basis/prim_io \
		basis/_prim_io \
		basis/__position \
		basis/__bin_prim_io \
		basis/io \
		basis/__io \
		basis/stream_io \
		basis/imperative_io \
		basis/_imperative_io \
		basis/os_prim_io \
		basis/__text_prim_io \
		unix/__os_prim_io \
		basis/_stream_io \
@


1.52
log
@[Bug #30091]
Make __byte available to _encapsulate
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51 1997/01/15 15:17:48 io Exp $
d25 3
a27 1
all: pervasive.img lexer.img gui.img batch.img guib.img basis.img foreign.img xm.img
a302 12
TTYI_LOADER = 'Shell.File.loadSource "../../../foreign/__foreign"; \
               Shell.saveImage("ttyi.img", false);'

ttyi.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
	echo make: $@@ from typechecker.img
	$(SET_SOURCE)       ;    \
	$(SET_OBJECT)	    ;    \
	$(SET_PERVASIVE)    ;    \
	echo $(TTYI_LOADER) |    \
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)

a334 11
GUII_LOADER = 'Shell.File.loadSource "../../../foreign/__foreign"; \
                 Shell.saveImage("guii.img", false);'

guii.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) 
	echo make: $@@ from typechecker.img
	$(SET_SOURCE)         ;      \
	$(SET_OBJECT)	      ;    \
	$(SET_PERVASIVE)      ;      \
	echo $(GUII_LOADER) |      \
	$(CALL_RUNTIME) -load typechecker.img \
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO)
@


1.51
log
@[Bug #1892]
rename __word{8,16,32}{array,vector} to __word{8,16,32}_{array,vector}
       __pre{integer,int32,real,word{,32}} to __pre_{int{,32},real,word{,32}}
       __pack{8,16,32}{big,little} to __pack{8,16,32}_{big,little}
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.50 1996/12/18 13:36:13 matthew Exp $
d39 1
a39 1
 		unix/_unixpath
a46 6
		basis/mono_array \
		basis/__word8_array \
		basis/substring \
		basis/__substring \
		basis/byte \
		basis/__byte \
d128 3
a130 3
 		debugger/debugger_utilities \
 		debugger/_debugger_utilities \
 		debugger/__debugger_utilities \
d212 27
d245 6
a250 6
                make/depend \
                make/_depend \
                make/__depend \
                main/project \
                main/_project \
                main/__project \
@


1.51.1.1
log
@branched from 1.51
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51 1997/01/15 15:17:48 io Exp $
@


1.51.1.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51.1.1 1997/05/12 10:51:02 hope Exp $
@


1.51.1.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51.1.1 1997/05/12 10:51:02 hope Exp $
@


1.51.1.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51.1.1 1997/05/12 10:51:02 hope Exp $
@


1.51.1.1.1.2
log
@[Bug #30190]
Removed FI from Student Edition.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51.1.1.1.1 1997/07/28 18:33:07 daveb Exp $
d25 1
a25 1
all: pervasive.img lexer.img gui.img batch.img guib.img basis.img xm.img
d280 13
d320 13
@


1.51.1.1.1.2.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.51.1.1.1.2 1997/08/06 17:53:53 daveb Exp $
@


1.50
log
@lambda optimizer changes
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49 1996/10/23 13:25:28 jont Exp $
d32 1
a32 1
		basis/__word8vector \
d48 1
a48 1
		basis/__word8array \
@


1.49
log
@[Bug #1696]
Add -batch to RUNTIMEOPTS
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.48 1996/10/09 14:16:15 jont Exp $
a88 1
		lambda/lambdasub \
a105 5
		lambda/_lambdasub \
		lambda/__lambdasub \
		lambda/simplelambdatypes \
		lambda/_simplelambdatypes \
		lambda/__simplelambdatypes \
d112 3
a142 6
		lambda/interproc \
		lambda/_interproc \
		lambda/__interproc \
		lambda/tail \
		lambda/_tail \
		lambda/__tail \
@


1.49.4.1
log
@branched from 1.49
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49 1996/10/23 13:25:28 jont Exp $
@


1.49.3.1
log
@branched from 1.49
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49 1996/10/23 13:25:28 jont Exp $
@


1.49.3.1.1.1
log
@branched from 1.49.3.1
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49.3.1 1996/12/17 18:00:58 hope Exp $
@


1.49.2.1
log
@branched from 1.49
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49 1996/10/23 13:25:28 jont Exp $
@


1.49.1.1
log
@branched from 1.49
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49 1996/10/23 13:25:28 jont Exp $
@


1.49.1.1.1.1
log
@branched from 1.49.1.1
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.49.1.1 1996/11/14 13:05:27 hope Exp $
@


1.48
log
@Modify make mechanism for guib.img to load object files instead of compiling source
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.47 1996/10/08 13:54:20 stephenb Exp $
d28 1
a28 1
RUNTIMEOPTS =	-verbose -d 1 -delivery
@


1.48.1.1
log
@branched from 1.48
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.48 1996/10/09 14:16:15 jont Exp $
@


1.47
log
@[Bug #1602]
Moved basis/__word8vector, basis/mono_vector and
basis/__word8 from PARSER1 in GNUMake to PARSERSYS
in the SunOS/Irix/Linux specific Makefiles since the files are only
needed under Unix.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.46 1996/09/04 14:25:07 jont Exp $
d302 1
a302 1
TTYB_LOADER = 'Shell.File.loadSource "../../../basis/require_all"; \
d305 1
a305 1
ttyb.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
d345 1
a345 1
GUIB_LOADER = 'Shell.File.loadSource "../../../basis/require_all"; \
d348 1
a348 1
guib.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(XGUIMO) 
@


1.46
log
@Ensure all distributes targets are built by make all
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.45 1996/08/09 16:01:15 daveb Exp $
d30 4
a33 1
PARSERSYS =	unix/unixos \
@


1.46.2.1
log
@branched from 1.46
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.46 1996/09/04 14:25:07 jont Exp $
@


1.46.1.1
log
@branched from 1.46
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.46 1996/09/04 14:25:07 jont Exp $
@


1.45
log
@[Bug #1536]
_editor now requires __byte.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.44 1996/06/04 10:05:04 jont Exp $
d25 1
a25 1
all: pervasive.img lexer.img gui.img batch.img
@


1.44
log
@Reinstate empty BASISSYS
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.43 1996/06/04 09:36:39 jont Exp $
d44 6
@


1.43
log
@Remove BASISSYS, no longer necessary
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.42 1996/05/21 09:34:14 jont Exp $
d37 2
@


1.42
log
@Move preferences out of batch files and into interpreter files
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.41 1996/05/17 09:41:54 stephenb Exp $
a36 4


BASISSYS =	unix/__primio \
		basis/__textbinio
@


1.41
log
@Change filesys -> file_sys in accordance with latest file naming conventions.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.39 1996/05/16 16:49:25 jont Exp $
a234 3
		main/preferences \
		main/_preferences \
		main/__preferences \
@


1.40
log
@Remove redundant references to files.
PARSERSYS basis/path is now loaded in images/GNUmake.
@
text
@d36 1
a36 2
 		unix/_unixpath \
		unix/_unixfilesys
@


1.39
log
@Setting OS so SYSTEM will be set appropriately
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.38 1996/05/15 15:23:35 jont Exp $
a35 1
                basis/path \
@


1.38
log
@Add rule for guib.img, a gui with the revised basis loaded
Also a rule for ttyb.img
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.37 1996/04/29 12:10:07 jont Exp $
d245 2
@


1.37
log
@Add extra parameter to Shell.saveImage to indicate not to use executable format
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.36 1996/04/18 17:04:46 jont Exp $
a284 2


d298 12
a331 1

d338 12
@


1.36
log
@initbasis becomes basis
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.35 1996/03/28 13:18:19 stephenb Exp $
d274 1
a274 1
TTY_LOADER = 'Shell.saveImage "tty.img";'
d288 1
a288 1
               Shell.saveImage "ttyi.img";'
d307 1
a307 1
GUI_LOADER = 'Shell.saveImage "gui.img";'
d320 1
a320 1
                 Shell.saveImage "guii.img";'
@


1.35
log
@Various changes as part of the upgrade to the latest OS.* definition.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.34 1996/03/19 11:50:42 stephenb Exp $
d36 1
a36 1
                initbasis/path \
d42 1
a42 1
		initbasis/__textbinio
@


1.34
log
@Fix so that when building images from .mos that use the ARCH_OS stuff
the pervasive .mos are found correctly.
This entailed adding SET_OBJECT to selected image building rules.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.33 1996/03/18 14:33:41 daveb Exp $
d36 1
a36 1
 		initbasis/path \
d38 2
a39 1
 		unix/__path
d65 1
a65 1
		make/os \
d67 1
a67 1
		unix/__os \
d93 1
a93 5
		utils/__inthashtable \

FILESYS =	initbasis/filesys \
		unix/_unixfilesys \
		unix/__filesys
d95 1
a95 1
COMPILER = $(COMPILER1) $(FILESYS) main/io \
a247 1

a252 1

@


1.33
log
@Set the object path when building shell.img.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.31 1996/03/11 17:05:02 daveb Exp $
d284 1
d298 1
d317 1
d331 1
@


1.32
log
@Removed erroneous settings of source path and pervasive path from builds
gui2.img and tty2.img.
@
text
@d265 3
d274 1
@


1.31
log
@Added SET_SOURCE to shell.img.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.30 1996/03/05 16:32:34 jont Exp $
a300 2
	$(SET_SOURCE)      ;    \
	$(SET_PERVASIVE)   ;    \
a330 2
	$(SET_SOURCE)        ;      \
	$(SET_PERVASIVE)     ;      \
@


1.30
log
@Add BASISSYS for stuff to do with revised initial basis
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.29 1996/02/23 16:06:44 daveb Exp $
d269 1
@


1.29
log
@Shell structure converted to new naming convention.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.28 1996/02/21 11:19:30 jont Exp $
d40 2
a41 2
BASISSYS =	unix/__unixprimio \
		unix/__unixtextbinio
@


1.28
log
@Modifications required because lambda uses module
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.27 1996/01/30 15:24:31 jont Exp $
d274 1
a274 1
TTY_LOADER = 'Shell.save_image "tty.img";'
d286 2
a287 2
TTYI_LOADER = 'Shell.File.load_source "../../../foreign/__foreign"; \
               Shell.save_image "ttyi.img";'
d307 1
a307 1
GUI_LOADER = 'Shell.save_image "gui.img";'
d318 2
a319 2
GUII_LOADER = 'Shell.File.load_source "../../../foreign/__foreign"; \
                 Shell.save_image "guii.img";'
@


1.27
log
@Change ttyi.img and guii.img to use latest compilation manager
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.26 1996/01/19 17:01:45 stephenb Exp $
d93 11
d140 1
a140 12
		lambda/__auglambda

FILESYS =	initbasis/filesys \
		unix/_unixfilesys \
		unix/__filesys

COMPILER = $(COMPILER1) $(FILESYS) main/io \
		main/_io \
		main/__io \
		basics/module \
		basics/_module \
		basics/__module \
@


1.26
log
@OS reorganisation: add newly created unix/__unixos
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.25 1996/01/09 12:23:35 matthew Exp $
d286 1
a286 1
TTYI_LOADER = 'Shell.Make.make_file "../../../foreign/__foreign"; \
d318 1
a318 1
GUII_LOADER = 'Shell.Make.make_file "../../../foreign/__foreign"; \
@


1.25
log
@Renaming motif.img to gui.img
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.24 1995/12/13 14:43:01 jont Exp $
d30 4
a33 1
PARSERSYS =	utils/getenv \
d45 4
a48 1
		sparc/__stack_interface
@


1.24
log
@Load inthashtable before lambda
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.23 1995/12/06 12:42:22 daveb Exp $
d25 1
a25 1
all: pervasive.img lexer.img motif.img batch.img
d301 1
a301 1
MOTIF_LOADER = 'Shell.save_image "motif.img";'
d303 1
a303 1
motif.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO) 
d307 1
a307 1
	echo $(MOTIF_LOADER) |      \
d309 1
a309 1
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO)
d312 2
a313 2
MOTIFI_LOADER = 'Shell.Make.make_file "../../../foreign/__foreign"; \
                 Shell.save_image "motifi.img";'
d316 1
a316 1
motifi.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO) 
d320 1
a320 1
	echo $(MOTIFI_LOADER) |      \
d322 1
a322 1
		$(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO)
d324 1
a324 1
motif2.img: shell.img $(INTERMO) $(MOTIFMO) 
d328 1
a328 1
	echo $(MOTIF_LOADER) |      \
d330 1
a330 1
		$(INTERMO) $(MOTIFMO)
@


1.23
log
@Removed load of initbasis/__lists from batch.img.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.22 1995/11/20 17:30:36 daveb Exp $
d84 3
a98 3
		utils/inthashtable \
		utils/_inthashtable \
		utils/__inthashtable \
@


1.22
log
@Added project and depend modules.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.21 1995/08/14 12:29:28 jont Exp $
a221 8
         	initbasis/word \
         	initbasis/__word \
         	initbasis/__word8 \
         	initbasis/toplevel \
         	initbasis/general \
         	initbasis/__general \
         	initbasis/lists \
                initbasis/__lists \
@


1.21
log
@Modified bignum structures
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.20 1995/07/20 11:50:36 jont Exp $
d222 17
a244 3
		make/recompile \
		make/_recompile \
		make/__recompile \
@


1.20
log
@Move _ident and __ident out of PARSERSYS
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.19 1995/07/19 16:17:02 jont Exp $
d48 3
d53 1
a53 2
		utils/bignum \
		utils/_bignum \
@


1.19
log
@Add new scons module, plus some rearrangements
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.18 1995/07/18 09:18:53 jont Exp $
d35 1
a35 3
 		unix/__path \
		basics/_ident \
		basics/__ident
@


1.18
log
@Some rearrangements to allow bignum to be called by the _ident
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.17 1995/05/31 12:24:58 matthew Exp $
a35 9
		sparc/machtypes \
		sparc/_machtypes \
		sparc/__machtypes \
		main/machspec \
		sparc/_machspec \
		sparc/__machspec \
		utils/bignum \
		utils/_bignum \
		utils/__bignum \
d46 13
a58 1
COMPILER1 =	make/os \
@


1.17
log
@Moving __primitives and dependencies to GNUmake
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.16 1995/05/29 15:32:11 brianm Exp $
d35 12
a46 1
 		unix/__path
a83 9
		sparc/machtypes \
		sparc/_machtypes \
		sparc/__machtypes \
		main/machspec \
		sparc/_machspec \
		sparc/__machspec \
		utils/bignum \
		utils/_bignum \
		utils/__bignum \
@


1.16
log
@Adding motifi.img/ttyi.img for loading ForeignInterface
and some tidying up.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.15 1995/05/05 14:14:59 daveb Exp $
a46 17
		utils/text \
		utils/_text \
		utils/__text \
		utils/diagnostic \
		utils/_diagnostic \
		main/pervasives \
		main/_pervasives \
		main/__pervasives \
		lambda/lambdatypes \
		lambda/_lambdatypes \
		lambda/__lambdatypes \
		lambda/environtypes \
		lambda/_environtypes \
		lambda/__environtypes \
		lambda/environ \
		lambda/_environ \
		lambda/__environ \
a61 3
		main/primitives \
		main/_primitives \
		main/__primitives \
a94 1
		lambda/__simplelambda \
@


1.15
log
@Added BASISSYS target.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.14 1995/05/03 15:39:18 jont Exp $
d255 1
d262 9
d273 4
a276 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/$(SRC)/pervasive/;$(RUNTIME) $(RUNTIMEOPTS) -load typechecker.img -save $@@ $(COMPILERMO) $(SHELLMO)
d278 2
d282 7
a288 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/$(SRC)/pervasive/;echo 'Shell.save_image "tty.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
d290 4
a293 1
motif.img: typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO) 
d295 5
a299 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/$(SRC)/pervasive/;echo 'Shell.save_image "motif.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load typechecker.img $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO)
d301 1
d304 29
a332 1
	echo 'Shell.save_image "tty.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load shell.img $(INTERMO) $(TTYMO)
d336 5
a340 1
	echo 'Shell.save_image "motif.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load shell.img $(INTERMO) $(MOTIFMO)
@


1.14
log
@Add support to make basis.img
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.13 1995/04/20 17:30:24 daveb Exp $
d36 3
@


1.13
log
@path and filesys moved from utils to initbasis.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.12 1995/03/08 12:17:49 matthew Exp $
d41 1
a41 1
COMPILER =	make/os \
d136 3
a138 2
		lambda/__auglambda \
		initbasis/filesys \
d140 3
a142 2
		unix/__filesys \
		main/io \
@


1.12
log
@Adding stack_interface files
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.11 1995/03/02 14:25:03 matthew Exp $
d33 1
a33 1
 		utils/path \
d137 1
a137 1
		utils/filesys \
@


1.11
log
@Various changes
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.10 1995/03/01 11:49:34 jont Exp $
d36 4
@


1.10
log
@Move some *-files targets here
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.9 1995/02/13 13:12:43 jont Exp $
a74 2
		utils/delayed_newhashtable \
		utils/_delayed_newhashtable \
a75 1
		lambda/lambdautils \
d81 2
a83 3
		lambda/_lambdautils \
		lambda/__lambdautils \
		utils/__delayed_newhashtable \
a108 19
		lambda/optimise_lib \
		lambda/_optimise_lib \
		lambda/__optimise_lib \
		lambda/optimise_contract \
		lambda/_optimise_contract \
		lambda/__optimise_contract \
		lambda/optimise_beta \
		lambda/_optimise_beta \
		lambda/__optimise_beta \
		lambda/optimise_builtin \
		lambda/_optimise_builtin \
		lambda/__optimise_builtin \
		lambda/optimise_cse \
		lambda/_optimise_cse \
		lambda/__optimise_cse \
		lambda/optimise_lift \
		lambda/_optimise_lift \
		lambda/__optimise_lift \
		lambda/_lambdaoptimiser \
d125 2
a126 2
 		rts/gen/tags \
 		rts/gen/__tags \
a150 1
		rts/gen/__implicit \
a162 1
		rts/gen/implicit \
a228 3
		lambda/lambdaio \
		lambda/_lambdaio \
		lambda/__lambdaio \
@


1.9
log
@Minor rearrangement
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.8 1995/02/10 14:00:07 jont Exp $
d273 6
@


1.8
log
@Move all target to be before other targets.
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.7 1995/02/10 12:57:44 jont Exp $
a29 2
include ../../GNUmake

d271 2
@


1.7
log
@Remove all target, system specific
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.6 1995/02/08 15:59:11 jont Exp $
d25 2
a272 2

all: pervasive.img lexer.img motif.img batch.img
@


1.6
log
@Split into generic and specific parts
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.5 1995/02/08 15:01:39 matthew Exp $
d271 2
@


1.5
log
@Removing typechecker files
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.4 1995/02/02 16:47:37 jont Exp $
a24 1
SRC =		../../..
a26 64
COMPRESS =	compress -v
UNCOMPRESS =	uncompress
RM =		/bin/rm -f
CP =		/bin/cp
MKDIR =		/bin/mkdir
TMPDIR =	/tmp
DISTRIB =	/usr/sml/distribution/images
DISTRIBUTED =	pervasive.img batch.img motif.img
ADB =		adb
PERVASIVEDIR =	$(SRC)/pervasive
PERVASIVE =	__builtin_library bytearray bits array \
		string vector mlworks __pervasive_library 
PERVASIVEMO =	$(PERVASIVE:%=$(PERVASIVEDIR)/%.mo)
LEXER =		utils/print \
		utils/_print \
		utils/__print \
		utils/integer \
		utils/_integer \
		utils/__integer \
		utils/lists \
		utils/_lists \
		utils/__lists \
		utils/newmap \
		utils/mononewmap \
		utils/intnewmap \
		basics/location \
		basics/_location \
		basics/__location \
		main/info \
		main/_info \
		main/__info \
		utils/crash \
		utils/_crash \
		utils/__crash \
		utils/_b23tree \
		utils/__btree \
		utils/_intb23tree \
		utils/__intbtree \
		basics/symbol \
		basics/_symbol \
		basics/__symbol \
		basics/token \
		basics/_token \
		basics/__token \
		lexer/ndfa \
		lexer/_ndfa \
		lexer/__ndfa \
		lexer/regexp \
		lexer/_regexp \
		lexer/__regexp \
		lexer/inbuffer \
		lexer/_inbuffer \
		lexer/__inbuffer \
		main/options \
		main/_options \
		main/__options \
		lexer/lexrules \
		lexer/_lexrules \
		lexer/__lexrules \
		utils/timer \
		utils/__timer \
		lexer/lexer \
		lexer/_lexgen \
		lexer/__lexer
d28 3
a30 9
PARSER =	utils/map \
		basics/ident \
		basics/identprint \
		utils/set \
		utils/_set \
		utils/__set \
		utils/option \
		utils/__option \
		utils/getenv \
d35 1
a35 138
 		unix/__path \
		basics/module_id \
		basics/_module_id \
		basics/__module_id \
		basics/absyn \
		parser/parserenv \
		parser/derived \
		parser/parser \
 		parser/LRbasics \
 		parser/actionfunctions \
 		parser/LRparser \
		parser/_parser \
		utils/_map \
		utils/__map \
		basics/_ident \
		basics/__ident \
		basics/_identprint \
		basics/__identprint \
		utils/counter \
		utils/_counter \
		typechecker/simpletypes \
		typechecker/_simpletypes \
		typechecker/__simpletypes \
		typechecker/datatypes \
		typechecker/_datatypes \
		typechecker/__datatypes \
 		debugger/runtime_env \
 		debugger/_runtime_env \
 		debugger/__runtime_env \
		basics/_absyn \
		basics/__absyn \
		parser/_parserenv \
		parser/__parserenv \
		parser/_derived \
		parser/__derived \
 		parser/_LRbasics \
 		parser/_LRparser \
 		parser/_actionfunctions \
 		parser/__LRbasics \
 		parser/__actionfunctions \
 		parser/__LRparser \
		parser/__parser

TYPER =		utils/hashset \
		utils/_hashset \
		lambda/pretty \
		lambda/_pretty \
		lambda/__pretty \
		utils/sexpr \
		utils/_sexpr \
		utils/__sexpr \
		typechecker/types \
		typechecker/_types \
		typechecker/__types \
		basics/absynprint \
		basics/_absynprint \
		basics/__absynprint \
		lambda/topdecprint \
		lambda/_topdecprint \
		lambda/__topdecprint \
		typechecker/namehash \
		typechecker/_namehash \
		typechecker/__namehash \
		typechecker/strnames \
		typechecker/_strnames \
		typechecker/__strnames \
		typechecker/namesettypes \
		typechecker/_namesettypes \
		typechecker/__namesettypes \
		typechecker/basistypes \
		typechecker/_basistypes \
		typechecker/__basistypes \
		typechecker/unify \
		typechecker/_unify \
		typechecker/__unify \
		utils/newhashtable \
		utils/_newhashtable \
		utils/__newhashtable \
		typechecker/completion \
		typechecker/_completion \
		typechecker/__completion \
		typechecker/scheme \
		typechecker/_scheme \
		typechecker/__scheme \
		typechecker/valenv \
		typechecker/_valenv \
		typechecker/__valenv \
		typechecker/tyenv \
		typechecker/_tyenv \
		typechecker/__tyenv \
		typechecker/strenv \
		typechecker/_strenv \
		typechecker/__strenv \
		typechecker/environment \
		typechecker/_environment \
		typechecker/__environment \
		typechecker/nameset \
		typechecker/_nameset \
		typechecker/__nameset \
		typechecker/sigma \
		typechecker/_sigma \
		typechecker/__sigma \
		typechecker/basis \
		typechecker/_basis \
		typechecker/__basis \
		typechecker/type_exp \
		typechecker/_type_exp \
		typechecker/__type_exp \
		typechecker/assemblies \
		typechecker/_assemblies \
		typechecker/__assemblies \
		typechecker/control_unify \
		typechecker/_control_unify \
		typechecker/__control_unify \
		typechecker/context_print \
		typechecker/_context_print \
		typechecker/__context_print \
		typechecker/patterns \
		typechecker/_patterns \
		typechecker/__patterns \
		typechecker/core_rules \
		typechecker/_core_rules \
		typechecker/__core_rules \
		typechecker/sharetypes \
		typechecker/_sharetypes \
		typechecker/__sharetypes \
		typechecker/share \
		typechecker/_share \
		typechecker/__share \
		typechecker/realise \
		typechecker/_realise \
		typechecker/__realise \
		typechecker/type_debugger \
		typechecker/_type_debugger \
		typechecker/__type_debugger \
		typechecker/mod_rules \
		typechecker/_mod_rules \
		typechecker/__mod_rules
d262 2
a263 3
		main/__preferences

BATCH =		make/recompile \
d270 1
a270 172
		main/__user_options \
		main/batch \
		main/_batch \
		main/__batch

SHELLSRC =	debugger/get_type_information \
		debugger/_get_type_information \
		debugger/__get_type_information \
		interpreter/inter_envtypes \
		interpreter/_inter_envtypes \
		interpreter/__inter_envtypes \
		debugger/value_printer_utilities \
		debugger/_value_printer_utilities \
		debugger/__value_printer_utilities \
		debugger/value_printer \
		debugger/_value_printer \
		debugger/__value_printer \
		main/compiler \
		main/_compiler \
		main/__compiler \
		interpreter/interload \
		interpreter/_interload \
		interpreter/__interload \
		interpreter/intermake \
		interpreter/_intermake \
		interpreter/__intermake \
		interpreter/incremental \
		interpreter/_incremental \
		interpreter/__incremental

INTERSRC =	editor/editor \
		editor/_editor \
		editor/__editor \
		main/version \
		main/__version \
		main/user_options \
		main/_user_options \
		main/__user_options \
		debugger/newtrace \
		debugger/_newtrace \
		debugger/__newtrace \
		interpreter/shell_types \
		interpreter/_shell_types \
		interpreter/__shell_types \
		interpreter/interprint \
		interpreter/_interprint \
		interpreter/__interprint \
		interpreter/shell_utils \
		interpreter/_shell_utils \
		interpreter/__shell_utils \
	        debugger/debugger_print \
		debugger/_debugger_print \
	        debugger/__debugger_print \
		debugger/ml_debugger \
		debugger/_ml_debugger \
		debugger/__ml_debugger \
		make/recompile \
		make/_recompile \
		make/__recompile \
		interpreter/action_queue \
		interpreter/_action_queue \
		interpreter/__action_queue \
		interpreter/inspector_values \
		interpreter/_inspector_values \
		interpreter/__inspector_values \
		interpreter/inspector \
		interpreter/_inspector \
		interpreter/__inspector \
		interpreter/shell_structure \
		interpreter/_shell_structure \
		interpreter/__shell_structure \
		interpreter/shell \
		interpreter/_shell \
		interpreter/__shell \
		interpreter/tty_listener \
		interpreter/_tty_listener \
		interpreter/__tty_listener

TTYSRC =	interpreter/interpreter

MOTIFSRC =	library/xm \
		library/_xm \
		library/__xm \
		motif/menus \
		motif/_menus \
		motif/__menus \
		motif/tooldata \
		motif/_tooldata \
		motif/__tooldata \
		motif/motif_utils \
		motif/_motif_utils \
		motif/__motif_utils \
		motif/input \
		motif/_input \
		motif/__input \
		motif/output \
		motif/_output \
		motif/__output \
		motif/inspector_tool \
		motif/_inspector_tool \
		motif/__inspector_tool \
		motif/debugger_window \
		motif/_debugger_window \
		motif/__debugger_window \
		motif/error_browser \
		motif/_error_browser \
		motif/__error_browser \
		motif/fileselect \
		motif/_fileselect \
		motif/__fileselect \
		motif/file_dialog \
		motif/_file_dialog \
		motif/__file_dialog \
		motif/evaluator \
		motif/_evaluator \
		motif/__evaluator \
		motif/browser_tool \
		motif/_browser_tool \
		motif/__browser_tool \
		motif/listener \
		motif/podium \
	 	motif/_listener \
		motif/_podium \
	 	motif/__listener \
		motif/__podium \
		interpreter/xinterpreter

TAGS =		ml_utils/mltags

ETAGS =		ml_utils/mletags

SCRIPT =	utils/option \
		utils/__option \
		main/io \
		main/_io \
		main/__io \
		ml_utils/script

ARSRC =		utils/lists \
		utils/_lists \
		utils/__lists \
		ml_utils/ml_ar

LEXERMO =	$(LEXER:%=$(SRC)/%.mo)
PARSERMO =	$(PARSER:%=$(SRC)/%.mo)
TYPERMO =	$(TYPER:%=$(SRC)/%.mo)
COMPILERMO =	$(COMPILER:%=$(SRC)/%.mo)
BATCHMO =	$(BATCH:%=$(SRC)/%.mo)
SHELLMO =	$(SHELLSRC:%=$(SRC)/%.mo)
INTERMO =	$(INTERSRC:%=$(SRC)/%.mo)
TTYMO =		$(TTYSRC:%=$(SRC)/%.mo)
MOTIFMO =	$(MOTIFSRC:%=$(SRC)/%.mo)
TAGSMO =	$(TAGS:%=$(SRC)/%.mo)
ETAGSMO =	$(ETAGS:%=$(SRC)/%.mo)
SCRIPTMO =	$(SCRIPT:%=$(SRC)/%.mo)
ARMO =		$(ARSRC:%=$(SRC)/%.mo)

.PRECIOUS: pervasive.img lexer.img typechecker.img shell.img motif.img batch.img
.SILENT:

all: pervasive.img lexer.img motif.img batch.img

profile:
	make RUNTIMEOPTS="-verbose -c 2 -profile -profile-frequency 100"

clean:
	echo $(RM) *.img
	$(RM) *.img

backup:
	echo 'make: moving *.img to *.img~'
	for image in *.img; do mv $$image $$image~; done
a271 56
lexer-files: force
	echo $(LEXERMO) > $@@

pervasive-files: force
	echo $(PERVASIVEMO) > $@@

batch-files: force
	echo $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(BATCHMO) > $@@

shell-files: force
	echo $(COMPILERMO) $(SHELLMO) > $@@

tty-files: force
	echo $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO) > tty-files

motif-files: force
	echo $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO) > motif-files

motif2-files: force
	echo $(INTERMO) $(MOTIFMO) > motif2-files

tty2-files: force
	echo $(INTERMO) $(TTYMO) > tty2-files

tags-files: force
	echo $(TAGSMO) > tags-files

etags-files: force
	echo $(ETAGSMO) > etags-files

script-files: force
	echo $(SCRIPTMO) > script-files

ar-files: force
	echo $(ARMO) > ar-files

pervasive.img: $(PERVASIVEMO)
	echo make: $@@
	$(RUNTIME) $(RUNTIMEOPTS) -save $@@ $(PERVASIVEMO)

lexer.img: pervasive.img $(LEXERMO)
	echo make: $@@
	$(RUNTIME) $(RUNTIMEOPTS) -load pervasive.img -save $@@ $(LEXERMO)

parser.img: lexer.img $(PARSERMO)
	echo make: $@@
	$(RUNTIME) $(RUNTIMEOPTS) -load lexer.img -save $@@ $(PARSERMO)

typechecker.img: lexer.img $(PARSERMO) $(TYPERMO)
	echo make: $@@
	$(RUNTIME) $(RUNTIMEOPTS) -pass args -parser_tables $(SRC)/parser/ml-tables/ args -save $@@ -load lexer.img $(PARSERMO) $(TYPERMO)

batch.img: typechecker.img $(COMPILERMO) $(BATCHMO)
	echo make: $@@
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -verbose -save $@@ wombats -load typechecker.img $(COMPILERMO) $(BATCHMO)

a291 24
mltags.img: lexer.img $(TAGSMO)
	echo make: $@@ from lexer.img
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load lexer.img $(TAGSMO)

mletags.img: lexer.img $(ETAGSMO)
	echo make: $@@ from lexer.img
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load lexer.img $(ETAGSMO)

script.img: lexer.img $(SCRIPTMO)
	echo make: $@@ from lexer.img
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load lexer.img $(SCRIPTMO)

ml_ar.img: pervasive.img $(ARMO)
	echo make: $@@ from pervasive.img
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load pervasive.img $(ARMO)

distribution:
	$(RM) -r $(DISTDIR)/images
	$(MKDIR) $(DISTDIR)/images
	$(COMPRESS) $(DISTRIBUTED)
	$(CP) $(DISTRIBUTED:%=%.Z) $(DISTDIR)/images
	$(UNCOMPRESS) $(DISTRIBUTED)

force:
@


1.4
log
@Sort out ml utils
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.3 1995/02/02 13:08:56 jont Exp $
a125 2
		utils/_debug \
		utils/__debug \
a156 2
		typechecker/ty_debug \
		typechecker/__ty_debug \
a177 3
		typechecker/tyvarenv \
		typechecker/_tyvarenv \
		typechecker/__tyvarenv \
a192 3
		typechecker/tystr \
		typechecker/_tystr \
		typechecker/__tystr \
a207 9
		typechecker/phi \
		typechecker/_phi \
		typechecker/__phi \
		typechecker/sigenv \
		typechecker/_sigenv \
		typechecker/__sigenv \
		typechecker/funenv \
		typechecker/_funenv \
		typechecker/__funenv \
@


1.3
log
@Change tty and motif images builds to be from typechecker.img
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.2 1995/02/01 17:22:28 jont Exp $
d625 4
d650 2
d695 6
d747 1
a747 1
mltags.img: lexer.img ../ml_utils/mltags.mo
d749 1
a749 1
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load lexer.img ../ml_utils/mltags.mo
d751 1
a751 1
mletags.img: lexer.img ../ml_utils/mletags.mo
d753 1
a753 1
	$(RUNTIME) $(RUNTIMEOPTS) -pass wombats -save $@@ wombats -load lexer.img ../ml_utils/mltags.mo
@


1.2
log
@Get module names right for new structure
@
text
@d20 1
a20 1
# $Id: SPARC:SunOS:Makefile,v 1.1 1995/02/01 17:13:52 jont Exp $
d25 2
a26 1
RUNTIME =	../../../rts/runtime-g
a36 1
SRC =		../../..
d104 3
a106 3
		utils/filename \
		unix/_unixfilename \
		unix/__filename \
d134 3
a136 3
		debugger/debugger_env \
		debugger/_debugger_env \
		debugger/__debugger_env \
d375 5
a379 3
		debugger/debugger_type_utilities \
		debugger/_debugger_type_utilities \
		debugger/__debugger_type_utilities \
d383 3
a461 2
		rts/gen/tags \
		rts/gen/__tags \
d649 1
a649 1
.PRECIOUS: pervasive.img lexer.img shell.img motif.img batch.img
d709 1
a709 1
	$(RUNTIME) $(RUNTIMEOPTS) -save $@@ -load lexer.img $(PARSERMO) $(TYPERMO)
d717 1
a717 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../../../pervasive/;$(RUNTIME) $(RUNTIMEOPTS) -load typechecker.img -save $@@ $(COMPILERMO) $(SHELLMO)
d719 7
a725 7
tty.img: lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
	echo make: $@@ from lexer.img
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../../../pervasive/;echo 'Shell.save_image "tty.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)

motif.img: lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO) 
	echo make: $@@ from lexer.img
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../../../pervasive/;echo 'Shell.save_image "motif.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO)
@


1.1
log
@new unit
New architecture and OS specific Makefile
@
text
@d20 1
a20 1
# $Id: Makefile,v 1.142 1995/01/18 18:01:43 jont Exp $
d25 1
a25 1
RUNTIME =	../rts/runtime-g
d36 1
a36 1
SRC =		..
d714 1
a714 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../pervasive/;$(RUNTIME) $(RUNTIMEOPTS) -load typechecker.img -save $@@ $(COMPILERMO) $(SHELLMO)
d718 1
a718 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../pervasive/;echo 'Shell.save_image "tty.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(TTYMO)
d722 1
a722 1
	export MLWORKS_PERVASIVE;MLWORKS_PERVASIVE=`pwd`/../pervasive/;echo 'Shell.save_image "motif.img";' | $(RUNTIME) $(RUNTIMEOPTS) -load lexer.img $(PARSERMO) $(TYPERMO) $(COMPILERMO) $(SHELLMO) $(INTERMO) $(MOTIFMO)
@
