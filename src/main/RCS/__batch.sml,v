head	1.30;
access;
symbols
	MLW_daveb_inline_1_4_99:1.28.1
	MLWorks_21c0_1999_03_25:1.28
	MLWorks_20c1_1998_08_20:1.27
	MLWorks_20c0_1998_08_04:1.27
	MLWorks_20b2c2_1998_06_19:1.27
	MLWorks_20b2_Windows_1998_06_12:1.27
	MLWorks_20b1c1_1998_05_07:1.27
	MLWorks_20b0_1998_04_07:1.27
	MLWorks_20b0_1998_03_20:1.27
	MLWorks_20m2_1998_02_16:1.27
	MLWorks_20m1_1997_10_23:1.26
	MLWorks_11r1:1.25.5.1.1.1.1
	MLWorks_workspace_97:1.26.2
	MLWorks_dt_wizard:1.26.1
	MLWorks_11c0_1997_09_09:1.25.5.1.1.1
	MLWorks_10r3:1.25.5.1.3
	MLWorks_10r2_551:1.25.5.1.2
	MLWorks_11:1.25.5.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.25.5.1
	MLWorks_20m0_1997_06_20:1.26
	MLWorks_1_0_r2c2_1997_06_14:1.25.5.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.25.5.1
	MLWorks_1_0_r2c1_1997_05_12:1.25.5
	MLWorks_BugFix_1997_04_24:1.25
	MLWorks_1_0_r2_Win32_1997_04_11:1.25
	MLWorks_1_0_r2_Unix_1997_04_04:1.25
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.25.3.1.1
	MLWorks_gui_1996_12_18:1.25.4
	MLWorks_1_0_Win32_1996_12_17:1.25.3
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.25.1.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.25.1.1
	MLWorks_1_0_Irix_1996_11_28:1.25.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.25.2
	MLWorks_1_0_Unix_1996_11_14:1.25.1
	MLWorks_Open_Beta2_1996_10_11:1.23.3
	MLWorks_License_dev:1.23.2
	MLWorks_1_open_beta_1996_09_13:1.23.1
	MLWorks_Open_Beta_1996_08_22:1.23
	MLWorks_Beta_1996_07_02:1.23
	MLWorks_Beta_1996_06_07:1.23
	MLWorks_Beta_1996_06_06:1.23
	MLWorks_Beta_1996_06_05:1.23
	MLWorks_Beta_1996_06_03:1.23
	MLWorks_Beta_1996_05_31:1.23
	MLWorks_Beta_1996_05_30:1.23
	ML_beta_release_12/08/94:1.11
	ML_beta_release_03/08/94:1.11
	ML_revised_beta_release_25/05/94:1.10
	ML_final_beta_release_02/03/94:1.10
	mlworks-28-01-1994:1.8
	Release:1.8
	mlworks-beta-01-09-1993:1.8
	MLWorks-1-0-4-29/01/1993:1.4
	MLWorks-1-0-3-21/12/1992:1.4
	MLWorks-1-0-2-15/12/1992:1.4
	MLWorks-1-0-1-04/12/1992:1.4;
locks; strict;
comment	@ * @;


1.30
date	99.05.27.10.33.47;	author johnh;	state Exp;
branches;
next	1.29;

1.29
date	99.05.13.12.56.39;	author daveb;	state Exp;
branches;
next	1.28;

1.28
date	99.02.05.14.44.14;	author mitchell;	state Exp;
branches
	1.28.1.1;
next	1.27;

1.27
date	98.01.28.10.08.46;	author johnh;	state Exp;
branches;
next	1.26;

1.26
date	97.05.12.16.12.40;	author jont;	state Exp;
branches
	1.26.1.1
	1.26.2.1;
next	1.25;

1.25
date	96.11.06.12.09.08;	author daveb;	state Exp;
branches
	1.25.1.1
	1.25.2.1
	1.25.3.1
	1.25.4.1
	1.25.5.1;
next	1.24;

1.24
date	96.10.29.17.16.14;	author io;	state Exp;
branches;
next	1.23;

1.23
date	96.05.16.12.49.47;	author stephenb;	state Exp;
branches
	1.23.1.1
	1.23.2.1
	1.23.3.1;
next	1.22;

1.22
date	96.05.08.13.30.36;	author stephenb;	state Exp;
branches;
next	1.21;

1.21
date	96.04.30.09.13.29;	author matthew;	state Exp;
branches;
next	1.20;

1.20
date	96.04.17.14.53.28;	author stephenb;	state Exp;
branches;
next	1.19;

1.19
date	95.12.27.15.52.56;	author jont;	state Exp;
branches;
next	1.18;

1.18
date	95.12.14.17.18.08;	author jont;	state Exp;
branches;
next	1.17;

1.17
date	95.11.20.17.26.44;	author daveb;	state Exp;
branches;
next	1.16;

1.16
date	95.06.30.16.03.30;	author daveb;	state Exp;
branches;
next	1.15;

1.15
date	95.06.01.12.31.55;	author daveb;	state Exp;
branches;
next	1.14;

1.14
date	95.04.20.15.21.50;	author daveb;	state Exp;
branches;
next	1.13;

1.13
date	95.01.17.16.54.09;	author daveb;	state Exp;
branches;
next	1.12;

1.12
date	94.12.08.17.03.22;	author jont;	state Exp;
branches;
next	1.11;

1.11
date	94.08.01.12.59.18;	author daveb;	state Exp;
branches;
next	1.10;

1.10
date	94.02.24.15.59.13;	author daveb;	state Exp;
branches;
next	1.9;

1.9
date	94.02.21.17.16.21;	author daveb;	state Exp;
branches;
next	1.8;

1.8
date	93.08.04.14.52.18;	author daveb;	state Exp;
branches
	1.8.1.1;
next	1.7;

1.7
date	93.04.28.10.03.02;	author richard;	state Exp;
branches;
next	1.6;

1.6
date	93.04.06.17.30.08;	author jont;	state Exp;
branches;
next	1.5;

1.5
date	93.02.24.14.39.00;	author jont;	state Exp;
branches;
next	1.4;

1.4
date	92.12.04.12.30.49;	author richard;	state Exp;
branches;
next	1.3;

1.3
date	92.11.20.13.56.48;	author jont;	state Exp;
branches;
next	1.2;

1.2
date	92.11.18.16.39.26;	author matthew;	state Exp;
branches;
next	1.1;

1.1
date	92.09.01.13.40.46;	author richard;	state Exp;
branches;
next	;

1.8.1.1
date	93.08.04.14.52.18;	author jont;	state Exp;
branches;
next	;

1.23.1.1
date	96.09.13.11.18.28;	author hope;	state Exp;
branches;
next	;

1.23.2.1
date	96.10.07.16.08.21;	author hope;	state Exp;
branches;
next	;

1.23.3.1
date	96.10.17.11.26.36;	author hope;	state Exp;
branches;
next	;

1.25.1.1
date	96.11.14.12.51.57;	author hope;	state Exp;
branches
	1.25.1.1.1.1;
next	;

1.25.1.1.1.1
date	96.11.28.15.02.57;	author hope;	state Exp;
branches;
next	;

1.25.2.1
date	96.11.22.18.11.08;	author hope;	state Exp;
branches;
next	;

1.25.3.1
date	96.12.17.17.49.41;	author hope;	state Exp;
branches
	1.25.3.1.1.1;
next	;

1.25.3.1.1.1
date	97.02.24.11.39.52;	author hope;	state Exp;
branches;
next	;

1.25.4.1
date	96.12.18.09.43.46;	author hope;	state Exp;
branches;
next	;

1.25.5.1
date	97.05.12.10.36.15;	author hope;	state Exp;
branches
	1.25.5.1.1.1
	1.25.5.1.2.1
	1.25.5.1.3.1;
next	;

1.25.5.1.1.1
date	97.07.28.18.21.56;	author daveb;	state Exp;
branches
	1.25.5.1.1.1.1.1;
next	;

1.25.5.1.1.1.1.1
date	97.10.07.11.47.36;	author jkbrook;	state Exp;
branches;
next	;

1.25.5.1.2.1
date	97.09.08.17.15.20;	author daveb;	state Exp;
branches;
next	;

1.25.5.1.3.1
date	97.09.09.14.11.12;	author daveb;	state Exp;
branches;
next	;

1.26.1.1
date	97.09.10.19.27.14;	author brucem;	state Exp;
branches;
next	;

1.26.2.1
date	97.09.11.20.57.14;	author daveb;	state Exp;
branches;
next	1.26.2.2;

1.26.2.2
date	97.09.17.16.24.56;	author daveb;	state Exp;
branches;
next	1.26.2.3;

1.26.2.3
date	97.11.20.16.59.34;	author daveb;	state Exp;
branches;
next	;

1.28.1.1
date	99.04.01.17.57.55;	author daveb;	state Exp;
branches;
next	;


desc
@Batch compiler command line parser.
@


1.30
log
@[Bug #190553]
FIx require statements to fix bootstrap compiler.
@
text
@(*  ==== TOP LEVEL BATCH COMPILER ====
 *          STRUCTURE AND GO!
 *
 *  Copyright (C) 1992 Harlequin Ltd
 *
 *  Revision Log
 *  ------------
 *  $Log: __batch.sml,v $
 * Revision 1.29  1999/05/13  12:56:39  daveb
 * [Bug #190553]
 * Replaced use of basis/exit with utils/mlworks_exit.
 *
 * Revision 1.28  1999/02/05  14:44:14  mitchell
 * [Bug #170109]
 * Make the batch project rely on basis/__general to keep the daily build happy
 *
 * Revision 1.27  1998/01/28  10:08:46  johnh
 * [Bug #30071]
 * Merge in Project Workspace changes.
 *
 * Revision 1.26.2.3  1997/11/20  16:59:34  daveb
 * [Bug #30326]
 *
 * Revision 1.26.2.2  1997/09/17  16:24:56  daveb
 * [Bug #30071]
 * Converted build system to project workspace.
 *
 * Revision 1.26.2.1  1997/09/11  20:57:14  daveb
 * branched from trunk for label MLWorks_workspace_97
 *
 * Revision 1.26  1997/05/12  16:12:40  jont
 * [Bug #20050]
 * main/io now exports MLWORKS_IO
 *
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Added License parameter.
 *
 * Revision 1.24  1996/10/29  17:16:14  io
 * [Bug #1614]
 * basifying String
 *
 * Revision 1.23  1996/05/16  12:49:47  stephenb
 * Update wrt MLWorks.OS.arguments -> MLWorks.arguments
 *
 * Revision 1.22  1996/05/08  13:30:36  stephenb
 * Update wrt move of file "main" to basis.
 *
 * Revision 1.21  1996/04/30  09:13:29  matthew
 * Use basis integer structure
 *
 * Revision 1.20  1996/04/17  14:53:28  stephenb
 * Replace any use of MLWorks.exit by Exit.exit.
 *
 * Revision 1.19  1995/12/27  15:52:56  jont
 * Remove __option
 *
 *  Revision 1.18  1995/12/14  17:18:08  jont
 *  Reordering requires a bit
 *
 *  Revision 1.17  1995/11/20  17:26:44  daveb
 *  Removed Recompile parameter.
 *
 *  Revision 1.16  1995/06/30  16:03:30  daveb
 *  Added the Integer parameter.
 *
 *  Revision 1.15  1995/06/01  12:31:55  daveb
 *  Removed Preferences parameter.
 *
 *  Revision 1.14  1995/04/20  15:21:50  daveb
 *  Removed the FileSys parameter.
 *
 *  Revision 1.13  1995/01/17  16:54:09  daveb
 *  Replaced FileName parameter.
 *
 *  Revision 1.12  1994/12/08  17:03:22  jont
 *  Move OS specific stuff into a system link directory
 *
 *  Revision 1.11  1994/08/01  12:59:18  daveb
 *  Added Preferences argument.
 *
 *  Revision 1.10  1994/02/24  15:59:13  daveb
 *  Adding UnixFilename parameter.
 *
 *  Revision 1.9  1994/02/21  17:16:21  daveb
 *  Added Encapsulate argument.
 *
 *  Revision 1.8  1993/08/04  14:52:18  daveb
 *  Added Option parameter.
 *
 *  Revision 1.7  1993/04/28  10:03:02  richard
 *  The batch compiler now returns a status code.
 *
 *  Revision 1.6  1993/04/06  17:30:08  jont
 *  Moved user_options and version from interpreter to main
 *
 *  Revision 1.5  1993/02/24  14:39:00  jont
 *  Added Io_ structure to functor parameter
 *
 *  Revision 1.4  1992/12/04  12:30:49  richard
 *  The module table is cleared before invoking the batch compiler.
 *  The version module is a new parameter.
 *
 *  Revision 1.3  1992/11/20  13:56:48  jont
 *  Added option parameter. removed info parameter
 *
 *  Revision 1.2  1992/11/18  16:39:26  matthew
 *  Changed Error structure to Info
 *
 *  Revision 1.1  1992/09/01  13:40:46  richard
 *  Initial revision
 *
 *)

require "__toplevel";
require "__mlworks_io";
require "__encapsulate";
require "__version";
require "__license";
require "__proj_file";
require "__user_options";
require "../system/__mlworks_exit";
require "_batch";

(* Require basis/__general so that the daily build, which builds the batch 
   project without first building the basis project, still builds all the mos 
   it needs.  We can remove this when the process of building a project is 
   altered so that it brings all of its subprojects uptodate first. *)

require "../basis/__general";

structure Batch_ = Batch(
  structure Io = MLWorksIo_
  structure Encapsulate = Encapsulate_
  structure User_Options = UserOptions_
  structure TopLevel = TopLevel_
  structure ProjFile = ProjFile_
  structure Version = Version_
  structure License = License_
  structure Exit = MLWorksExit);

MLWorks.Internal.Runtime.modules := [];
val _ = MLWorksExit.exit (Batch_.obey (MLWorks.arguments ()));
@


1.29
log
@[Bug #190553]
Replaced use of basis/exit with utils/mlworks_exit.
@
text
@d9 4
d121 1
a121 1
require "__mlworks_exit";
@


1.28
log
@[Bug #170109]
Make the batch project rely on basis/__general to keep the daily build happy
@
text
@d9 4
d117 1
a117 1
require "../basis/__exit";
d135 1
a135 1
  structure Exit = Exit_);
d138 1
a138 1
val _ = Exit_.exit (Batch_.obey (MLWorks.arguments ()));
@


1.28.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a8 4
 * Revision 1.28  1999/02/05  14:44:14  mitchell
 * [Bug #170109]
 * Make the batch project rely on basis/__general to keep the daily build happy
 *
@


1.27
log
@[Bug #30071]
Merge in Project Workspace changes.
@
text
@d9 4
d115 7
@


1.26
log
@[Bug #20050]
main/io now exports MLWORKS_IO
@
text
@d9 14
d103 1
a103 1
require "__io";
d107 1
d117 1
@


1.26.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a8 4
 * Revision 1.26  1997/05/12  16:12:40  jont
 * [Bug #20050]
 * main/io now exports MLWORKS_IO
 *
@


1.26.2.2
log
@[Bug #30071]
Converted build system to project workspace.
@
text
@a8 3
 * Revision 1.26.2.1  1997/09/11  20:57:14  daveb
 * branched from trunk for label MLWorks_workspace_97
 *
a96 1
require "__proj_file";
a105 1
  structure ProjFile = ProjFile_
@


1.26.2.3
log
@[Bug #30326]
@
text
@a8 4
 * Revision 1.26.2.2  1997/09/17  16:24:56  daveb
 * [Bug #30071]
 * Converted build system to project workspace.
 *
d96 1
a96 1
require "__mlworks_io";
@


1.26.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a8 4
 * Revision 1.26  1997/05/12  16:12:40  jont
 * [Bug #20050]
 * main/io now exports MLWORKS_IO
 *
@


1.25
log
@Addeded Licesnnse parameter.
@
text
@d9 3
d98 1
a98 1
  structure Io = Io_
@


1.25.5.1
log
@branched from 1.25
@
text
@a8 3
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Addeded Licesnnse parameter.
 *
@


1.25.5.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a8 3
 * Revision 1.25.5.1  1997/05/12  10:36:15  hope
 * branched from 1.25
 *
@


1.25.5.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a8 3
 * Revision 1.25.5.1  1997/05/12  10:36:15  hope
 * branched from 1.25
 *
@


1.25.5.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a8 3
 * Revision 1.25.5.1  1997/05/12  10:36:15  hope
 * branched from 1.25
 *
@


1.25.5.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a8 3
 * Revision 1.25.5.1.1.1  1997/07/28  18:21:56  daveb
 * branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.25.4.1
log
@branched from 1.25
@
text
@a8 3
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Addeded Licesnnse parameter.
 *
@


1.25.3.1
log
@branched from 1.25
@
text
@a8 3
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Addeded Licesnnse parameter.
 *
@


1.25.3.1.1.1
log
@branched from 1.25.3.1
@
text
@a8 3
 * Revision 1.25.3.1  1996/12/17  17:49:41  hope
 * branched from 1.25
 *
@


1.25.2.1
log
@branched from 1.25
@
text
@a8 3
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Addeded Licesnnse parameter.
 *
@


1.25.1.1
log
@branched from 1.25
@
text
@a8 3
 * Revision 1.25  1996/11/06  12:09:08  daveb
 * Addeded Licesnnse parameter.
 *
@


1.25.1.1.1.1
log
@branched from 1.25.1.1
@
text
@a8 3
 * Revision 1.25.1.1  1996/11/14  12:51:57  hope
 * branched from 1.25
 *
@


1.24
log
@[Bug #1614]
basifying String
@
text
@d9 4
d89 1
d100 1
@


1.23
log
@Update wrt MLWorks.OS.arguments -> MLWorks.arguments
@
text
@d9 3
a80 1
require "../utils/__lists";
a93 1
  structure Lists = Lists_
@


1.23.3.1
log
@branched from 1.23
@
text
@a8 3
 * Revision 1.23  1996/05/16  12:49:47  stephenb
 * Update wrt MLWorks.OS.arguments -> MLWorks.arguments
 *
@


1.23.2.1
log
@branched from 1.23
@
text
@a8 3
 * Revision 1.23  1996/05/16  12:49:47  stephenb
 * Update wrt MLWorks.OS.arguments -> MLWorks.arguments
 *
@


1.23.1.1
log
@branched from 1.23
@
text
@a8 3
 * Revision 1.23  1996/05/16  12:49:47  stephenb
 * Update wrt MLWorks.OS.arguments -> MLWorks.arguments
 *
@


1.22
log
@Update wrt move of file "main" to basis.
@
text
@d9 3
d97 1
a97 1
val _ = Exit_.exit (Batch_.obey (MLWorks.OS.arguments ()));
@


1.21
log
@Use basis integer structure
@
text
@d9 3
d81 1
a81 1
require "__exit";
@


1.20
log
@Replace any use of MLWorks.exit by Exit.exit.
@
text
@d9 3
a72 1
require "../utils/__integer";
a86 1
  structure Integer = Integer_
@


1.19
log
@Remove __option
@
text
@d9 3
d76 1
d86 2
a87 1
  structure Version = Version_);
d90 1
a90 2
MLWorks.exit (Batch_.obey (MLWorks.OS.arguments ()));

@


1.18
log
@Reordering requires a bit
@
text
@d9 3
a67 1
require "../utils/__option";
a81 1
  structure Option = Option_
@


1.17
log
@Removed Recompile parameter.
@
text
@d9 3
d66 1
a68 1
require "__toplevel";
@


1.16
log
@Added the Integer parameter.
@
text
@d9 3
a62 1
require "../make/__recompile";
a74 1
  structure Recompile = Recompile_
@


1.15
log
@Removed Preferences parameter.
@
text
@d9 3
d58 1
d75 1
@


1.14
log
@Removed the FileSys parameter.
@
text
@d9 3
a61 1
require "__preferences";
a67 1
  structure Preferences = Preferences_
@


1.13
log
@Replaced FileName parameter.
@
text
@d9 3
a52 1
require "../system/__filesys";
a69 1
  structure FileSys = FileSys_
@


1.12
log
@Move OS specific stuff into a system link directory
@
text
@d9 3
d50 1
a50 1
require "../system/__filename";
d68 1
a68 1
  structure FileName = FileName_
@


1.11
log
@Added Preferences argument.
@
text
@d9 3
d47 1
a47 1
require "../utils/__unixfilename";
d65 1
a65 1
  structure FileName = UnixFileName_
@


1.10
log
@Adding UnixFilename parameter.
@
text
@d9 3
d51 1
d58 1
@


1.9
log
@Added Encapsulate argument.
@
text
@d9 3
d41 1
d57 1
@


1.8
log
@Added Option parameter.
@
text
@d9 3
d40 1
d48 1
@


1.8.1.1
log
@Fork for bug fixing
@
text
@a8 3
 *  Revision 1.8  1993/08/04  14:52:18  daveb
 *  Added Option parameter.
 *
@


1.7
log
@The batch compiler now returns a status code.
@
text
@d9 3
d34 1
d48 1
@


1.6
log
@Moved user_options and version from interpreter to main
@
text
@d9 3
d47 1
a47 1
Batch_.obey (MLWorks.OS.arguments ());
@


1.5
log
@Added Io_ structure to functor parameter
@
text
@d9 3
d31 2
a32 1
require "../interpreter/__version";
d37 1
@


1.4
log
@The module table is cleared before invoking the batch compiler.
The version module is a new parameter.
@
text
@d9 4
a24 1
require "../utils/__option";
d26 1
d31 6
a36 5
structure Batch_ = Batch(structure TopLevel = TopLevel_
                         structure Recompile = Recompile_
                         structure Option = Option_
                         structure Lists = Lists_
                         structure Version = Version_);
@


1.3
log
@Added option parameter. removed info parameter
@
text
@d9 3
d24 1
d30 2
a31 1
                         structure Lists = Lists_);
d33 1
@


1.2
log
@Changed Error structure to Info
@
text
@d9 3
d18 1
a19 1
require "__info";
a23 1
                         structure Info = Info_
d25 1
@


1.1
log
@Initial revision
@
text
@d8 4
a11 1
 *  $Log$
d16 1
a16 1
require "__error";
d21 1
a21 1
                         structure Error = Error_
@
