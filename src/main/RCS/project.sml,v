head	1.19;
access;
symbols
	MLW_daveb_inline_1_4_99:1.19.1
	MLWorks_21c0_1999_03_25:1.19
	MLWorks_20c1_1998_08_20:1.16
	MLWorks_20c0_1998_08_04:1.16
	MLWorks_20b2c2_1998_06_19:1.16
	MLWorks_20b2_Windows_1998_06_12:1.16
	MLWorks_20b1c1_1998_05_07:1.16
	MLWorks_20b0_1998_04_07:1.14
	MLWorks_20b0_1998_03_20:1.14
	MLWorks_20m2_1998_02_16:1.14
	MLWorks_20m1_1997_10_23:1.12
	MLWorks_11r1:1.11.8.1.1.1.1
	MLWorks_workspace_97:1.12.2
	MLWorks_dt_wizard:1.12.1
	MLWorks_11c0_1997_09_09:1.11.8.1.1.1
	MLWorks_10r3:1.11.8.1.3
	MLWorks_10r2_551:1.11.8.1.2
	MLWorks_11:1.11.8.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.11.8.1
	MLWorks_20m0_1997_06_20:1.12
	MLWorks_1_0_r2c2_1997_06_14:1.11.8.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.11.8.1
	MLWorks_1_0_r2c1_1997_05_12:1.11.8
	MLWorks_BugFix_1997_04_24:1.11
	MLWorks_1_0_r2_Win32_1997_04_11:1.11
	MLWorks_1_0_r2_Unix_1997_04_04:1.11
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.11.6.1.1
	MLWorks_gui_1996_12_18:1.11.7
	MLWorks_1_0_Win32_1996_12_17:1.11.6
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.11.4.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.11.4.1
	MLWorks_1_0_Irix_1996_11_28:1.11.4.1.1
	MLWorks_1_0_Win32_1996_11_22:1.11.5
	MLWorks_1_0_Unix_1996_11_14:1.11.4
	MLWorks_Open_Beta2_1996_10_11:1.11.3
	MLWorks_License_dev:1.11.2
	MLWorks_1_open_beta_1996_09_13:1.11.1
	MLWorks_Open_Beta_1996_08_22:1.11
	MLWorks_Beta_1996_07_02:1.9
	MLWorks_Beta_1996_06_07:1.9
	MLWorks_Beta_1996_06_06:1.9
	MLWorks_Beta_1996_06_05:1.9
	MLWorks_Beta_1996_06_03:1.9
	MLWorks_Beta_1996_05_31:1.9
	MLWorks_Beta_1996_05_30:1.9;
locks; strict;
comment	@ * @;


1.19
date	99.03.18.08.50.49;	author mitchell;	state Exp;
branches
	1.19.1.1;
next	1.18;

1.18
date	99.02.09.09.50.01;	author mitchell;	state Exp;
branches;
next	1.17;

1.17
date	98.11.26.10.46.05;	author johnh;	state Exp;
branches;
next	1.16;

1.16
date	98.04.24.15.30.43;	author mitchell;	state Exp;
branches;
next	1.15;

1.15
date	98.04.22.14.41.54;	author jont;	state Exp;
branches;
next	1.14;

1.14
date	98.02.06.11.24.32;	author johnh;	state Exp;
branches;
next	1.13;

1.13
date	97.10.20.16.33.43;	author jont;	state Exp;
branches;
next	1.12;

1.12
date	97.05.01.12.44.33;	author jont;	state Exp;
branches
	1.12.1.1
	1.12.2.1;
next	1.11;

1.11
date	96.07.30.11.17.18;	author daveb;	state Exp;
branches
	1.11.1.1
	1.11.2.1
	1.11.3.1
	1.11.4.1
	1.11.5.1
	1.11.6.1
	1.11.7.1
	1.11.8.1;
next	1.10;

1.10
date	96.07.02.09.24.18;	author daveb;	state Exp;
branches;
next	1.9;

1.9
date	96.04.02.11.10.28;	author daveb;	state Exp;
branches;
next	1.8;

1.8
date	96.03.20.16.11.13;	author daveb;	state Exp;
branches;
next	1.7;

1.7
date	96.03.18.17.19.56;	author daveb;	state Exp;
branches;
next	1.6;

1.6
date	96.03.14.10.51.06;	author daveb;	state Exp;
branches;
next	1.5;

1.5
date	96.03.06.13.15.15;	author daveb;	state Exp;
branches;
next	1.4;

1.4
date	96.02.27.14.54.57;	author daveb;	state Exp;
branches;
next	1.3;

1.3
date	95.12.07.17.03.23;	author daveb;	state Exp;
branches;
next	1.2;

1.2
date	95.12.06.18.04.03;	author daveb;	state Exp;
branches;
next	1.1;

1.1
date	95.12.05.10.52.26;	author daveb;	state Exp;
branches;
next	;

1.11.1.1
date	96.09.13.11.18.23;	author hope;	state Exp;
branches;
next	;

1.11.2.1
date	96.10.07.16.08.16;	author hope;	state Exp;
branches;
next	;

1.11.3.1
date	96.10.17.11.26.30;	author hope;	state Exp;
branches;
next	;

1.11.4.1
date	96.11.14.12.51.49;	author hope;	state Exp;
branches
	1.11.4.1.1.1;
next	;

1.11.4.1.1.1
date	96.11.28.15.02.51;	author hope;	state Exp;
branches;
next	;

1.11.5.1
date	96.11.22.18.11.02;	author hope;	state Exp;
branches;
next	;

1.11.6.1
date	96.12.17.17.49.36;	author hope;	state Exp;
branches
	1.11.6.1.1.1;
next	;

1.11.6.1.1.1
date	97.02.24.11.39.45;	author hope;	state Exp;
branches;
next	;

1.11.7.1
date	96.12.18.09.43.39;	author hope;	state Exp;
branches;
next	;

1.11.8.1
date	97.05.12.10.36.09;	author hope;	state Exp;
branches
	1.11.8.1.1.1
	1.11.8.1.2.1
	1.11.8.1.3.1;
next	;

1.11.8.1.1.1
date	97.07.28.18.21.50;	author daveb;	state Exp;
branches
	1.11.8.1.1.1.1.1;
next	;

1.11.8.1.1.1.1.1
date	97.10.07.11.47.30;	author jkbrook;	state Exp;
branches;
next	;

1.11.8.1.2.1
date	97.09.08.17.15.15;	author daveb;	state Exp;
branches;
next	;

1.11.8.1.3.1
date	97.09.09.14.11.07;	author daveb;	state Exp;
branches;
next	;

1.12.1.1
date	97.09.10.19.27.08;	author brucem;	state Exp;
branches;
next	;

1.12.2.1
date	97.09.11.20.57.09;	author daveb;	state Exp;
branches;
next	1.12.2.2;

1.12.2.2
date	97.09.17.15.41.44;	author daveb;	state Exp;
branches;
next	1.12.2.3;

1.12.2.3
date	97.10.29.11.48.46;	author daveb;	state Exp;
branches;
next	1.12.2.4;

1.12.2.4
date	97.11.26.16.23.04;	author daveb;	state Exp;
branches;
next	1.12.2.5;

1.12.2.5
date	97.12.03.19.22.34;	author daveb;	state Exp;
branches;
next	;

1.19.1.1
date	99.04.01.17.57.50;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
A project stores information about all the files used in a program.
@


1.19
log
@[Bug #190532]
Export map_dag
@
text
@(*
 * $Log: project.sml,v $
 * Revision 1.18  1999/02/09  09:50:01  mitchell
 * [Bug #190505]
 * Support for precompilation of subprojects
 *
 * Revision 1.17  1998/11/26  10:46:05  johnh
 * [Bug #70240]
 * Change delete function and add function to return units in main project only.
 *
 * Revision 1.16  1998/04/24  15:30:43  mitchell
 * [Bug #30389]
 * Keep projects more in step with projfiles
 *
 * Revision 1.15  1998/04/22  14:41:54  jont
 * [Bug #70091]
 * Remove req_name from DEPEND_LIST
 *
 * Revision 1.14  1998/02/06  11:24:32  johnh
 * [Bug #30071]
 * Merge in Project Workspace changes.
 * Added pervasiveObjectName.
 *
 * Revision 1.13  1997/10/20  16:33:43  jont
 * [Bug #30089]
 * Replacing MLWorks.Time with Time from the basis
 *
 * Revision 1.12.2.5  1997/12/03  19:22:34  daveb
 * [Bug #30071]
 * Made fromFileInfo take a project to update.
 * Removed update function.
 *
 * Revision 1.12.2.4  1997/11/26  16:23:04  daveb
 * [Bug #30071]
 * Removed Module type.
 *
 * Revision 1.12.2.3  1997/10/29  11:48:46  daveb
 * Merged from trunk:
 * Replacing MLWorks.Time with Time from the basis
 *
 * Revision 1.12.2.2  1997/09/17  15:41:44  daveb
 * [Bug #30071]
 * Converted build system to project workspace.
 *
 * Revision 1.12.2.1  1997/09/11  20:57:09  daveb
 * branched from trunk for label MLWorks_workspace_97
 *
 * Revision 1.12  1997/05/01  12:44:33  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
 * Revision 1.10  1996/07/02  09:24:18  daveb
 * Bug 1448/Support Calls 35 & 37: Added remove_file_info and modified checks
 * to permit missing file information.
 *
 * Revision 1.9  1996/04/02  11:10:28  daveb
 * Renamed load_dependencies to read_dependencies.
 *
 * Revision 1.8  1996/03/20  16:11:13  daveb
 * Added delete function.
 *
 * Revision 1.7  1996/03/18  17:19:56  daveb
 * Added is_visible and set_visible functions.
 *
 * Revision 1.6  1996/03/14  10:51:06  daveb
 * Changed type of loaded field to store just the basis and id_cache fields
 * of the Compiler.Result type.
 *
 * Revision 1.5  1996/03/06  13:15:15  daveb
 * Fixed information stored for loaded modules.
 *
 * Revision 1.4  1996/02/27  14:54:57  daveb
 * Hid implementation of the Unit type.
 *
 * Revision 1.3  1995/12/07  17:03:23  daveb
 * Added header.
 *
 *  
 * Copyright (c) 1995 Harlequin Ltd.
 *)

require "../main/info";
require "../system/__time";

signature PROJECT =
sig
  structure Info: INFO

  type ModuleId

  type ('a, 'b) Map
  type CompilerBasis
  type IdCache

  (* This is the consistency information stored in each .mo file. *)
  datatype Dependencies =
    DEPEND_LIST of
      {mod_name : string, time : Time.time} list

  (* This is the information stored for each loaded compilation unit. *)
  datatype FileTime =
    OBJECT of Time.time
  | SOURCE of Time.time

  (* The target_type type specifies the possible types of deliverable. *)
  type target_type

  (* This is the type that stores information about all compilation units
     needed by a program. *)
  type Project

  (* Map a project transformer over a project and all its subprojects,
     preserving the dag structure.  In this operation two projects are 
     considered equal if they have the same name and current targets *)
  val map_dag: (Project -> Project) -> Project -> Project

  val currentTargets:
	Project -> string list

  val get_project_name: Project -> string

  val get_name:
	Project * ModuleId -> ModuleId

  val module_id_in_project:
        Project * ModuleId -> bool

  val get_requires:
	Project * ModuleId -> ModuleId list

  val get_external_requires:
	Project -> (Project * ModuleId) list 

  val get_subprojects:
        Project -> Project list

  val set_subprojects:
        Project * Project list -> Project

  (* The "visible" attribute records whether the contents of a loaded module 
     have been added to the user's context. *)
  val is_visible:
	Project * ModuleId -> bool

  val set_visible:
	Project * ModuleId * bool -> unit


  val get_source_info:
	Project * ModuleId
	-> (string * Time.time) option

  val set_source_info:
	Project * ModuleId
	* (string * Time.time) option
	-> unit

  val get_object_info:
	Project * ModuleId
	-> {file: string,
	    file_time: Time.time,
	    time_stamp: Time.time,
	    stamps: int,
	    consistency: Dependencies} option

  val set_object_info:
	Project * ModuleId
	* {file: string,
	   file_time: Time.time,
	   time_stamp: Time.time,
	   stamps: int,
	   consistency: Dependencies} option
	-> unit

  val get_loaded_info:
	Project * ModuleId
        -> {file_time: FileTime,
            load_time: Time.time,
            basis: CompilerBasis,
            id_cache: IdCache,
            module: MLWorks.Internal.Value.T,
            dependencies: Dependencies} option

  val set_loaded_info:
	Project * ModuleId
        *  {file_time: FileTime,
            load_time: Time.time,
            basis: CompilerBasis,
            id_cache: IdCache,
            module: MLWorks.Internal.Value.T,
            dependencies: Dependencies} option
	-> unit

  val clear_all_loaded_info:
	Project * (ModuleId -> bool) -> unit
  (* clear_all_loaded_info (proj, pred); sets the loaded field to NONE
     for all units in the project that satisfy pred. *)

  val initialize: (Info.options * Info.Location.T) -> Project

  val delete: Project * ModuleId * bool -> Project

  val list_units: Project -> (string * ModuleId) list

  (* The StatusMap type stores information about those units for which
     information has been updated during a particular command.  There
     are currently two statuses that may be stored:
	visited: the dependency information is up to date
	compiled: the object file is up to date.
   *)
  type StatusMap

  val empty_map : StatusMap
  val visited_pervasives : StatusMap
  val mark_visited : StatusMap * ModuleId -> StatusMap
  val mark_compiled : StatusMap * ModuleId -> StatusMap

  (* The map argument to read_dependencies is a map of modules that are
     known to have up to date information stored in the project.  This
     is used to avoid reading information from files unnecessarily. *)
  val read_dependencies:
	(Info.options * Info.Location.T)
	-> (Project * ModuleId * StatusMap)
	-> (Project * StatusMap)

  val read_object_dependencies:
	(Info.options * Info.Location.T)
	-> (Project * ModuleId * StatusMap)
	-> (Project * StatusMap)

  val check_load_objects:
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> ModuleId list

  val check_load_source:
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> ModuleId list

  val check_perv_loaded:
	(Info.options * Info.Location.T)
	-> Project
	-> ModuleId list

  val check_compiled:
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> ModuleId list

  (* The check_compiled' command differs from check_compiled in that it takes
     explicit (out_of_date, visited) arguments, and returns updated versions
     of both. The visited argument stores whether a unit has been visited or
     is up to date.  It must be kept distinct from maps passed to
     read_dependences. *)
  val check_compiled':
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> (ModuleId list * StatusMap)
	-> (ModuleId list * StatusMap)

  val check_perv_compiled:
	(Info.options * Info.Location.T)
	-> Project
	-> ModuleId list

  val allObjects:
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> ModuleId list

  val objectName:
	(Info.options * Info.Location.T) 
	-> (Project * ModuleId)
	-> string

  val pervasiveObjectName: ModuleId -> string

  val reset_pervasives: Project -> unit
  (* reset_pervasives removes all information about the pervasive files
     from the project, leaving only the information about the loaded
     modules.  This allows the batch compilation to use a different set of
     pervasives from those in the interpreter.  *)

  val remove_file_info: Project -> unit
  (* remove_file_info removes all information about the files associated
     with all units in the project, leaving only the information about
     the loaded modules.  This is used for creating distribution images. *)

  (* fromFileInfo updates the Project argument with information from
     the current project file.  This replaces the source path, library
     path, etc. information in the Project.  It leaves the existing
     file information in place. *)
  val fromFileInfo: 
	(Info.options * Info.Location.T)
	-> Project
	-> Project

  val update_dependencies: 
	(Info.options * Info.Location.T)
	-> Project
	-> Project
end

@


1.19.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a2 4
 * Revision 1.19  1999/03/18  08:50:49  mitchell
 * [Bug #190532]
 * Export map_dag
 *
@


1.18
log
@[Bug #190505]
Support for precompilation of subprojects
@
text
@d3 4
d114 5
@


1.17
log
@[Bug #70240]
Change delete function and add function to return units in main project only.
@
text
@d3 4
d114 2
d119 3
d125 8
@


1.16
log
@[Bug #30389]
Keep projects more in step with projfiles
@
text
@d3 4
d178 1
a178 1
  val delete: Project * ModuleId -> Project
@


1.15
log
@[Bug #70091]
Remove req_name from DEPEND_LIST
@
text
@d3 4
d271 5
d277 1
@


1.14
log
@[Bug #30071]
Merge in Project Workspace changes.
Added pervasiveObjectName.
@
text
@d3 5
d85 1
a85 1
      {mod_name : string, req_name : string, time : Time.time} list
@


1.13
log
@[Bug #30089]
Replacing MLWorks.Time with Time from the basis
@
text
@d3 24
d72 1
a72 2
  type Module
  type Options
d87 3
d94 3
d115 1
a115 1
	-> (string * Module * Time.time) option
d119 1
a119 1
	* (string * Module * Time.time) option
d231 12
d253 9
@


1.12
log
@[Bug #30088]
Get rid of MLWorks.Option
@
text
@d3 4
d41 1
d57 1
a57 1
      {mod_name : string, req_name : string, time : MLWorks.Time.time} list
d61 2
a62 2
    OBJECT of MLWorks.Time.time
  | SOURCE of MLWorks.Time.time
d86 1
a86 1
	-> (string * Module * MLWorks.Time.time) option
d90 1
a90 1
	* (string * Module * MLWorks.Time.time) option
d96 2
a97 2
	    file_time: MLWorks.Time.time,
	    time_stamp: MLWorks.Time.time,
d104 2
a105 2
	   file_time: MLWorks.Time.time,
	   time_stamp: MLWorks.Time.time,
d113 1
a113 1
            load_time: MLWorks.Time.time,
d122 1
a122 1
            load_time: MLWorks.Time.time,
@


1.12.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a2 4
 * Revision 1.12  1997/05/01  12:44:33  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
@


1.12.2.2
log
@[Bug #30071]
Converted build system to project workspace.
@
text
@a2 3
 * Revision 1.12.2.1  1997/09/11  20:57:09  daveb
 * branched from trunk for label MLWorks_workspace_97
 *
a62 3
  (* The target_type type specifies the possible types of deliverable. *)
  type target_type

a66 3
  val currentTargets:
	Project -> string list

d85 1
a85 1
	-> (string * MLWorks.Time.time) option
d89 1
a89 1
	* (string * MLWorks.Time.time) option
a134 10
  val update:
        (Info.options * Info.Location.T)
	-> Project
        -> {sourcePath: string list,
            objectsLoc: string,
            libraryPath: string list,
            curTargets: string list,
            disTargets: string list}
       -> Project

a200 10
  val allObjects:
	(Info.options * Info.Location.T)
	-> Project * ModuleId
	-> ModuleId list

  val objectName:
	(Info.options * Info.Location.T) 
	-> (Project * ModuleId)
	-> string

a210 4

  val fromFileInfo: 
	(Info.options * Info.Location.T)
	-> Project
@


1.12.2.3
log
@Merged from trunk:
Replacing MLWorks.Time with Time from the basis
@
text
@a2 4
 * Revision 1.12.2.2  1997/09/17  15:41:44  daveb
 * [Bug #30071]
 * Converted build system to project workspace.
 *
a43 1
require "../system/__time";
d59 1
a59 1
      {mod_name : string, req_name : string, time : Time.time} list
d63 2
a64 2
    OBJECT of Time.time
  | SOURCE of Time.time
d94 1
a94 1
	-> (string * Time.time) option
d98 1
a98 1
	* (string * Time.time) option
d104 2
a105 2
	    file_time: Time.time,
	    time_stamp: Time.time,
d112 2
a113 2
	   file_time: Time.time,
	   time_stamp: Time.time,
d121 1
a121 1
            load_time: Time.time,
d130 1
a130 1
            load_time: Time.time,
@


1.12.2.4
log
@[Bug #30071]
Removed Module type.
@
text
@a2 4
 * Revision 1.12.2.3  1997/10/29  11:48:46  daveb
 * Merged from trunk:
 * Replacing MLWorks.Time with Time from the basis
 *
d55 2
a56 1

@


1.12.2.5
log
@[Bug #30071]
Made fromFileInfo take a project to update.
Removed update function.
@
text
@a2 4
 * Revision 1.12.2.4  1997/11/26  16:23:04  daveb
 * [Bug #30071]
 * Removed Module type.
 *
d152 10
a248 4
  (* fromFileInfo updates the Project argument with information from
     the current project file.  This replaces the source path, library
     path, etc. information in the Project.  It leaves the existing
     file information in place. *)
a250 1
	-> Project
@


1.12.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a2 4
 * Revision 1.12  1997/05/01  12:44:33  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
@


1.11
log
@Added comment to explain StatusMap argument to check_compiled'.
@
text
@d3 3
d81 1
a81 1
	-> (string * Module * MLWorks.Time.time) MLWorks.Option.option
d85 1
a85 1
	* (string * Module * MLWorks.Time.time) MLWorks.Option.option
d94 1
a94 1
	    consistency: Dependencies} MLWorks.Option.option
d102 1
a102 1
	   consistency: Dependencies} MLWorks.Option.option
d112 1
a112 1
            dependencies: Dependencies} MLWorks.Option.option
d121 1
a121 1
            dependencies: Dependencies} MLWorks.Option.option
@


1.11.8.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.8.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a2 3
 * Revision 1.11.8.1  1997/05/12  10:36:09  hope
 * branched from 1.11
 *
@


1.11.8.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a2 3
 * Revision 1.11.8.1  1997/05/12  10:36:09  hope
 * branched from 1.11
 *
@


1.11.8.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a2 3
 * Revision 1.11.8.1  1997/05/12  10:36:09  hope
 * branched from 1.11
 *
@


1.11.8.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a2 3
 * Revision 1.11.8.1.1.1  1997/07/28  18:21:50  daveb
 * branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.11.7.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.6.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.6.1.1.1
log
@branched from 1.11.6.1
@
text
@a2 3
 * Revision 1.11.6.1  1996/12/17  17:49:36  hope
 * branched from 1.11
 *
@


1.11.5.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.4.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.4.1.1.1
log
@branched from 1.11.4.1
@
text
@a2 3
 * Revision 1.11.4.1  1996/11/14  12:51:49  hope
 * branched from 1.11
 *
@


1.11.3.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.2.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.11.1.1
log
@branched from 1.11
@
text
@a2 3
 * Revision 1.11  1996/07/30  11:17:18  daveb
 * Added comment to explain StatusMap argument to check_compiled'.
 *
@


1.10
log
@Bug 1448/Support Calls 35 & 37: Added remove_file_info and modified checks
to permit missing file information.
@
text
@d3 4
d178 5
@


1.9
log
@Renamed load_dependencies to read_dependencies.
@
text
@d3 3
d190 5
@


1.8
log
@Added delete function.
@
text
@d3 3
d138 1
a138 1
  (* The map argument to load_dependencies is a map of modules that are
d141 1
a141 1
  val load_dependencies:
d146 1
a146 1
  val load_object_dependencies:
@


1.7
log
@Added is_visible and set_visible functions.
@
text
@d3 3
d118 2
a183 1

@


1.6
log
@Changed type of loaded field to store just the basis and id_cache fields
of the Compiler.Result type.
@
text
@d3 4
d52 10
@


1.5
log
@Fixed information stored for loaded modules.
@
text
@d3 3
d26 2
a27 1
  type CompilerResult
d79 2
a80 1
            result: CompilerResult,
d88 2
a89 1
            result: CompilerResult,
@


1.4
log
@Hid implementation of the Unit type.
@
text
@d3 3
d26 2
a27 2
  datatype Consistency =
    CONSISTENCY of
d30 5
d56 5
a60 2
	-> (string * MLWorks.Time.time * int * Consistency)
	      MLWorks.Option.option
d64 5
a68 2
	* (string * MLWorks.Time.time * int * Consistency)
	     MLWorks.Option.option
d73 5
a77 2
	-> (MLWorks.Time.time * CompilerResult * MLWorks.Internal.Value.T
	    * Consistency) MLWorks.Option.option
d81 5
a85 2
	* (MLWorks.Time.time * CompilerResult * MLWorks.Internal.Value.T
	   * Consistency) MLWorks.Option.option
d106 1
d123 1
a123 1
  val check_loaded:
d138 1
a138 1
  val check_objects:
d143 1
a143 1
  val check_objects':
d149 1
a149 1
  val check_perv_objects:
d153 7
@


1.3
log
@Added header.
@
text
@d2 4
a5 1
 * $Log$
d27 3
a29 22
  (* This is how the project manager represents a compilation unit. *)
  datatype Unit = UNIT of
    {name:      ModuleId,
     source:    (string * Module * MLWorks.Time.time) MLWorks.Option.option ref,
     requires:  ModuleId list ref,
     loaded:   (MLWorks.Time.time * CompilerResult * MLWorks.Internal.Value.T
		* Consistency) MLWorks.Option.option ref,
     visible:   bool ref,  (* Should it be visible at top level when loaded? *)
     options:   Options MLWorks.Option.option ref,
        (* What options should it be compiled with? *)
     object:
	(string * MLWorks.Time.time * int * Consistency)
           MLWorks.Option.option ref
        (* The int is the stamps field returned by Encapsulate.input_info *)
        (* objects should store their compiler options too *)
    } ;

  (* This is how the system represents a project.  The pervasive
     library is referenced implicitly by all user compilation units. *)
  datatype Project =
    PROJECT of
       (ModuleId, Unit) Map
d34 3
d68 4
a71 4
  val for_all:
	Project * (ModuleId -> bool) * (Unit -> unit) -> unit
  (* for_all (proj, pred, action); performs action for all entries in
     the project that satisfy pred. *)
@


1.2
log
@Added for_all function.
@
text
@d1 6
@


1.1
log
@new unit
A project stores information about all the files used in a program.
@
text
@d75 5
@
