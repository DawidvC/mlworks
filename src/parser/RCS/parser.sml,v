head	1.23;
access;
symbols
	MLW_daveb_inline_1_4_99:1.23.11
	MLWorks_21c0_1999_03_25:1.23
	MLWorks_20c1_1998_08_20:1.23
	MLWorks_20c0_1998_08_04:1.23
	MLWorks_20b2c2_1998_06_19:1.23
	MLWorks_20b2_Windows_1998_06_12:1.23
	MLWorks_20b1c1_1998_05_07:1.23
	MLWorks_20b0_1998_04_07:1.23
	MLWorks_20b0_1998_03_20:1.23
	MLWorks_20m2_1998_02_16:1.23
	MLWorks_20m1_1997_10_23:1.23
	MLWorks_11r1:1.23.8.1.1.1.1
	MLWorks_workspace_97:1.23.10
	MLWorks_dt_wizard:1.23.9
	MLWorks_11c0_1997_09_09:1.23.8.1.1.1
	MLWorks_10r3:1.23.8.1.3
	MLWorks_10r2_551:1.23.8.1.2
	MLWorks_11:1.23.8.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.23.8.1
	MLWorks_20m0_1997_06_20:1.23
	MLWorks_1_0_r2c2_1997_06_14:1.23.8.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.23.8.1
	MLWorks_1_0_r2c1_1997_05_12:1.23.8
	MLWorks_BugFix_1997_04_24:1.23
	MLWorks_1_0_r2_Win32_1997_04_11:1.23
	MLWorks_1_0_r2_Unix_1997_04_04:1.23
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.23.6.1.1
	MLWorks_gui_1996_12_18:1.23.7
	MLWorks_1_0_Win32_1996_12_17:1.23.6
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.23.4.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.23.4.1
	MLWorks_1_0_Irix_1996_11_28:1.23.4.1.1
	MLWorks_1_0_Win32_1996_11_22:1.23.5
	MLWorks_1_0_Unix_1996_11_14:1.23.4
	MLWorks_Open_Beta2_1996_10_11:1.23.3
	MLWorks_License_dev:1.23.2
	MLWorks_1_open_beta_1996_09_13:1.23.1
	MLWorks_Open_Beta_1996_08_22:1.23
	MLWorks_Beta_1996_07_02:1.23
	MLWorks_Beta_1996_06_07:1.23
	MLWorks_Beta_1996_06_06:1.23
	MLWorks_Beta_1996_06_05:1.23
	MLWorks_Beta_1996_06_03:1.23
	MLWorks_Beta_1996_05_31:1.23
	MLWorks_Beta_1996_05_30:1.23
	ML_beta_release_12/08/94:1.22
	ML_beta_release_03/08/94:1.22
	ML_revised_beta_release_25/05/94:1.22
	ML_final_beta_release_02/03/94:1.22
	mlworks-28-01-1994:1.22
	Release:1.22
	mlworks-beta-01-09-1993:1.22
	MLWorks-1-0-4-29/01/1993:1.12
	MLWorks-1-0-3-21/12/1992:1.12
	MLWorks-1-0-2-15/12/1992:1.11
	MLWorks-1-0-1-04/12/1992:1.11
	checkpoint_17_08_92:1.5
	Ten15_release_19-11-91:1.1.1.1
	Ten15_release_21-08-91:1.1
	Ten15_release_19-08-91:1.1
	ten15_release:1.1;
locks; strict;
comment	@ * @;


1.23
date	95.02.14.12.30.27;	author matthew;	state Exp;
branches
	1.23.1.1
	1.23.2.1
	1.23.3.1
	1.23.4.1
	1.23.5.1
	1.23.6.1
	1.23.7.1
	1.23.8.1
	1.23.9.1
	1.23.10.1
	1.23.11.1;
next	1.22;

1.22
date	93.05.27.13.08.09;	author matthew;	state Exp;
branches
	1.22.1.1;
next	1.21;

1.21
date	93.04.26.16.07.52;	author jont;	state Exp;
branches;
next	1.20;

1.20
date	93.03.31.14.25.43;	author daveb;	state Exp;
branches;
next	1.19;

1.19
date	93.03.29.13.44.36;	author daveb;	state Exp;
branches;
next	1.18;

1.18
date	93.03.24.12.38.14;	author daveb;	state Exp;
branches;
next	1.17;

1.17
date	93.03.19.12.14.43;	author matthew;	state Exp;
branches;
next	1.16;

1.16
date	93.03.16.16.03.58;	author matthew;	state Exp;
branches;
next	1.15;

1.15
date	93.03.10.14.47.01;	author matthew;	state Exp;
branches;
next	1.14;

1.14
date	93.03.09.11.30.07;	author matthew;	state Exp;
branches;
next	1.13;

1.13
date	93.02.01.14.21.39;	author matthew;	state Exp;
branches;
next	1.12;

1.12
date	92.12.21.10.27.20;	author matthew;	state Exp;
branches;
next	1.11;

1.11
date	92.11.19.19.17.20;	author jont;	state Exp;
branches;
next	1.10;

1.10
date	92.11.05.16.22.15;	author matthew;	state Exp;
branches;
next	1.9;

1.9
date	92.10.14.12.35.28;	author richard;	state Exp;
branches;
next	1.8;

1.8
date	92.10.08.15.44.07;	author matthew;	state Exp;
branches;
next	1.7;

1.7
date	92.10.07.13.38.56;	author richard;	state Exp;
branches;
next	1.6;

1.6
date	92.09.02.15.35.35;	author richard;	state Exp;
branches;
next	1.5;

1.5
date	92.02.11.10.16.03;	author clive;	state Exp;
branches;
next	1.4;

1.4
date	92.02.04.17.25.18;	author jont;	state Exp;
branches;
next	1.3;

1.3
date	91.11.21.16.37.13;	author jont;	state Exp;
branches;
next	1.2;

1.2
date	91.11.19.12.21.17;	author jont;	state Exp;
branches;
next	1.1;

1.1
date	91.06.07.16.18.17;	author colin;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	91.11.19.11.12.34;	author jont;	state Exp;
branches;
next	;

1.22.1.1
date	93.05.27.13.08.09;	author jont;	state Exp;
branches;
next	;

1.23.1.1
date	96.09.13.11.20.28;	author hope;	state Exp;
branches;
next	;

1.23.2.1
date	96.10.07.16.10.24;	author hope;	state Exp;
branches;
next	;

1.23.3.1
date	96.10.17.11.28.54;	author hope;	state Exp;
branches;
next	;

1.23.4.1
date	96.11.14.12.54.35;	author hope;	state Exp;
branches
	1.23.4.1.1.1;
next	;

1.23.4.1.1.1
date	96.11.28.15.05.25;	author hope;	state Exp;
branches;
next	;

1.23.5.1
date	96.11.22.18.13.14;	author hope;	state Exp;
branches;
next	;

1.23.6.1
date	96.12.17.17.51.43;	author hope;	state Exp;
branches
	1.23.6.1.1.1;
next	;

1.23.6.1.1.1
date	97.02.24.11.42.21;	author hope;	state Exp;
branches;
next	;

1.23.7.1
date	96.12.18.09.46.02;	author hope;	state Exp;
branches;
next	;

1.23.8.1
date	97.05.12.10.38.31;	author hope;	state Exp;
branches
	1.23.8.1.1.1
	1.23.8.1.2.1
	1.23.8.1.3.1;
next	;

1.23.8.1.1.1
date	97.07.28.18.23.31;	author daveb;	state Exp;
branches
	1.23.8.1.1.1.1.1;
next	;

1.23.8.1.1.1.1.1
date	97.10.07.11.49.15;	author jkbrook;	state Exp;
branches;
next	;

1.23.8.1.2.1
date	97.09.08.17.16.55;	author daveb;	state Exp;
branches;
next	;

1.23.8.1.3.1
date	97.09.09.14.13.00;	author daveb;	state Exp;
branches;
next	;

1.23.9.1
date	97.09.10.19.29.03;	author brucem;	state Exp;
branches;
next	;

1.23.10.1
date	97.09.11.20.58.57;	author daveb;	state Exp;
branches;
next	;

1.23.11.1
date	99.04.01.17.59.27;	author daveb;	state Exp;
branches;
next	;


desc
@Main code for the parser
@


1.23
log
@Changes to Lexer signature
@
text
@(* parser.sml the signature *)
(*
$Log: parser.sml,v $
Revision 1.22  1993/05/27  13:08:09  matthew
Added sharing

Revision 1.21  1993/04/26  16:07:52  jont
Added remove_str for getting rid of FullPervasiveLibrary_ from initial env

Revision 1.20  1993/03/31  14:25:43  daveb
Exposed LexerState so that _shell can set prompts appropriately.
Added Location field to FoundTopDec so that history mechanism knows where
the topdec ends.

Revision 1.19  1993/03/29  13:44:36  daveb
Removed skip_topdec.

Revision 1.18  1993/03/24  12:38:14  daveb
Added options parameter to skip_topdec.

Revision 1.17  1993/03/19  12:14:43  matthew
Added is_initial_state function

Revision 1.16  1993/03/16  16:03:58  matthew
Changed type of parse_incrementally to fit with error wrapping

Revision 1.15  1993/03/10  14:47:01  matthew
Options changes

Revision 1.14  1993/03/09  11:30:07  matthew
Options & Info changes
Absyn changes

Revision 1.13  1993/02/01  14:21:39  matthew
Added sharing.

Revision 1.12  1992/12/21  10:27:20  matthew
Changed SyntaxError exception to include a location and print the token differently.

Revision 1.11  1992/11/19  19:17:20  jont
Removed Info structure from parser, tidied upderived

Revision 1.10  1992/11/05  16:22:15  matthew
Changed Error structure to Info

Revision 1.9  1992/10/14  12:35:28  richard
Added a missing sharing constraint.

Revision 1.8  1992/10/08  15:44:07  matthew
Added functions for incremental parsing.

Revision 1.7  1992/10/07  13:38:56  richard
Added a missing sharing constraint.

Revision 1.6  1992/09/02  15:35:35  richard
Installed central error reporting mechanism.

Revision 1.5  1992/02/11  10:16:03  clive
New pervasive library code - cut some things out of the initial type basis

Revision 1.4  1992/02/04  17:25:18  jont
Removed ident from signature (not needed)

Revision 1.3  1991/11/21  16:37:13  jont
Added copyright message

Revision 1.2  91/11/19  12:21:17  jont
Merging in comments from Ten15 branch to main trunk

Revision 1.1.1.1  91/11/19  11:12:34  jont
Added comments for DRA on functions

Revision 1.1  91/06/07  16:18:17  colin
Initial revision

Copyright (c) 1991 Harlequin Ltd.
*)

(* This signature is the externally-visible interface to the modules
in the parser directory.  parse_topdec is self-explanatory.
The type parser_basis is pB from parserenv.
Functions are provided to manipulate this type, providing the
functionality required for separate compilation: an encoded parser
basis is placed in the `spec' component of an object file, and files
which require this file can build a parser basis by augmenting
together the initial parser basis with this.

The parser functions in a top-down manner, with functions for each
syntactic class. The sources are reasonably clear: exceptions are used
for backtracking. *)

require "../lexer/lexer";
require "../basics/absyn";

signature PARSER =
    sig
        structure Lexer  : LEXER
        structure Absyn  : ABSYN
        sharing Lexer.Info.Location = Absyn.Ident.Location
        sharing Absyn.Ident.Symbol = Lexer.Token.Symbol

        type ParserBasis

	val empty_pB : ParserBasis
	val initial_pB : ParserBasis
	val initial_pB_for_builtin_library : ParserBasis
	val augment_pB : ParserBasis * ParserBasis -> ParserBasis
        
	val remove_str : ParserBasis * Absyn.Ident.StrId -> ParserBasis

        val parse_topdec :
          Lexer.Info.options ->
          Lexer.Options * Lexer.TokenStream * ParserBasis -> 
          Absyn.TopDec * ParserBasis

        (* New stuff for incremental parsing *)

        type ParserState
        val initial_parser_state : ParserState

        val is_initial_state : ParserState -> bool

        exception SyntaxError of string * Lexer.Info.Location.T
        exception FoundTopDec of
	  (Absyn.TopDec * ParserBasis * Lexer.Info.Location.T)

        val parse_incrementally :
          Lexer.Info.options ->
          (Lexer.Options * Lexer.TokenStream *
	   ParserBasis * ParserState * Lexer.Token.LexerState) ->
          (ParserBasis * ParserState * Lexer.Token.LexerState)
    end


@


1.23.11.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.10.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.9.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.8.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.8.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a3 3
 * Revision 1.23.8.1  1997/05/12  10:38:31  hope
 * branched from 1.23
 *
@


1.23.8.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a3 3
 * Revision 1.23.8.1  1997/05/12  10:38:31  hope
 * branched from 1.23
 *
@


1.23.8.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a3 3
 * Revision 1.23.8.1  1997/05/12  10:38:31  hope
 * branched from 1.23
 *
@


1.23.8.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a3 3
 * Revision 1.23.8.1.1.1  1997/07/28  18:23:31  daveb
 * branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.23.7.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.6.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.6.1.1.1
log
@branched from 1.23.6.1
@
text
@a3 3
 * Revision 1.23.6.1  1996/12/17  17:51:43  hope
 * branched from 1.23
 *
@


1.23.5.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.4.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.4.1.1.1
log
@branched from 1.23.4.1
@
text
@a3 3
 * Revision 1.23.4.1  1996/11/14  12:54:35  hope
 * branched from 1.23
 *
@


1.23.3.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.2.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.23.1.1
log
@branched from 1.23
@
text
@a3 3
 * Revision 1.23  1995/02/14  12:30:27  matthew
 * Changes to Lexer signature
 *
@


1.22
log
@Added sharing
@
text
@d4 3
a92 1
require "../main/options";
a98 1
        structure Options : OPTIONS
a100 1
        sharing type Lexer.options = Options.options
d113 1
a113 1
          Options.options * Lexer.TokenStream * ParserBasis -> 
d129 1
a129 1
          (Options.options * Lexer.TokenStream *
@


1.22.1.1
log
@Fork for bug fixing
@
text
@a3 3
Revision 1.22  1993/05/27  13:08:09  matthew
Added sharing

@


1.21
log
@Added remove_str for getting rid of FullPervasiveLibrary_ from initial env
@
text
@d4 3
d100 1
@


1.20
log
@Exposed LexerState so that _shell can set prompts appropriately.
Added Location field to FoundTopDec so that history mechanism knows where
the topdec ends.
@
text
@d4 5
d105 2
@


1.19
log
@Removed skip_topdec.
@
text
@d4 3
d113 3
a115 1
        exception FoundTopDec of (Absyn.TopDec * ParserBasis)
d118 3
a120 2
          (Options.options * Lexer.TokenStream * ParserBasis * ParserState) ->
          (ParserBasis * ParserState)
@


1.18
log
@Added options parameter to skip_topdec.
@
text
@d4 3
d66 2
a67 4
in the parser directory. It defines two principal functions,
parse_topdec and skip_topdec. parse_topdec is self-explanatory.
skip_topdec skips input to the next semicolon, and can be used to
recover from errors. The type parser_basis is pB from parserenv.
a100 4

        val skip_topdec :
	  Lexer.Info.options ->
	    (Options.options * Lexer.TokenStream) -> unit
@


1.17
log
@Added is_initial_state function
@
text
@d4 3
d101 3
a103 1
        val skip_topdec  : (Lexer.Info.options * Lexer.TokenStream) -> unit
@


1.16
log
@Changed type of parse_incrementally to fit with error wrapping
@
text
@d4 3
d104 2
@


1.15
log
@Options changes
@
text
@d4 3
d105 2
a106 2
          (Lexer.Info.options * Options.options) ->
          (Lexer.TokenStream * ParserBasis * ParserState) ->
@


1.14
log
@Options & Info changes
Absyn changes
@
text
@d4 4
d89 1
a89 1
          Options.print_options * Lexer.TokenStream * ParserBasis -> 
d102 1
a102 1
          (Lexer.Info.options * Options.print_options) ->
@


1.13
log
@Added sharing.
@
text
@d4 3
d65 1
d72 3
a74 2
        sharing Lexer.Info.Location = Absyn.Location
        sharing Absyn.Datatypes.Ident.Symbol = Lexer.Token.Symbol
d83 6
a88 4
        val parse_topdec : Lexer.Info.options ->
                           (Lexer.TokenStream * ParserBasis) -> 
                           (Absyn.TopDec * ParserBasis)
        val skip_topdec  : Lexer.Info.options * Lexer.TokenStream -> unit
d97 4
a100 1
        val parse_incrementally : Lexer.Info.options -> (Lexer.TokenStream * ParserBasis * ParserState) -> (ParserBasis * ParserState)
@


1.12
log
@Changed SyntaxError exception to include a location and print the token differently.
@
text
@d4 3
d69 1
@


1.11
log
@Removed Info structure from parser, tidied upderived
@
text
@d4 3
d84 1
a84 1
        exception SyntaxError of string
@


1.10
log
@Changed Error structure to Info
@
text
@d4 3
a56 1
require "../main/info";
d62 1
a62 3
        structure Info  : INFO
        sharing Info = Lexer.Info
        sharing Info.Location = Absyn.Location
d71 1
a71 1
        val parse_topdec : Info.options ->
d74 1
a74 1
        val skip_topdec  : Info.options * Lexer.TokenStream -> unit
d83 1
a83 1
        val parse_incrementally : Info.options -> (Lexer.TokenStream * ParserBasis * ParserState) -> (ParserBasis * ParserState)
@


1.9
log
@Added a missing sharing constraint.
@
text
@d4 3
d54 1
a54 1
require "../main/error";
d60 3
a62 3
        structure Error  : ERROR
        sharing Error = Lexer.Error
        sharing Error.Location = Absyn.Location
d71 2
a72 1
        val parse_topdec : (Lexer.TokenStream * ParserBasis) -> 
d74 1
a74 1
        val skip_topdec  : Lexer.TokenStream -> unit
d83 1
a83 1
        val parse_incrementally : (Lexer.TokenStream * ParserBasis * ParserState) -> (ParserBasis * ParserState)
@


1.8
log
@Added functions for incremental parsing.
@
text
@d4 3
d59 1
@


1.7
log
@Added a missing sharing constraint.
@
text
@d4 3
d67 9
@


1.6
log
@Installed central error reporting mechanism.
@
text
@d4 3
d52 1
@


1.5
log
@New pervasive library code - cut some things out of the initial type basis
@
text
@d4 3
d42 1
d48 1
a56 1
        exception ParseError of string
@


1.4
log
@Removed ident from signature (not needed)
@
text
@d4 3
d49 1
@


1.3
log
@Added copyright message
@
text
@d3 4
a6 1
$Log:	parser.sml,v $
a34 1
require "../basics/ident";
a39 1
        structure Ident  : IDENT
a40 2

        sharing Absyn.IdentClass = Ident
@


1.2
log
@Merging in comments from Ten15 branch to main trunk
@
text
@d1 1
d4 3
d13 1
@


1.1
log
@Initial revision
@
text
@d2 7
a8 1
$Log$
d10 15
@


1.1.1.1
log
@Added comments for DRA on functions
@
text
@d2 1
a2 4
$Log:	parser.sml,v $
Revision 1.1  91/06/07  16:18:17  colin
Initial revision

a3 15

(* This signature is the externally-visible interface to the modules
in the parser directory. It defines two principal functions,
parse_topdec and skip_topdec. parse_topdec is self-explanatory.
skip_topdec skips input to the next semicolon, and can be used to
recover from errors. The type parser_basis is pB from parserenv.
Functions are provided to manipulate this type, providing the
functionality required for separate compilation: an encoded parser
basis is placed in the `spec' component of an object file, and files
which require this file can build a parser basis by augmenting
together the initial parser basis with this.

The parser functions in a top-down manner, with functions for each
syntactic class. The sources are reasonably clear: exceptions are used
for backtracking. *)
@
