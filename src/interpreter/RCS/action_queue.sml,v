head	1.27;
access;
symbols
	MLWorks_20m1_1997_10_23:1.27
	MLWorks_11r1:1.27.1.1.1.1.1
	MLWorks_workspace_97:1.27.3
	MLWorks_dt_wizard:1.27.2
	MLWorks_11c0_1997_09_09:1.27.1.1.1.1
	MLWorks_10r3:1.27.1.1.3
	MLWorks_10r2_551:1.27.1.1.2
	MLWorks_11:1.27.1.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.27.1.1
	MLWorks_20m0_1997_06_20:1.27
	MLWorks_1_0_r2c2_1997_06_14:1.27.1.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.27.1.1
	MLWorks_1_0_r2c1_1997_05_12:1.27.1
	MLWorks_BugFix_1997_04_24:1.27
	MLWorks_1_0_r2_Win32_1997_04_11:1.27
	MLWorks_1_0_r2_Unix_1997_04_04:1.27
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.26.6.1.1
	MLWorks_gui_1996_12_18:1.26.7
	MLWorks_1_0_Win32_1996_12_17:1.26.6
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.26.4.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.26.4.1
	MLWorks_1_0_Irix_1996_11_28:1.26.4.1.1
	MLWorks_1_0_Win32_1996_11_22:1.26.5
	MLWorks_1_0_Unix_1996_11_14:1.26.4
	MLWorks_Open_Beta2_1996_10_11:1.26.3
	MLWorks_License_dev:1.26.2
	MLWorks_1_open_beta_1996_09_13:1.26.1
	MLWorks_Open_Beta_1996_08_22:1.26
	MLWorks_Beta_1996_07_02:1.25
	MLWorks_Beta_1996_06_07:1.25
	MLWorks_Beta_1996_06_06:1.25
	MLWorks_Beta_1996_06_05:1.25
	MLWorks_Beta_1996_06_03:1.25
	MLWorks_Beta_1996_05_31:1.25
	MLWorks_Beta_1996_05_30:1.25
	ML_beta_release_12/08/94:1.17
	ML_beta_release_03/08/94:1.16
	ML_revised_beta_release_25/05/94:1.15
	ML_final_beta_release_02/03/94:1.13
	mlworks-28-01-1994:1.11
	Release:1.9
	mlworks-beta-01-09-1993:1.9;
locks; strict;
comment	@ * @;


1.27
date	97.03.17.15.34.44;	author matthew;	state Exp;
branches
	1.27.1.1
	1.27.2.1
	1.27.3.1;
next	1.26;

1.26
date	96.08.20.13.50.43;	author daveb;	state Exp;
branches
	1.26.1.1
	1.26.2.1
	1.26.3.1
	1.26.4.1
	1.26.5.1
	1.26.6.1
	1.26.7.1;
next	1.25;

1.25
date	96.05.08.09.58.04;	author daveb;	state Exp;
branches;
next	1.24;

1.24
date	96.05.02.13.53.04;	author daveb;	state Exp;
branches;
next	1.23;

1.23
date	96.04.09.18.23.45;	author daveb;	state Exp;
branches;
next	1.22;

1.22
date	96.04.02.10.57.04;	author daveb;	state Exp;
branches;
next	1.21;

1.21
date	96.03.19.11.54.12;	author daveb;	state Exp;
branches;
next	1.20;

1.20
date	95.12.04.11.25.51;	author daveb;	state Exp;
branches;
next	1.19;

1.19
date	95.06.01.15.54.41;	author matthew;	state Exp;
branches;
next	1.18;

1.18
date	95.02.20.14.27.21;	author daveb;	state Exp;
branches;
next	1.17;

1.17
date	94.08.10.14.05.38;	author daveb;	state Exp;
branches;
next	1.16;

1.16
date	94.06.21.14.29.11;	author daveb;	state Exp;
branches;
next	1.15;

1.15
date	94.03.24.20.51.08;	author daveb;	state Exp;
branches;
next	1.14;

1.14
date	94.03.17.12.33.58;	author matthew;	state Exp;
branches;
next	1.13;

1.13
date	94.02.25.15.35.47;	author daveb;	state Exp;
branches;
next	1.12;

1.12
date	94.02.02.10.36.47;	author daveb;	state Exp;
branches;
next	1.11;

1.11
date	93.12.21.14.39.13;	author matthew;	state Exp;
branches;
next	1.10;

1.10
date	93.08.16.15.50.25;	author jont;	state Exp;
branches;
next	1.9;

1.9
date	93.05.26.15.30.11;	author matthew;	state Exp;
branches
	1.9.1.1;
next	1.8;

1.8
date	93.05.12.16.01.10;	author matthew;	state Exp;
branches;
next	1.7;

1.7
date	93.05.11.13.29.17;	author matthew;	state Exp;
branches;
next	1.6;

1.6
date	93.05.06.14.04.07;	author matthew;	state Exp;
branches;
next	1.5;

1.5
date	93.03.29.16.28.44;	author matthew;	state Exp;
branches;
next	1.4;

1.4
date	93.03.24.18.00.04;	author daveb;	state Exp;
branches;
next	1.3;

1.3
date	93.03.19.11.29.44;	author matthew;	state Exp;
branches;
next	1.2;

1.2
date	93.03.09.15.29.58;	author matthew;	state Exp;
branches;
next	1.1;

1.1
date	93.03.02.11.10.58;	author daveb;	state Exp;
branches;
next	;

1.9.1.1
date	93.05.26.15.30.11;	author jont;	state Exp;
branches;
next	;

1.26.1.1
date	96.09.13.11.16.24;	author hope;	state Exp;
branches;
next	;

1.26.2.1
date	96.10.07.16.06.22;	author hope;	state Exp;
branches;
next	;

1.26.3.1
date	96.10.17.11.24.37;	author hope;	state Exp;
branches;
next	;

1.26.4.1
date	96.11.14.12.49.24;	author hope;	state Exp;
branches
	1.26.4.1.1.1;
next	;

1.26.4.1.1.1
date	96.11.28.15.00.40;	author hope;	state Exp;
branches;
next	;

1.26.5.1
date	96.11.22.18.09.03;	author hope;	state Exp;
branches;
next	;

1.26.6.1
date	96.12.17.17.47.41;	author hope;	state Exp;
branches
	1.26.6.1.1.1;
next	;

1.26.6.1.1.1
date	97.02.24.11.37.27;	author hope;	state Exp;
branches;
next	;

1.26.7.1
date	96.12.18.09.41.42;	author hope;	state Exp;
branches;
next	;

1.27.1.1
date	97.05.12.10.34.09;	author hope;	state Exp;
branches
	1.27.1.1.1.1
	1.27.1.1.2.1
	1.27.1.1.3.1;
next	;

1.27.1.1.1.1
date	97.07.28.18.19.40;	author daveb;	state Exp;
branches
	1.27.1.1.1.1.1.1;
next	;

1.27.1.1.1.1.1.1
date	97.10.07.11.44.49;	author jkbrook;	state Exp;
branches;
next	;

1.27.1.1.2.1
date	97.09.08.17.13.15;	author daveb;	state Exp;
branches;
next	;

1.27.1.1.3.1
date	97.09.09.14.08.54;	author daveb;	state Exp;
branches;
next	;

1.27.2.1
date	97.09.10.19.24.18;	author brucem;	state Exp;
branches;
next	;

1.27.3.1
date	97.09.11.20.55.04;	author daveb;	state Exp;
branches;
next	;


desc
@Creates an action queue for use by shells, and provides functions
 for manipulating it.  Used to be in shell.
@


1.27
log
@Making use not use action queue
@
text
@(*  Action Queues store actions to be performed after a shell has evaluated
 *  a topdec, such as files to use or make.
 *
 *  Copyright (C) 1992,1993 Harlequin Ltd
 *
 *  $Log: action_queue.sml,v $
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
 * Revision 1.25  1996/05/08  09:58:04  daveb
 * Added Info.options argument to ActionQueue.do_actions.
 *
 * Revision 1.24  1996/05/02  13:53:04  daveb
 * Removed the Handled exception.
 *
 * Revision 1.23  1996/04/09  18:23:45  daveb
 * Added a preferences argument to do_actions, because
 * ShellUtils.{load_source_file,load_file,use_file} now require a preferences
 * argument (for passing to process_result).
 *
 * Revision 1.22  1996/04/02  10:57:04  daveb
 * Added read_dependencies_module and read_dependencies_file.
 *
 * Revision 1.21  1996/03/19  11:54:12  daveb
 * Added add_check_load_module and add_check_load_file.
 *
 * Revision 1.20  1995/12/04  11:25:51  daveb
 * Revisions for new project tool.
 *
 *  Revision 1.19  1995/06/01  15:54:41  matthew
 *  Adding touch_all function
 *
 *  Revision 1.18  1995/02/20  14:27:21  daveb
 *  do_actions now takes an output function argument.
 *
 *  Revision 1.17  1994/08/10  14:05:38  daveb
 *  Added read_dot_mlworks.
 *
 *  Revision 1.16  1994/06/21  14:29:11  daveb
 *  do_actions now takes a user_context instead of a Context ref.
 *  The Error exception no longer includes a Context (it was never used).
 *
 *  Revision 1.15  1994/03/24  20:51:08  daveb
 *  Added new commands that distinguish modules and files.
 *
 *  Revision 1.14  1994/03/17  12:33:58  matthew
 *  Added check_make
 *  /
 *
 *  Revision 1.13  1994/02/25  15:35:47  daveb
 *  Adding clear_debug functionality.
 *
 *  Revision 1.12  1994/02/02  10:36:47  daveb
 *  Replaced Incremental substructure with Options.
 *
 *  Revision 1.11  1993/12/21  14:39:13  matthew
 *  Added add_load function for loading mos
 *
 *  Revision 1.10  1993/08/16  15:50:25  jont
 *  Added add_save function
 *
 *  Revision 1.9  1993/05/26  15:30:11  matthew
 *  Added exception Handled and extended Error with error information
 *
 *  Revision 1.8  1993/05/12  16:01:10  matthew
 *  Changed ContextRef to Context ref
 *
 *  Revision 1.7  1993/05/11  13:29:17  matthew
 *  Removed parse_absolute function
 *  Changed type of do_use
 *
 *  Revision 1.6  1993/05/06  14:04:07  matthew
 *  Changed do_actions type
 *
 *  Revision 1.5  1993/03/29  16:28:44  matthew
 *  Formatting change
 *
 *  Revision 1.4  1993/03/24  18:00:04  daveb
 *  do_actions now takes a single ShellData argument.
 *
 *  Revision 1.3  1993/03/19  11:29:44  matthew
 *  do_actions now takes a context ref and returns unit.
 *  
 *  Revision 1.2  1993/03/09  15:29:58  matthew
 *  Options & Info changes
 *  
 *  Revision 1.1  1993/03/02  11:10:58  daveb
 *  Initial revision
 *  
 *
 *)

require "../main/info";

signature ACTION_QUEUE =
sig
  structure Info: INFO
  type UserOptions
  type user_context
  type preferences

  val add_load_source_module: string * Info.options -> unit
  val add_load_source_file: string * Info.options -> unit

  val add_compile_module: string * Info.options -> unit
  val add_compile_file: string * Info.options -> unit

  val add_compile_and_load_module: string * Info.options -> unit
  val add_compile_and_load_file: string * Info.options -> unit

  val add_check_load_source_module: string * Info.options -> unit
  val add_check_load_source_file: string * Info.options -> unit

  val add_check_compile_module: string * Info.options -> unit
  val add_check_compile_file: string * Info.options -> unit

  val add_save: string * Info.options -> unit

  val add_read_dependencies_module: string * Info.options -> unit
  val add_read_dependencies_file: string * Info.options -> unit

  val add_check_load_module: string * Info.options -> unit
  val add_check_load_file: string * Info.options -> unit

  val add_touch_loaded_file: string * Info.options -> unit
  val add_touch_loaded_module: string * Info.options -> unit
  val add_touch_all_loaded: Info.options -> unit

  val add_load_file: string * Info.options -> unit
  val add_load_module: string * Info.options -> unit

  val add_clear_debug_all: unit -> unit

  val add_clear_debug: string -> unit

  exception Error of (string * Info.error * Info.error list)

  val clear_queue : unit -> unit

  val do_actions :
    {user_context: user_context,
     user_options: UserOptions,
     error_info: Info.options,
     preferences: preferences,
     debugger: ((MLWorks.Internal.Value.T -> MLWorks.Internal.Value.T) ->
                (MLWorks.Internal.Value.T -> MLWorks.Internal.Value.T)),
     output_fn: string -> unit,
     monitor_fn: string -> unit}
    -> unit

end
@


1.27.3.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a6 3
 * Revision 1.27  1997/03/17  15:34:44  matthew
 * Making use not use action queue
 *
@


1.27.2.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a6 3
 * Revision 1.27  1997/03/17  15:34:44  matthew
 * Making use not use action queue
 *
@


1.27.1.1
log
@branched from 1.27
@
text
@a6 3
 * Revision 1.27  1997/03/17  15:34:44  matthew
 * Making use not use action queue
 *
@


1.27.1.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a6 3
 * Revision 1.27.1.1  1997/05/12  10:34:09  hope
 * branched from 1.27
 *
@


1.27.1.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a6 3
 * Revision 1.27.1.1  1997/05/12  10:34:09  hope
 * branched from 1.27
 *
@


1.27.1.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a6 3
 * Revision 1.27.1.1  1997/05/12  10:34:09  hope
 * branched from 1.27
 *
@


1.27.1.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a6 3
 * Revision 1.27.1.1.1.1  1997/07/28  18:19:40  daveb
 * branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.26
log
@[Bug #1480]
Implemented compile-and-load properly.
@
text
@d7 4
a99 1
  type ShellData
a102 2
  val add_use: string * Info.options -> unit

d139 2
a151 1
  val read_dot_mlworks: ShellData -> unit
@


1.26.7.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.6.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.6.1.1.1
log
@branched from 1.26.6.1
@
text
@a6 3
 * Revision 1.26.6.1  1996/12/17  17:47:41  hope
 * branched from 1.26
 *
@


1.26.5.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.4.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.4.1.1.1
log
@branched from 1.26.4.1
@
text
@a6 3
 * Revision 1.26.4.1  1996/11/14  12:49:24  hope
 * branched from 1.26
 *
@


1.26.3.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.2.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.26.1.1
log
@branched from 1.26
@
text
@a6 4
 * Revision 1.26  1996/08/20  13:50:43  daveb
 * [Bug #1480]
 * Implemented compile-and-load properly.
 *
@


1.25
log
@Added Info.options argument to ActionQueue.do_actions.
@
text
@d7 3
d107 3
@


1.24
log
@Removed the Handled exception.
@
text
@d7 3
d135 1
@


1.23
log
@Added a preferences argument to do_actions, because
ShellUtils.{load_source_file,load_file,use_file} now require a preferences
argument (for passing to process_result).
@
text
@d7 5
a126 1
  exception Handled
@


1.22
log
@Added read_dependencies_module and read_dependencies_file.
@
text
@d7 3
d87 1
d126 8
a133 7
    user_context * 
    UserOptions *
    ((MLWorks.Internal.Value.T -> MLWorks.Internal.Value.T) ->
     (MLWorks.Internal.Value.T -> MLWorks.Internal.Value.T)) *
    (string -> unit) *		(* print function *)
    (string -> unit) ->
    unit
@


1.21
log
@Added add_check_load_module and add_check_load_file.
@
text
@d7 3
d100 3
@


1.20
log
@Revisions for new project tool.
@
text
@d7 3
d97 3
@


1.19
log
@Adding touch_all function
@
text
@d7 3
d81 8
a88 2
  val add_make_module: string * Info.options -> unit
  val add_make_file: string * Info.options -> unit
d90 2
a91 2
  val add_check_module: string * Info.options -> unit
  val add_check_file: string * Info.options -> unit
d95 3
a97 3
  val add_touch_file: string * Info.options -> unit
  val add_touch_module: string * Info.options -> unit
  val add_touch_all: Info.options -> unit
@


1.18
log
@do_actions now takes an output function argument.
@
text
@d7 3
d88 1
@


1.17
log
@Added read_dot_mlworks.
@
text
@d7 3
d101 1
@


1.16
log
@do_actions now takes a user_context instead of a Context ref.
The Error exception no longer includes a Context (it was never used).
@
text
@d7 4
d67 1
d100 2
@


1.15
log
@Added new commands that distinguish modules and files.
@
text
@d7 3
a61 1
  type Context
d63 1
d86 1
a86 1
  exception Error of (string * Context * Info.error * Info.error list)
d89 1
a89 1
    Context ref * 
@


1.14
log
@Added check_make
/
@
text
@d7 4
d42 9
a50 9
Revision 1.3  1993/03/19  11:29:44  matthew
do_actions now takes a context ref and returns unit.

Revision 1.2  1993/03/09  15:29:58  matthew
Options & Info changes

Revision 1.1  1993/03/02  11:10:58  daveb
Initial revision

d64 2
a65 1
  val add_make: string * Info.options -> unit
d67 2
a68 1
  val add_check_make: string * Info.options -> unit
d72 2
a73 1
  val add_remake: string * Info.options -> unit
d75 2
a76 1
  val add_load: string * Info.options -> unit
@


1.13
log
@Adding clear_debug functionality.
@
text
@d7 3
d61 2
@


1.12
log
@Replaced Incremental substructure with Options.
@
text
@d7 3
d65 3
a67 1
  val add_clear_debug: unit -> unit
@


1.11
log
@Added add_load function for loading mos
@
text
@d7 3
d44 1
a44 1
require "incremental";
d48 1
a48 1
  structure Incremental: INCREMENTAL
d52 9
a60 19
  val add_use:
    string * Incremental.InterMake.Compiler.Info.options ->
    unit

  val add_make:
    string * Incremental.InterMake.Compiler.Info.options ->
    unit

  val add_save:
    string * Incremental.InterMake.Compiler.Info.options ->
    unit

  val add_remake:
    string * Incremental.InterMake.Compiler.Info.options ->
    unit

  val add_load:
    string * Incremental.InterMake.Compiler.Info.options ->
    unit
d62 1
a62 2
  val add_clear_debug:
    unit -> unit
d65 1
a65 2
  exception Error of (string * Context * Incremental.InterMake.Compiler.Info.error *
                      Incremental.InterMake.Compiler.Info.error list)
@


1.10
log
@Added add_save function
@
text
@d7 3
d62 4
@


1.9
log
@Added exception Handled and extended Error with error information
@
text
@d7 3
d51 4
@


1.9.1.1
log
@Fork for bug fixing
@
text
@a6 3
 *  Revision 1.9  1993/05/26  15:30:11  matthew
 *  Added exception Handled and extended Error with error information
 *
@


1.8
log
@Changed ContextRef to Context ref
@
text
@d7 3
d58 3
a60 1
  exception Error of string * Context 
@


1.7
log
@Removed parse_absolute function
Changed type of do_use
@
text
@d7 4
d37 1
a37 1
  type ContextRef
d55 2
d58 1
a58 1
    ContextRef * 
@


1.6
log
@Changed do_actions type
@
text
@d7 3
d36 1
a36 1
  val parse_absolute:
d38 1
a38 4
      Incremental.InterMake.FileName.absolute

  val add_use:
    string -> unit
d42 1
a42 1
      unit
d46 1
a46 1
      unit
@


1.5
log
@Formatting change
@
text
@d7 3
d30 2
a31 1
  type ShellData
a32 2
  type print_method_table
      
d51 7
a57 1
  val do_actions : ShellData -> unit
@


1.4
log
@do_actions now takes a single ShellData argument.
@
text
@d7 3
d49 1
a49 2
  val do_actions:
    ShellData -> unit
@


1.3
log
@do_actions now takes a context ref and returns unit.
@
text
@d7 3
d24 1
d47 1
a47 3
    int * Incremental.Context ref * (string -> unit) *
    Incremental.options * print_method_table ->
    unit
@


1.2
log
@Options & Info changes
@
text
@d7 3
d43 1
a43 1
    int * Incremental.Context * (string -> unit) *
d45 1
a45 1
    Incremental.Context
@


1.1
log
@Initial revision
@
text
@d6 4
a9 1
 *  $Log$
d19 1
a19 1
  type printer_descriptor
d22 1
a22 1
    string * Incremental.InterMake.Compiler.BasisTypes.Info.options ->
d29 1
a29 1
    string * Incremental.InterMake.Compiler.BasisTypes.Info.options ->
d33 1
a33 1
    string * Incremental.InterMake.Compiler.BasisTypes.Info.options ->
d40 3
a42 3
    int * Incremental.context * (string -> unit) *
    Incremental.options * printer_descriptor ->
      Incremental.context
@
