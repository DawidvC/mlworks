head	1.2;
access;
symbols
	MLW_daveb_inline_1_4_99:1.2.8
	MLWorks_21c0_1999_03_25:1.2
	MLWorks_20c1_1998_08_20:1.2
	MLWorks_20c0_1998_08_04:1.2
	MLWorks_20b2c2_1998_06_19:1.2
	MLWorks_20b2_Windows_1998_06_12:1.2
	MLWorks_20b1c1_1998_05_07:1.2
	MLWorks_20b0_1998_04_07:1.2
	MLWorks_20b0_1998_03_20:1.2
	MLWorks_20m2_1998_02_16:1.2
	MLWorks_20m1_1997_10_23:1.2
	MLWorks_11r1:1.2.5.1.1.1.1
	MLWorks_workspace_97:1.2.7
	MLWorks_dt_wizard:1.2.6
	MLWorks_11c0_1997_09_09:1.2.5.1.1.1
	MLWorks_10r3:1.2.5.1.3
	MLWorks_10r2_551:1.2.5.1.2
	MLWorks_11:1.2.5.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.2.5.1
	MLWorks_20m0_1997_06_20:1.2
	MLWorks_1_0_r2c2_1997_06_14:1.2.5.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.2.5.1
	MLWorks_1_0_r2c1_1997_05_12:1.2.5
	MLWorks_BugFix_1997_04_24:1.2
	MLWorks_1_0_r2_Win32_1997_04_11:1.2
	MLWorks_1_0_r2_Unix_1997_04_04:1.2
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.2.3.1.1
	MLWorks_gui_1996_12_18:1.2.4
	MLWorks_1_0_Win32_1996_12_17:1.2.3
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.2.1.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.2.1.1
	MLWorks_1_0_Irix_1996_11_28:1.2.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.2.2
	MLWorks_1_0_Unix_1996_11_14:1.2.1;
locks; strict;
comment	@; @;


1.2
date	96.11.12.15.05.16;	author matthew;	state Exp;
branches
	1.2.1.1
	1.2.2.1
	1.2.3.1
	1.2.4.1
	1.2.5.1
	1.2.6.1
	1.2.7.1
	1.2.8.1;
next	1.1;

1.1
date	96.11.05.13.04.43;	author matthew;	state Exp;
branches;
next	;

1.2.1.1
date	96.11.14.13.05.04;	author hope;	state Exp;
branches
	1.2.1.1.1.1;
next	;

1.2.1.1.1.1
date	96.11.28.15.14.35;	author hope;	state Exp;
branches;
next	;

1.2.2.1
date	96.11.22.18.22.31;	author hope;	state Exp;
branches;
next	;

1.2.3.1
date	96.12.17.18.00.33;	author hope;	state Exp;
branches
	1.2.3.1.1.1;
next	;

1.2.3.1.1.1
date	97.02.24.11.52.13;	author hope;	state Exp;
branches;
next	;

1.2.4.1
date	96.12.18.09.55.55;	author hope;	state Exp;
branches;
next	;

1.2.5.1
date	97.05.12.10.50.37;	author hope;	state Exp;
branches
	1.2.5.1.1.1
	1.2.5.1.2.1
	1.2.5.1.3.1;
next	;

1.2.5.1.1.1
date	97.07.28.18.32.48;	author daveb;	state Exp;
branches
	1.2.5.1.1.1.1.1;
next	;

1.2.5.1.1.1.1.1
date	97.10.07.11.58.51;	author jkbrook;	state Exp;
branches;
next	;

1.2.5.1.2.1
date	97.09.08.17.25.59;	author daveb;	state Exp;
branches;
next	;

1.2.5.1.3.1
date	97.09.09.14.22.45;	author daveb;	state Exp;
branches;
next	;

1.2.6.1
date	97.09.10.19.41.45;	author brucem;	state Exp;
branches;
next	;

1.2.7.1
date	97.09.11.21.09.17;	author daveb;	state Exp;
branches;
next	;

1.2.8.1
date	99.04.01.18.08.06;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
New unit
@


1.2
log
@Changing copyright message
@
text
@;;; sml-mlworks.el: Modifies inferior-sml-mode defaults for MLWorks.

;; Copyright (C) 1994, Matthew J. Morley, 1996, The Harlequin Group Limited.

;; This file is not part of GNU Emacs, but it is distributed under the
;; same conditions.

;; ====================================================================

;; This program is free software; you can redistribute it and/or
;; modify it under the terms of the GNU General Public License as
;; published by the Free Software Foundation; either version 2, or (at
;; your option) any later version.

;; This program is distributed in the hope that it will be useful, but
;; WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
;; General Public License for more details.

;; You should have received a copy of the GNU General Public License
;; along with GNU Emacs; see the file COPYING. If not, write to the
;; Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.

;; ====================================================================

;;; DESCRIPTION

;; To use this library just put

;;(autoload 'sml-mlworks "sml-mlworks" "Set up and run MLWorks." t)

;; in your .emacs file. If you only ever use MLWorks
;; you might as well put something like

;;(setq sml-mode-hook
;;      '(lambda() "SML mode defaults to MLWorks"
;;	 (define-key  sml-mode-map "\C-cp" 'sml-mlworks)))

;; for your sml-mode-hook. The command prompts for the program name.

;;; CODE

(require 'sml-proc)

;; The reg-expression used when looking for errors. MLWorks errors:

(defvar sml-mlworks-error-regexp
  "^.+:[0-9]+.[0-9]+\\( to [0-9]+.[0-9]+\\)?: \\(error\\|warning\\):"
  "*Default regexp matching MLWorks error and warning messages.")

(defun sml-mlworks-error-parser (pt)
 "This function parses an MLWorks error message into a 3 or 5 element list:
  (file start-line start-col [end-line end-col])"

  (save-excursion
    (goto-char pt)
    (re-search-forward "^\\(.+\\):\\([0-9]+\\),\\([0-9]+\\)\\( to \\([0-9]+\\),\\([0-9]+\\)\\)?\
: \\(error\\|warning\\):")
    (let ((tail (and (match-beginning 4)
                     (list (string-to-int (buffer-substring     ; end line
                                           (match-beginning 5)
                                           (match-end 5)))
                           (1- (string-to-int (buffer-substring ; end col
                                               (match-beginning 6)
                                               (match-end 6))))))))
      (nconc (list (buffer-substring (match-beginning 1)        ; file
                                     (match-end 1))
                   (string-to-int (buffer-substring             ; start line
                                   (match-beginning 2)
                                   (match-end 2)))
                   (1- (string-to-int (buffer-substring         ; start col
                                       (match-beginning 3)
                                       (match-end 3)))))
             tail))))

(defun sml-mlworks ()
   "Set up and run MLWorks
Note: defaults set here will be clobbered if you setq them in the
{inferior-}sml-mode-hook.

 sml-program-name  <option>
 sml-default-arg   \"\"
 sml-use-command   \"use \\\"%s\\\"\"
 sml-cd-command    \"OS.FileSys.chDir \\\"%s\\\"\"
 sml-prompt-regexp \"^MLWorks>* *\"
 sml-error-regexp  sml-mlworks-error-regexp
 sml-error-parser  'sml-mlworks-error-parser"
   (interactive)
   (let ((cmd (read-string "Command name: " "mlworks")))
     (setq sml-program-name  cmd
	   sml-default-arg   " -tty"
	   sml-use-command   "use \"%s\""
	   sml-cd-command    "OS.FileSys.chDir \"%s\""
	   sml-prompt-regexp "^MLWorks>* *"
	   sml-error-regexp  sml-mlworks-error-regexp
	   sml-error-parser  'sml-mlworks-error-parser)
     (sml-run cmd sml-default-arg)))

;;; sml-mlworks.el fin

@


1.2.8.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@@


1.2.7.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@@


1.2.6.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@@


1.2.5.1
log
@branched from 1.2
@
text
@@


1.2.5.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@@


1.2.5.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@@


1.2.5.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@@


1.2.5.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@@


1.2.4.1
log
@branched from 1.2
@
text
@@


1.2.3.1
log
@branched from 1.2
@
text
@@


1.2.3.1.1.1
log
@branched from 1.2.3.1
@
text
@@


1.2.2.1
log
@branched from 1.2
@
text
@@


1.2.1.1
log
@branched from 1.2
@
text
@@


1.2.1.1.1.1
log
@branched from 1.2.1.1
@
text
@@


1.1
log
@new unit
New unit
@
text
@d3 1
a3 1
;; Copyright (C) 1994, Matthew J. Morley, 1996, Harlequin Ltd.
@
