head	1.43;
access;
symbols
	MLW_daveb_inline_1_4_99:1.43.1
	MLWorks_21c0_1999_03_25:1.43
	MLWorks_20c1_1998_08_20:1.40
	MLWorks_20c0_1998_08_04:1.39
	MLWorks_20b2c2_1998_06_19:1.37
	MLWorks_20b2_Windows_1998_06_12:1.34
	MLWorks_20b1c1_1998_05_07:1.32
	MLWorks_20b0_1998_04_07:1.31
	MLWorks_20b0_1998_03_20:1.29
	MLWorks_20m2_1998_02_16:1.28
	MLWorks_20m1_1997_10_23:1.24
	MLWorks_11r1:1.11.1.8.1.2.1
	MLWorks_workspace_97:1.22.2
	MLWorks_dt_wizard:1.22.1
	MLWorks_11c0_1997_09_09:1.11.1.8.1.2
	MLWorks_10r3:1.11.1.8.3
	MLWorks_10r2_551:1.11.1.8.2
	MLWorks_11:1.11.1.8.1
	MLWorks_1_0_r2c2_1997_07_28:1.11.1.8
	MLWorks_20m0_1997_06_20:1.19
	MLWorks_1_0_r2c2_1997_06_14:1.11.1.7
	MLWorks_1_0_r2c1_released_1997_05_23:1.11.1.3
	MLWorks_1_0_r2c1_1997_05_12:1.11.1
	MLWorks_BugFix_1997_04_24:1.12
	MLWorks_1_0_r2_Win32_1997_04_11:1.11
	MLWorks_1_0_r2_Unix_1997_04_04:1.11
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.8.1.1.1
	MLWorks_gui_1996_12_18:1.8.2
	MLWorks_1_0_Win32_1996_12_17:1.8.1
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.6.1.1.1.3
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.6.1.3
	MLWorks_1_0_Irix_1996_11_28:1.6.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.7.1
	MLWorks_1_0_Unix_1996_11_14:1.6.1
	MLWorks_Open_Beta2_1996_10_11:1.5.1
	MLWorks_License_dev:1.4.2
	MLWorks_1_open_beta_1996_09_13:1.4.1
	MLWorks_Open_Beta_1996_08_22:1.4;
locks; strict;
comment	@# @;


1.43
date	99.03.26.12.26.22;	author johnh;	state Exp;
branches
	1.43.1.1;
next	1.42;

1.42
date	99.03.15.13.44.03;	author johnh;	state Exp;
branches;
next	1.41;

1.41
date	98.08.28.15.12.29;	author jkbrook;	state Exp;
branches;
next	1.40;

1.40
date	98.08.19.12.07.25;	author johnh;	state Exp;
branches;
next	1.39;

1.39
date	98.07.22.13.59.18;	author johnh;	state Exp;
branches;
next	1.38;

1.38
date	98.07.07.16.46.24;	author jkbrook;	state Exp;
branches;
next	1.37;

1.37
date	98.06.18.14.26.24;	author johnh;	state Exp;
branches;
next	1.36;

1.36
date	98.06.17.11.13.10;	author jkbrook;	state Exp;
branches;
next	1.35;

1.35
date	98.06.15.14.57.16;	author jkbrook;	state Exp;
branches;
next	1.34;

1.34
date	98.06.12.09.15.35;	author jkbrook;	state Exp;
branches;
next	1.33;

1.33
date	98.05.12.09.33.22;	author jkbrook;	state Exp;
branches;
next	1.32;

1.32
date	98.05.05.12.07.33;	author jkbrook;	state Exp;
branches;
next	1.31;

1.31
date	98.04.06.15.45.26;	author jkbrook;	state Exp;
branches;
next	1.30;

1.30
date	98.03.26.16.59.27;	author jkbrook;	state Exp;
branches;
next	1.29;

1.29
date	98.03.20.17.44.02;	author jkbrook;	state Exp;
branches;
next	1.28;

1.28
date	98.02.16.16.31.24;	author jkbrook;	state Exp;
branches;
next	1.27;

1.27
date	98.02.06.15.22.35;	author jkbrook;	state Exp;
branches;
next	1.26;

1.26
date	98.01.13.17.40.50;	author jkbrook;	state Exp;
branches;
next	1.25;

1.25
date	97.11.05.10.54.01;	author johnh;	state Exp;
branches;
next	1.24;

1.24
date	97.10.22.10.39.56;	author daveb;	state Exp;
branches;
next	1.23;

1.23
date	97.10.01.17.25.19;	author jkbrook;	state Exp;
branches;
next	1.22;

1.22
date	97.07.23.13.38.52;	author andreww;	state Exp;
branches
	1.22.1.1
	1.22.2.1;
next	1.21;

1.21
date	97.07.23.13.26.38;	author jont;	state Exp;
branches;
next	1.20;

1.20
date	97.07.22.16.13.37;	author andreww;	state Exp;
branches;
next	1.19;

1.19
date	97.06.20.16.44.20;	author daveb;	state Exp;
branches;
next	1.18;

1.18
date	97.06.13.16.02.47;	author jkbrook;	state Exp;
branches;
next	1.17;

1.17
date	97.06.13.15.07.41;	author jkbrook;	state Exp;
branches;
next	1.16;

1.16
date	97.06.13.14.20.23;	author jkbrook;	state Exp;
branches;
next	1.15;

1.15
date	97.06.13.14.07.12;	author jkbrook;	state Exp;
branches;
next	1.14;

1.14
date	97.06.13.12.41.18;	author jkbrook;	state Exp;
branches;
next	1.13;

1.13
date	97.05.22.12.36.26;	author stephenb;	state Exp;
branches;
next	1.12;

1.12
date	97.04.23.16.23.23;	author jont;	state Exp;
branches;
next	1.11;

1.11
date	97.04.03.13.37.47;	author andreww;	state Exp;
branches
	1.11.1.1;
next	1.10;

1.10
date	97.01.09.16.04.50;	author jont;	state Exp;
branches;
next	1.9;

1.9
date	96.12.20.16.01.12;	author jont;	state Exp;
branches;
next	1.8;

1.8
date	96.12.05.16.18.14;	author jont;	state Exp;
branches
	1.8.1.1
	1.8.2.1;
next	1.7;

1.7
date	96.11.15.17.58.53;	author daveb;	state Exp;
branches
	1.7.1.1;
next	1.6;

1.6
date	96.11.11.16.57.02;	author andreww;	state Exp;
branches
	1.6.1.1;
next	1.5;

1.5
date	96.10.11.15.02.56;	author jont;	state Exp;
branches
	1.5.1.1;
next	1.4;

1.4
date	96.08.20.12.35.28;	author daveb;	state Exp;
branches
	1.4.1.1
	1.4.2.1;
next	1.3;

1.3
date	96.08.20.11.37.00;	author daveb;	state Exp;
branches;
next	1.2;

1.2
date	96.08.07.15.40.34;	author jont;	state Exp;
branches;
next	1.1;

1.1
date	96.06.25.09.33.47;	author jont;	state Exp;
branches;
next	;

1.4.1.1
date	96.09.13.11.26.15;	author hope;	state Exp;
branches;
next	;

1.4.2.1
date	96.10.07.16.16.44;	author hope;	state Exp;
branches;
next	;

1.5.1.1
date	96.10.17.11.36.16;	author hope;	state Exp;
branches;
next	;

1.6.1.1
date	96.11.14.13.04.21;	author hope;	state Exp;
branches
	1.6.1.1.1.1;
next	1.6.1.2;

1.6.1.2
date	96.12.05.15.41.41;	author jont;	state Exp;
branches;
next	1.6.1.3;

1.6.1.3
date	96.12.05.17.11.38;	author daveb;	state Exp;
branches;
next	;

1.6.1.1.1.1
date	96.11.28.15.13.45;	author hope;	state Exp;
branches;
next	1.6.1.1.1.2;

1.6.1.1.1.2
date	96.12.05.14.03.06;	author jont;	state Exp;
branches;
next	1.6.1.1.1.3;

1.6.1.1.1.3
date	96.12.05.17.32.26;	author daveb;	state Exp;
branches;
next	;

1.7.1.1
date	96.11.22.18.21.45;	author hope;	state Exp;
branches;
next	;

1.8.1.1
date	96.12.17.17.59.43;	author hope;	state Exp;
branches
	1.8.1.1.1.1;
next	;

1.8.1.1.1.1
date	97.02.24.11.51.20;	author hope;	state Exp;
branches;
next	;

1.8.2.1
date	96.12.18.09.55.03;	author hope;	state Exp;
branches;
next	;

1.11.1.1
date	97.05.12.10.49.46;	author hope;	state Exp;
branches;
next	1.11.1.2;

1.11.1.2
date	97.05.12.15.03.39;	author daveb;	state Exp;
branches;
next	1.11.1.3;

1.11.1.3
date	97.05.19.19.00.55;	author daveb;	state Exp;
branches;
next	1.11.1.4;

1.11.1.4
date	97.06.09.16.58.42;	author daveb;	state Exp;
branches;
next	1.11.1.5;

1.11.1.5
date	97.06.10.10.24.41;	author daveb;	state Exp;
branches;
next	1.11.1.6;

1.11.1.6
date	97.06.10.14.30.13;	author daveb;	state Exp;
branches;
next	1.11.1.7;

1.11.1.7
date	97.06.11.15.34.49;	author stephenb;	state Exp;
branches;
next	1.11.1.8;

1.11.1.8
date	97.06.20.16.50.04;	author daveb;	state Exp;
branches
	1.11.1.8.1.1
	1.11.1.8.2.1
	1.11.1.8.3.1;
next	;

1.11.1.8.1.1
date	97.07.28.18.32.00;	author daveb;	state Exp;
branches;
next	1.11.1.8.1.2;

1.11.1.8.1.2
date	97.08.08.17.22.57;	author daveb;	state Exp;
branches
	1.11.1.8.1.2.1.1;
next	;

1.11.1.8.1.2.1.1
date	97.10.07.11.58.06;	author jkbrook;	state Exp;
branches;
next	1.11.1.8.1.2.1.2;

1.11.1.8.1.2.1.2
date	97.10.20.10.49.46;	author jkbrook;	state Exp;
branches;
next	;

1.11.1.8.2.1
date	97.09.08.17.25.09;	author daveb;	state Exp;
branches;
next	;

1.11.1.8.3.1
date	97.09.09.14.21.50;	author daveb;	state Exp;
branches;
next	1.11.1.8.3.2;

1.11.1.8.3.2
date	97.10.16.20.33.11;	author jkbrook;	state Exp;
branches;
next	;

1.22.1.1
date	97.09.10.19.40.52;	author brucem;	state Exp;
branches;
next	;

1.22.2.1
date	97.09.11.21.08.31;	author daveb;	state Exp;
branches;
next	;

1.43.1.1
date	99.04.01.18.07.05;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
Name changed from install in order to avoid clashing with a Sun binary
@


1.43
log
@[Bug #190551]
Transfer DEPEND files.
@
text
@#!/bin/sh
#
# Copyright (C) 1997 The Harlequin Group Ltd.  All rights reserved.
#
#       ==== INSTALL MLWORKS ====
#
# This script installs MLWorks from the contents of the current
# directory, which should be the MLWorks distribution.
#
#
#       === CONFIGURATION ===
#
# The following variable may be adjusted to suit your system:
#
#       Location of installation
#
#   MLWORKSDIR  root directory for MLWorks
#   LIBDIR      directory for MLWorks libraries
#   IMAGEDIR    directory for MLWorks images
#   BINDIR      directory for MLWorks binaries
#   SCRIPTDIR   directory for MLWorks scripts
#   MANDIR      root directory for MLWorks manual pages
#   RUNTIME     name of the runtime system to install as mlrun
#   RUNTIMEOPTS options when using it
#   ARCH	architecture of the host machine (e.g. SPARC)
#   OS		operating system of the host machine (e.g. SunOS)
#
#	Other variables
#
#   If your X installation recognises the %C escape in the value of
#   XFILESEARCHPATH, set APP_DEFAULT_EXTENSION=%N%C.  Otherwise set
#   APP_DEFAULT_EXTENSION=%N-color or APP_DEFAULT_EXTENSION=%N-mono,
#   as appropriate for your system.  X11R5 recognises the %C escape.
#
#
# We allow MLWORKSDIR to be given on the command line
#

# determine cwd so that licence text can be found

script_dir=`dirname $0`
cd $script_dir

# Default show legal agreement -- want to turn this off during RPM building

silent=0

# For free versions we need to show the legal agreement during installation

while getopts "s" opt; do
  case $opt in
    s) silent=1;;
    *) echo "Usage: install-mlworks [installation-dir]" 
       exit 0;;
  esac
done;
shift `expr $OPTIND - 1`

if [ $silent -eq 0 ]; then
  if [ -z "$PAGER" ] || [ "`type $PAGER`" = "$PAGER not found" ] ; then
    if [ "`type more`" != "more not found" ] ; then
      page=more
    else
      page=cat
    fi
  else
    page="$PAGER"
  fi

  $page license.txt

  answer=
  while [ -z "$answer" ] ; do
    echo " "
    echo "Do you accept the terms and conditions of this license agreement? (yes/no)"
    read answer
    ucanswer=`echo "${answer}" | tr '[a-z]' '[A-Z]'`
    case "$ucanswer" in
    YES)
      ;;
    NO)
      echo " "
      echo "License not accepted.  MLWorks not installed. "
      echo " "
      exit 1
      ;;
    *)
      echo " "
      echo "Please enter \"yes\" or \"no\"."
      answer=
      ;;
    esac
  done
fi

# MLWorks installation

if [ $# -eq 1 ]; then
  MLDIR=$1
foo=`sed -e 's,^\.,,g' << EOF
$MLDIR
EOF`
if [ "$foo" != "$MLDIR" ]; then
  echo install-mlworks: Installation directory must be an absolute filename
  exit 1
fi
if [ $MLDIR != "/" ]; then
MLWORKSDIR=`sed -e 's,/$,,g' << EOF
$MLDIR
EOF`
else
MLWORKSDIR=$MLDIR
fi
else
  MLWORKSDIR=/usr/local/lib/MLWorks
fi

echo install-mlworks: Installing into $MLWORKSDIR

LIBDIR=$MLWORKSDIR/lib
IMAGEDIR=$MLWORKSDIR/images
BINDIR=$MLWORKSDIR/bin
SCRIPTDIR=$MLWORKSDIR/bin
MANDIR=$MLWORKSDIR/man
EXAMPLEDIR=$MLWORKSDIR/examples
ARCH=SPARC
OS=SunOS
if [ "$OS" = "Irix" -o "$OS" = "Solaris" ]; then
  USE_STATIC=false
else
  USE_STATIC=true
fi
if [ "$USE_STATIC" = "false" ]; then
  RUNTIME=main
else
  RUNTIME=main-static
fi
RUNLIB=libmlw.so
RUNTIMEOPTS=
APP_DEFAULT_EXTENSION=%N%C

#       Programs
#
# You may want to alter the options passed to these programs.

cp="/bin/cp"
rm="/bin/rm -f"
ln="/bin/ln -s"
mkdir="/bin/mkdir -p"
sed=/bin/sed
zcat=zcat
chmod_exec="chmod 775"
chmod_exec_read_only="chmod 555"
chmod_non_exec="chmod 664"
chmod_read_only="chmod 444"

#       === END OF CONFIGURATION ===
#
# You should not normally need to change anything beyond this comment.

script=`basename $0`

# This is a sed script to substitute the values of the installation
# variables into text files.

subst="s!\$MLWORKSDIR!$MLWORKSDIR!g
       s!\$LIBDIR!$LIBDIR!g
       s!\$IMAGEDIR!$IMAGEDIR!g
       s!\$BINDIR!$BINDIR!g
       s!\$SCRIPTDIR!$SCRIPTDIR!g
       s!\$MANDIR!$MANDIR!g
       s!\$RUNTIME!$RUNTIME!g"

# Let's get going.

$mkdir $MLWORKSDIR
if test ! -d $MLWORKSDIR
then
  echo Failed to create $MLWORKSDIR, exiting
  exit 1
fi

# Now we always install all the packages
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples licensing"

echo ARCH=$ARCH
echo OS=$OS
echo packages=$packages

for package in $packages
do
  case $package in
    # Top level items
    toplevel)
      echo "$script: top-level items in $MLWORKSDIR"
      {
	for f in README sml_97.ps bug-template.txt license.txt
	do
	  dest=$MLWORKSDIR/$f
	  $rm $dest && $cp -p $f $dest
          $chmod_read_only $dest
	done
      } ||
      {
        echo "$script: Failed to install top-level items"
        exit 70
      };;

    # The binaries are simply copied to $BINDIR
    binaries)
      RUN_NAME=$RUNTIME.$ARCH.$OS;export RUN_NAME
      echo "$script: binaries in $BINDIR"
      {
	if test \! -d $BINDIR
	then
          $mkdir $BINDIR &&
	  $chmod_exec $BINDIR
	fi &&
	$rm $BINDIR/mlrun &&
	$rm $BINDIR/$RUN_NAME &&
        $cp bin/$ARCH/$OS/$RUNTIME $BINDIR/$RUN_NAME &&
        $ln $BINDIR/$RUN_NAME $BINDIR/mlrun &&
        $chmod_exec_read_only $BINDIR/$RUN_NAME &&
        # copy the license validator
        $rm $BINDIR/mlworks_license &&
        $cp bin/$ARCH/$OS/mlworks_license $BINDIR/mlworks_license &&
        $chmod_exec_read_only $BINDIR/mlworks_license &&  
        (
          cd bin/$ARCH/$OS &&
          for f in *.xpm
          do
            dest=$MLWORKSDIR/bin/$f
            $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
          done
        )
	if test "$OS" != SunOS
	then
	    $rm $BINDIR/$RUNLIB &&
	    $cp bin/$ARCH/$OS/$RUNLIB $BINDIR/$RUNLIB &&
	    $chmod_exec_read_only $BINDIR/$RUNLIB
	fi 
      } ||
      {
        echo "$script: Failed to install binaries"
        exit 50
      };;

    # Scripts are processed to include the configuration settings if
    # their name matches *.in, otherwise they are just copied.
    scripts)
      echo "$script: shell scripts in $SCRIPTDIR"
      {
	if test \! -d $SCRIPTDIR
	then
          $mkdir $SCRIPTDIR &&
	  $chmod_exec $SCRIPTDIR
	fi &&
        (
          cd scripts &&
          for s in *
          do
	    dest=$SCRIPTDIR/`basename $s .in`
	    $rm $dest &&
            case $s in
              *.in)
                cat > $dest <<EOF
#!/bin/sh
MLWORKSDIR=$MLWORKSDIR
IMAGEDIR=$IMAGEDIR
LIBDIR=$LIBDIR
BINDIR=$BINDIR
SCRIPTDIR=$SCRIPTDIR
MANDIR=$MANDIR
RUNTIME=$RUNTIME
RUNTIMEOPTS=$RUNTIMEOPTS
MLWORKS_PERVASIVE=\${MLWORKS_PERVASIVE:-$MLWORKSDIR/pervasive}
export MLWORKS_PERVASIVE
MLWORKS_SRC_PATH=\${MLWORKS_SRC_PATH:-.}:$MLWORKSDIR
export MLWORKS_SRC_PATH
MLWORKS_DOC=\${MLWORKS_DOC:-$MLWORKSDIR/documentation}
export MLWORKS_DOC
XFILESEARCHPATH=\
\$LIBDIR/X11/%L/app-defaults/$APP_DEFAULT_EXTENSION:\
\$LIBDIR/X11/%l/app-defaults/$APP_DEFAULT_EXTENSION:\
\$LIBDIR/X11/app-defaults/$APP_DEFAULT_EXTENSION:\
\$LIBDIR/X11/%T/$APP_DEFAULT_EXTENSION%S:\
\$XFILESEARCHPATH
export XFILESEARCHPATH
XKEYSYMDB=/usr/lib/X11/XKeysymDB
export XKEYSYMDB
LD_LIBRARY_PATH=$BINDIR\${LD_LIBRARY_PATH:+:\$LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
EOF
	      if [ "$OS" = "Solaris" ] ; then
	        cat >> $dest <<EOF
LD_LIBRARY_PATH=/usr/openwin/lib:\$LD_LIBRARY_PATH
export LD_LIBRARY_PATH
EOF
	      fi
	      if [ "$OS" = "SunOS" ] ; then
	        cat >> $dest <<EOF
if [ ! -d /usr/lib/X11/nls ] ; then
  XNLSDIR=\${XNLSDIR:-$MLWORKSDIR/lib/X11/nls}
  export XNLSDIR
fi
EOF
	      fi
              cat $s >> $dest
            ;;
              *)
                $cp $s $dest;;
            esac
	    $chmod_exec $dest
          done
        )
      } ||
      {
        echo "$script: Failed to install shell scripts"
        exit 60
      };;

    # The pervasive modules are simply copied.
    pervasives)
      echo "$script: pervasive modules in $MLWORKSDIR/pervasive"
      {
	if test \! -d $MLWORKSDIR/pervasive
	then
          $mkdir $MLWORKSDIR/pervasive &&
	  $chmod_exec $MLWORKSDIR/pervasive
	fi &&
	if test \! -d $MLWORKSDIR/pervasive/DEPEND
	then
          $mkdir $MLWORKSDIR/pervasive/DEPEND &&
	  $chmod_exec $MLWORKSDIR/pervasive/DEPEND
	fi &&
	(
	  cd pervasive/$ARCH/$OS/DEPEND &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/pervasive/DEPEND/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
	  done
	) &&
	(
	  cd pervasive/$ARCH/$OS &&
	  for f in *.mo
	  do
	    dest=$MLWORKSDIR/pervasive/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
	  done
	)
      } ||
      {
        echo "$script: Failed to install pervasive modules"
        exit 10
      };;

    # The library modules are simply copied.
    # objects go in the objects dir, signatures in specific directories
    libraries)
      echo "$script: library signatures in $MLWORKSDIR/{basis,utils,motif,foreign}"
      {
      {
        if test \! -d $MLWORKSDIR/foreign
       then
           $mkdir $MLWORKSDIR/foreign &&
         $chmod_exec $MLWORKSDIR/foreign
       fi &&
       (
         cd foreign &&
         for f in *.*
         do
           dest=$MLWORKSDIR/foreign/$f
           $rm $dest && $cp -p $f $dest
         done
       )
       } &&
     {
      if test \! -d $MLWORKSDIR/basis
	then
          $mkdir $MLWORKSDIR/basis &&
	  $chmod_exec $MLWORKSDIR/basis
	fi &&
	(
	  cd basis &&
          dest=$MLWORKSDIR/basis/basis.mlp &&
          $rm $dest && $cp basis.mlp $dest &&
	  for f in *.sml
	  do
	    dest=$MLWORKSDIR/basis/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
	  done
	)
      } &&
      {
	if test \! -d $MLWORKSDIR/utils
	then
          $mkdir $MLWORKSDIR/utils &&
	  $chmod_exec $MLWORKSDIR/utils
	fi &&
	(
	  cd utils &&
	  for f in *.sml
	  do
	    dest=$MLWORKSDIR/utils/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
	  done
	)
      } &&
      {
	if test \! -d $MLWORKSDIR/motif
	then
          $mkdir $MLWORKSDIR/motif &&
	  $chmod_exec $MLWORKSDIR/motif
	fi &&
	(
	  cd motif &&
	  for f in *.sml *.mlp
	  do
	    dest=$MLWORKSDIR/motif/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_read_only $dest
	  done
	)
      } &&
    # now copy the objects
    echo "$script: library modules in $MLWORKSDIR/objects/Release"
      {
        if test \! -d $MLWORKSDIR/objects/Release
        then
          $mkdir $MLWORKSDIR/objects/Release &&
          $chmod_exec $MLWORKSDIR/objects/Release
        fi &&
        (
          cd objects/$ARCH/$OS/Release &&
          for f in *
          do
            dest=$MLWORKSDIR/objects/Release/$f
            $rm $dest && $cp -p $f $dest
	    $chmod_read_only $dest
          done
        ) &&
        if test \! -d $MLWORKSDIR/objects/DEPEND
        then
          $mkdir $MLWORKSDIR/objects/DEPEND &&
          $chmod_exec $MLWORKSDIR/objects/DEPEND
        fi &&
        (
          cd objects/$ARCH/$OS/DEPEND &&
          for f in *
          do
            dest=$MLWORKSDIR/objects/DEPEND/$f
            $rm $dest && $cp -p $f $dest
	    $chmod_read_only $dest
          done
        )
      }
      } ||
      {
        echo "$script: Failed to install library modules"
        exit 10
      };;

    # Images are uncompressed if their name matches *.Z, otherwise
    # they are simply copied.
    images)
      echo "$script: images in $IMAGEDIR"
      {
	if test \! -d $IMAGEDIR
	then
          $mkdir $IMAGEDIR &&
          $chmod_exec $IMAGEDIR
	fi &&
        (
          cd images/$ARCH/$OS &&
          for f in *
          do
	    dest=$IMAGEDIR/`basename $f .Z`
	    $rm $dest &&
            case $f in
              *.Z) $zcat $f > $dest;;
              *)   $cp $f $dest;;
            esac &&
	    $chmod_read_only $dest
          done
        )
      } ||
      {
        echo "$script: Failed to install images"
        exit 20
      };;

    # Emacs LISP files are run through sed using the $subst script
    # constructed above if their name matches *.in.  This allows them
    # to locate other Emacs bits and bobs.  Other files, and the files
    # in the etc directory, are simply copied.
    emacs)
      echo "$script: Emacs library in $LIBDIR/emacs"
      {
	if test \! -d $LIBDIR
	then
	  $mkdir $LIBDIR &&
	  $chmod_exec $LIBDIR
	fi &&
	if test \! -d $LIBDIR/emacs
	then
	  $mkdir $LIBDIR/emacs &&
	  $chmod_exec $LIBDIR/emacs
	fi &&
	if test \! -d $LIBDIR/emacs/lisp
	then
          $mkdir $LIBDIR/emacs/lisp &&
          $chmod_exec $LIBDIR/emacs/lisp
	fi &&
	if test \! -d $LIBDIR/emacs/etc
	then
          $mkdir $LIBDIR/emacs/etc &&
          $chmod_exec $LIBDIR/emacs/etc
	fi &&
	(
	  cd lib/emacs/etc/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$LIBDIR/emacs/etc/$f
	    $rm $dest && $cp $f $dest && $chmod_exec_read_only $dest
	  done
	) &&
        (
          cd lib/emacs/lisp &&
          for f in *
          do
	    dest=$LIBDIR/emacs/lisp/`basename $f .in`
	    $rm $dest &&
            case $f in
              *.in) $sed -e "$subst" < $f > $dest;;
	      *)    $cp $f $dest;;
            esac &&
	    $chmod_read_only $dest
          done
        )
      } ||
      {
        echo "$script: Failed to install Emacs library"
        exit 30
      };;

    # X11 stuff: Bitmap files are simply copied, but resource files
    # are run through the $subst sed script constructed above if their
    # name matches *.in.  This allows them to locate the bitmaps.
    X11)
      echo "$script: X11 library in $LIBDIR/X11"
      {
	if test \! -d $LIBDIR/X11
	then
	  $mkdir $LIBDIR/X11 &&
	  $chmod_exec $LIBDIR/X11
	fi &&
	if test \! -d $LIBDIR/X11/bitmaps
	then
	  $mkdir $LIBDIR/X11/bitmaps &&
	  $chmod_exec $LIBDIR/X11/bitmaps
	fi &&
	if test \! -d $LIBDIR/X11/app-defaults
	then
	  $mkdir $LIBDIR/X11/app-defaults &&
	  $chmod_exec $LIBDIR/X11/app-defaults
	fi &&
	(
	  cd lib/X11/bitmaps &&
	  for f in *
	  do
	    dest=$LIBDIR/X11/bitmaps/$f
	    $rm $dest && $cp $f $dest && $chmod_read_only $dest
	  done
	) &&
        (
          cd lib/X11/app-defaults &&
          (for f in *
           do
	     dest=$LIBDIR/X11/app-defaults/`basename $f .in`
	     $rm $dest &&
             case $f in
               *.in) $sed -e "$subst" < $f > $dest;;
	       *)    $cp $f $dest;;
             esac &&
	     $chmod_read_only $dest
           done
	   $rm $LIBDIR/X11/app-defaults/MLWorks-fonts
	   ln -s MLWorks-normal-fonts $LIBDIR/X11/app-defaults/MLWorks-fonts
	  )
        ) &&
        if test -d lib/X11/nls
        then
          $rm -r $LIBDIR/X11/nls
          $cp -rp lib/X11/nls $LIBDIR/X11/nls
        fi
      } ||
      {
        echo "$script: Failed to install X11 library"
        exit 31
      };;

    # The manual pages are run throught the $subst sed script if their
    # name matches *.in so that they can cross reference the
    # installation itself.  Otherwise they are just copied.
    manuals)
      echo "$script: manual pages in $MANDIR"
      {
	if test \! -d $MANDIR
	then
          $mkdir $MANDIR &&
          $chmod_exec $MANDIR
	fi &&
        (
          cd man &&
          for d in *
          do
	    if test \! -d $MANDIR/$d
	    then
              $mkdir $MANDIR/$d &&
              $chmod_exec $MANDIR/$d
	    fi &&
            cd $d &&
            for f in *
            do
	      dest=$MANDIR/$d/`basename $f .in`
	      $rm $dest &&
              case $f in
                *.in) $sed -e "$subst" < $f > $dest;;
		*)    $cp $f $dest;;
              esac &&
	      $chmod_read_only $dest
            done
          done
        )
      } ||
      {
        echo "$script: Failed to install manual pages"
        exit 40
      };;

    environments)
      echo "$script: environments in $MLWORKSDIR/env"
      {
	if test \! -d $MLWORKSDIR/env
	then
          $mkdir $MLWORKSDIR/env &&
          $chmod_exec $MLWORKSDIR/env
	fi &&
        (
          cd env &&
          for f in *
          do
	    dest=$MLWORKSDIR/env/`basename $f .in`
	    $rm $dest &&
            case $f in
              *.in) $sed -e "$subst" < $f > $dest;;
	      *)    $cp $f $dest;;
            esac &&
	    $chmod_non_exec $dest
          done
        )
      } ||
      {
        echo "$script: Failed to install environments"
        exit 50
      };;

    # Examples are simply copied.
    examples)
      echo "$script: examples in $EXAMPLEDIR"
      {
	if test \! -d $EXAMPLEDIR
	then
          $mkdir $EXAMPLEDIR &&
          $chmod_exec $EXAMPLEDIR
	fi &&
	if test \! -d $EXAMPLEDIR/basis
	then
          $mkdir $EXAMPLEDIR/basis &&
          $chmod_exec $EXAMPLEDIR/basis
	fi &&
	if test \! -d $EXAMPLEDIR/motif
	then
          $mkdir $EXAMPLEDIR/motif &&
          $chmod_exec $EXAMPLEDIR/motif
	fi &&
	if test \! -d $EXAMPLEDIR/threads
	then
          $mkdir $EXAMPLEDIR/threads &&
          $chmod_exec $EXAMPLEDIR/threads
	fi &&
	if test \! -d $EXAMPLEDIR/gui
	then
          $mkdir $EXAMPLEDIR/gui &&
          $chmod_exec $EXAMPLEDIR/gui
	fi &&
	if test \! -d $EXAMPLEDIR/gui/motif
	then
          $mkdir $EXAMPLEDIR/gui/motif &&
          $chmod_exec $EXAMPLEDIR/gui/motif
	fi &&
	if test \! -d $EXAMPLEDIR/projects
	then
          $mkdir $EXAMPLEDIR/projects &&
          $chmod_exec $EXAMPLEDIR/projects
	fi &&
	if test \! -d $EXAMPLEDIR/projects/subprojects
	then
          $mkdir $EXAMPLEDIR/projects/subprojects &&
          $chmod_exec $EXAMPLEDIR/projects/subprojects
	fi &&
	if test \! -d $EXAMPLEDIR/foreign
	then
          $mkdir $EXAMPLEDIR/foreign &&
          $chmod_exec $EXAMPLEDIR/foreign
	fi &&
	if test \! -d $EXAMPLEDIR/foreign/ndbm
	then
          $mkdir $EXAMPLEDIR/foreign/ndbm &&
          $chmod_exec $EXAMPLEDIR/foreign/ndbm
	fi &&
	if test \! -d $EXAMPLEDIR/foreign/add
	then
          $mkdir $EXAMPLEDIR/foreign/add &&
          $chmod_exec $EXAMPLEDIR/foreign/add
	fi &&
	if test \! -d $EXAMPLEDIR/foreign/stdio
	then
          $mkdir $EXAMPLEDIR/foreign/stdio &&
          $chmod_exec $EXAMPLEDIR/foreign/stdio
	fi &&
        (
          cd examples/basis &&
          for f in *
          do
	    dest=$EXAMPLEDIR/basis/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
          cd ../motif &&
          for f in *
          do
	    dest=$EXAMPLEDIR/motif/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
          cd ../threads &&
          for f in *
          do
	    dest=$EXAMPLEDIR/threads/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
          cd ../foreign &&
          for f in *
          do
	    if test \! -d $f
	    then
	      dest=$EXAMPLEDIR/foreign/$f
	      $rm $dest && $cp -p $f $dest
              $chmod_non_exec $dest
	    fi
          done
	  cd add &&
	  for f in *
          do
	    dest=$EXAMPLEDIR/foreign/add/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
	  cd ../ndbm &&
	  for f in *
	  do 
	    dest=$EXAMPLEDIR/foreign/ndbm/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
	  done
	  cd ../stdio &&
	  for f in *
	  do 
	    dest=$EXAMPLEDIR/foreign/stdio/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
	  done
          cd ../../gui &&
          for f in *
          do
	    if test \! -d $f
	    then
	      dest=$EXAMPLEDIR/gui/$f
	      $rm $dest && $cp -p $f $dest
              $chmod_non_exec $dest
	    fi
          done
          cd motif &&
          for f in *
          do
	    dest=$EXAMPLEDIR/gui/motif/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
          cd ../../projects &&
          for f in *
          do
	    if test \! -d $f 
            then
	      dest=$EXAMPLEDIR/projects/$f
	      $rm $dest && $cp -p $f $dest
              $chmod_non_exec $dest
	    fi
          done
          cd ../projects/subprojects &&
          for f in *
          do
	    dest=$EXAMPLEDIR/projects/subprojects/$f
	    $rm $dest && $cp -p $f $dest
            $chmod_non_exec $dest
          done
        )
      } ||
      {
        echo "$script: Failed to install examples"
        exit 60
      };;

    licensing)
    {
      if [ $silent -eq 0 ]; then
         echo "Enter license information."
         echo "To install MLWorks Personal Edition, leave both fields blank."
	 $BINDIR/mlworks_license
      fi

    };;

    *)
      echo "$script: Unknown package: $package"
      exit 255;;
  esac
done
@


1.43.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@@


1.42
log
@[Bug #190506]
remove old FI from distribution.
@
text
@d332 14
d348 1
a348 1
	  for f in *
d374 1
a374 1
         for f in *
d447 15
a461 1
        ) 
@


1.41
log
@[Bug #30044]
Remove instructions to choose main-static since no platforms now
provide a choice
@
text
@a357 18
       if test \! -d $MLWORKSDIR/foreign/samples
       then
           $mkdir $MLWORKSDIR/foreign/samples &&
         $chmod_exec $MLWORKSDIR/foreign/samples
       fi &&
       (
         cd foreign/samples &&
        for f in *
         do
           dest=$MLWORKSDIR/foreign/samples/$f
           $rm $dest && $cp $f $dest && $chmod_non_exec $dest
         done
       ) &&
       if test \! -d $MLWORKSDIR/foreign/signatures
       then
           $mkdir $MLWORKSDIR/foreign/signatures &&
         $chmod_exec $MLWORKSDIR/foreign/signatures
       fi &&
d360 1
a360 1
         for f in *.sml
d362 1
a362 1
           dest=$MLWORKSDIR/foreign/signatures/$f
d690 20
d732 32
a763 1
          cd ../gui &&
@


1.40
log
@[Bug #30472]
copy gui.mlp
@
text
@a29 3
#   If you have a dynamically-linkable Motif library at your site, use
#   you can try using RUNTIME=main, otherwise use RUNTIME=main-static.
#
@


1.39
log
@[Bug #30441]
add capi example.
@
text
@d430 1
a430 1
	  for f in *.sml
@


1.38
log
@[Bug #30435]
Copy license-code validator
and prompt for license-code entry
@
text
@d691 10
d733 18
a750 1
          cd ../projects &&
@


1.37
log
@[Bug #30425]
distribute basis project file.
@
text
@d187 1
a187 1
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples"
d227 4
d746 10
@


1.36
log
@[Bug #30424]
Restore links to doc from MLWorks
@
text
@d392 2
@


1.35
log
@[Bug #30411]
Make sure splash-screen pixmaps are in the right place
@
text
@a128 1
DOCDIR=$MLWORKSDIR/documentation
d175 1
a175 2
       s!\$RUNTIME!$RUNTIME!g
       s!\$DOCDIR!$DOCDIR!g"
d187 1
a187 1
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples documentation"
a739 18

    documentation)
      # this makes sure that a dummy HTML page is installed
      # since 2.0 beta does not have a full doc set
      echo "$script: documentation info in $MLWORKSDIR/documentation"
      if test \! -d $DOCDIR
      then
        $mkdir $DOCDIR &&
        $chmod_exec $DOCDIR
      fi &&
     (
       cd html &&
         $rm $DOCDIR/hqnlogo.gif && $cp -p hqnlogo.gif $DOCDIR/hqnlogo.gif
         $chmod_non_exec hqnlogo.gif
         $rm $DOCDIR/index.htm &&
         sed -e 's/\.\.\/\.\.\///g' index.htm > $DOCDIR/index.htm
         $chmod_non_exec index.htm
      );;
@


1.34
log
@[Bug #30411]
Prompt for acceptance of legal agreement during installation
@
text
@d229 9
d243 1
a243 1
	fi
@


1.33
log
@[Bug #30408]
Add examples files for projects
@
text
@d42 2
d47 54
d202 1
a202 1
	for f in README sml_97.ps bug-template.txt
@


1.32
log
@[Bug #30354]
Temporarily restore old FI to distribution
@
text
@d622 10
d651 17
@


1.31
log
@[Bug #50046]
Temporarily install dummy HTML file for Help menu
@
text
@d286 1
a286 1
      echo "$script: library signatures in $MLWORKSDIR/{basis,utils,motif}"
d289 34
a322 1
	if test \! -d $MLWORKSDIR/basis
@


1.30
log
@[Bug #30362]
Objects should be in objects/ARCH/OS/MODE
@
text
@d73 1
d120 2
a121 1
       s!\$RUNTIME!$RUNTIME!g"
d133 1
a133 1
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples"
d617 18
@


1.29
log
@[Bug #50051]
Make sure all permissions are set explicitly
@
text
@d335 1
a335 1
    echo "$script: library modules in $MLWORKSDIR/objects"
d337 1
a337 1
        if test \! -d $MLWORKSDIR/objects
d339 2
a340 2
          $mkdir $MLWORKSDIR/objects &&
          $chmod_exec $MLWORKSDIR/objects
d343 1
a343 1
          cd objects/$ARCH/$OS &&
d346 1
a346 1
            dest=$MLWORKSDIR/objects/$f
@


1.28
log
@[Bug #30363]
Directory structure changes reflecting new flat object namespace
@
text
@d148 1
d272 1
d298 1
d314 1
d330 1
d348 1
d593 1
d600 1
d607 1
@


1.27
log
@[Bug #30132]
Name READMEs consistently in installation, specifically
Unix README's are called just README
z
@
text
@d280 1
d282 1
a282 1
      echo "$script: library modules in $MLWORKSDIR/{basis,utils,motif,unix}"
a289 13
	if test \! -d $MLWORKSDIR/basis/signatures
	then
          $mkdir $MLWORKSDIR/basis/signatures &&
	  $chmod_exec $MLWORKSDIR/basis/signatures
	fi &&
	(
	  cd basis/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/basis/$f
	    $rm $dest && $cp -p $f $dest
	  done
	) &&
d294 1
a294 1
	    dest=$MLWORKSDIR/basis/signatures/$f
a304 13
	if test \! -d $MLWORKSDIR/utils/signatures
	then
          $mkdir $MLWORKSDIR/utils/signatures &&
	  $chmod_exec $MLWORKSDIR/utils/signatures
	fi &&
	(
	  cd utils/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/utils/$f
	    $rm $dest && $cp -p $f $dest
	  done
	) &&
d309 1
a309 1
	    dest=$MLWORKSDIR/utils/signatures/$f
a319 13
	if test \! -d $MLWORKSDIR/motif/signatures
	then
          $mkdir $MLWORKSDIR/motif/signatures &&
	  $chmod_exec $MLWORKSDIR/motif/signatures
	fi &&
	(
	  cd motif/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/motif/$f
	    $rm $dest && $cp -p $f $dest
	  done
	) &&
d324 1
a324 1
	    dest=$MLWORKSDIR/motif/signatures/$f
d329 2
d332 13
a344 21
	if test \! -d $MLWORKSDIR/unix
	then
          $mkdir $MLWORKSDIR/unix &&
	  $chmod_exec $MLWORKSDIR/unix
	fi &&
	(
	  cd unix/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/unix/$f
	    $rm $dest && $cp -p $f $dest
	  done
	)
      } &&
      {
    # Now make a suitable system link
	if test -h $MLWORKSDIR/system
	then
	  $rm $MLWORKSDIR/system
	fi &&
	ln -s $MLWORKSDIR/unix $MLWORKSDIR/system
@


1.26
log
@[Bug #30306]
Removing incomplete FI from 2.0m2 distribution
@
text
@d144 1
a144 1
	for f in README.TXT sml_97.ps bug-template.txt
@


1.25
log
@[Bug #30125]
Add MLWORKS_DOC setting.
@
text
@d281 1
a281 1
      echo "$script: library modules in $MLWORKSDIR/{basis,utils,motif,unix,foreign}"
a283 28
	if test \! -d $MLWORKSDIR/foreign
	then
          $mkdir $MLWORKSDIR/foreign &&
	  $chmod_exec $MLWORKSDIR/foreign
	fi &&
	if test \! -d $MLWORKSDIR/foreign/signatures
	then
          $mkdir $MLWORKSDIR/foreign/signatures &&
	  $chmod_exec $MLWORKSDIR/foreign/signatures
	fi &&
	(
	  cd foreign/$ARCH/$OS &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/foreign/$f
	    $rm $dest && $cp -p $f $dest
	  done
	) &&
	(
	  cd foreign &&
	  for f in *.sml
	  do
	    dest=$MLWORKSDIR/foreign/signatures/$f
	    $rm $dest && $cp -p $f $dest
	  done
	)
      } &&
      {
a624 2
        $mkdir $EXAMPLEDIR/foreign &&
        $chmod_exec $EXAMPLEDIR/foreign &&
a643 2
          cd .. &&
          $cp -rp foreign $EXAMPLEDIR
@


1.24
log
@[Bug #30044]
Solaris distribution no longer includes main-static.
@
text
@d214 2
@


1.23
log
@[Bug #20088]
Merging from MLWorks_11:
SML'96 should be SML'97
@
text
@d75 1
a75 1
if [ "$OS" = "Irix" ]; then
@


1.22
log
@[Bug #30045]
improving LD_LIBRARY_PATH update in installed scripts.
setting it to $BINDIR:\$LD_LIBRARY_PATH doesn't cover
the case when $LD_LIBRARY_PATH is empty, so use
$BINDIR:\${LD_LIBRARY_PATH:+:\$LD_LIBRARY_PATH} instead.
@
text
@d144 1
a144 1
	for f in README.TXT sml_96.ps bug-template.txt
@


1.22.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@@


1.22.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@@


1.21
log
@[Bug #20095]
Make install-mlworks runnable from directories other
than the one containing it
@
text
@d223 1
a223 1
LD_LIBRARY_PATH=$BINDIR:\$LD_LIBRARY_PATH
d228 1
a228 1
LD_LIBRARY_PATH=/usr/openwin/lib\${LD_LIBRARY_PATH:+:\$LD_LIBRARY_PATH}
@


1.20
log
@[Bug #30046]
install script has to install ml* scripts that modify LD_LIBRARY_PATH
correctly.
@
text
@d42 3
a240 1
>>>>>>> 1.19
@


1.19
log
@[Bug #30074]
Correcting sense of test for the existence of /usr/lib/X11/nls on SunOS.
@
text
@d82 1
d165 8
a172 2
	$ln $BINDIR/$RUN_NAME $BINDIR/mlrun
	$chmod_exec_read_only $BINDIR/$RUN_NAME
d220 2
d238 1
@


1.18
log
@[Bug #30074]
Merging more changes from 1.0r2c2 into 2.0m0
@
text
@d222 1
a222 1
if [ -d /usr/lib/X11/nls ] ; then
@


1.17
log
@[Bug #30074]
Merging changes from 1.0r2c2 into 2.0m0
@
text
@d540 2
a541 13
          if test \! -d $LIBDIR/X11/nls
          then
            $mkdir $LIBDIR/X11/nls &&
            $chmod_exec $LIBDIR/X11/nls
          fi &&
          (
            cd lib/X11/nls &&
            for f in *
            do
              dest=$LIBDIR/X11/nls/$f
              $rm $dest && $cp $f $dest && $chmod_read_only $dest
            done
          )
@


1.16
log
@[Bug #30170]
Merging changes from 1.0r2c2 into 2.0m0
@
text
@d220 8
d537 17
a553 1
        )
@


1.15
log
@[Bug #50004]
Merging changes from 1.0r2c2 into 2.0m0
@
text
@d216 1
a216 1
LD_LIBRARY_PATH=/usr/openwin/lib:\${LD_LIBRARY_PATH}
@


1.14
log
@[Bug #30017]
Merging changes from 1.0r2c2 into 2.0m0
@
text
@d3 2
d37 1
a37 1

d190 1
a190 1
                cat - $s > $dest <<EOF
d214 7
@


1.13
log
@[Bug #30121]
Move to new FI: remove any reference to the old FI and its samples
and replace it with the new FI and examples.
@
text
@a92 6
if test -f /usr/local/bin/class
then
  class="/usr/local/bin/class"
else
  class=""
fi
d151 1
a151 7
      if [ "$class" = "" ]
      then
	CLASS_NAME=
      else
        CLASS_NAME=.`class`
      fi
      RUN_NAME=$RUNTIME.$ARCH.$OS$CLASS_NAME;export RUN_NAME
@


1.12
log
@[Bug #30013]
Change README to README.txt
@
text
@a269 13
	if test \! -d $MLWORKSDIR/foreign/samples
	then
          $mkdir $MLWORKSDIR/foreign/samples &&
	  $chmod_exec $MLWORKSDIR/foreign/samples
	fi &&
	(
	  cd foreign/samples &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/foreign/samples/$f
	    $rm $dest && $cp $f $dest && $chmod_non_exec $dest
	  done
	) &&
d629 2
d650 2
@


1.11
log
@[Bug #2016]
adding new threads examples.
@
text
@d144 1
a144 1
	for f in README sml_96.ps bug-template.txt
@


1.11.1.1
log
@branched from 1.11
@
text
@@


1.11.1.2
log
@[Bug #30013]
Changed README to README.TXT.
@
text
@d144 1
a144 1
	for f in README.TXT sml_96.ps bug-template.txt
@


1.11.1.3
log
@[Bug #30017]
Removed call to /usr/local/bin/class.
@
text
@d93 6
d157 7
a163 1
      RUN_NAME=$RUNTIME.$ARCH.$OS;export RUN_NAME
@


1.11.1.4
log
@[Bug #50004]
Added LD_LIBRARY_PATH setting on Solaris platforms.
@
text
@a2 2
# Copyright (C) 1997 The Harlequin Group Ltd.  All rights reserved.
#
d35 1
a35 1
#
d188 1
a188 1
                cat > $dest <<EOF
a211 7
	      if [ "$OS" = "Solaris" ] ; then
	        cat >> $dest <<EOF
LD_LIBRARY_PATH=/usr/openwin/lib:\${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
EOF
	      fi
              cat $s >> $dest
@


1.11.1.5
log
@[Bug #30170]
Better handling of empty LD_LIBRARY_PATH.
@
text
@d216 1
a216 1
LD_LIBRARY_PATH=/usr/openwin/lib\${LD_LIBRARY_PATH:+:\$LD_LIBRARY_PATH}
@


1.11.1.6
log
@[Bug #30074]
For SunOS, copy the nls directory to the install directory, and add
appropriate startup code to the scripts.
@
text
@a219 8
	      if [ "$OS" = "SunOS" ] ; then
	        cat >> $dest <<EOF
if [ -d /usr/lib/X11/nls ] ; then
  XNLSDIR=\${XNLSDIR:-$MLWORKSDIR/lib/X11/nls}
  export XNLSDIR
fi
EOF
	      fi
d542 1
a542 17
        ) &&
        if test -d lib/X11/nls
        then
          if test \! -d $LIBDIR/X11/nls
          then
            $mkdir $LIBDIR/X11/nls &&
            $chmod_exec $LIBDIR/X11/nls
          fi &&
          (
            cd lib/X11/nls &&
            for f in *
            do
              dest=$LIBDIR/X11/nls/$f
              $rm $dest && $cp $f $dest && $chmod_read_only $dest
            done
          )
        fi
@


1.11.1.7
log
@[Bug #30074]
The nls installation code choked because it contains a nested
directory.  Change to use cp -rp.
@
text
@d553 13
a565 2
          $rm -r $LIBDIR/X11/nls
          $cp -rp lib/X11/nls $LIBDIR/X11/nls
@


1.11.1.8
log
@[Bug #30074]
Correcting sense of test for the existence of /usr/lib/X11/nls on SunOS.
@
text
@d222 1
a222 1
if [ ! -d /usr/lib/X11/nls ] ; then
d275 13
a651 2
        $mkdir $EXAMPLEDIR/foreign &&
        $chmod_exec $EXAMPLEDIR/foreign &&
a670 2
          cd .. &&
          $cp -rp foreign $EXAMPLEDIR
@


1.11.1.8.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@@


1.11.1.8.3.2
log
@[Bug #30289]
Correct code to copy FI examples (should be for old FI not new)
@
text
@a274 13
	if test \! -d $MLWORKSDIR/foreign/samples
	then
          $mkdir $MLWORKSDIR/foreign/samples &&
	  $chmod_exec $MLWORKSDIR/foreign/samples
	fi &&
	(
	  cd foreign/samples &&
	  for f in *
	  do
	    dest=$MLWORKSDIR/foreign/samples/$f
	    $rm $dest && $cp $f $dest && $chmod_non_exec $dest
	  done
	) &&
d639 2
d660 2
@


1.11.1.8.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@@


1.11.1.8.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@@


1.11.1.8.1.2
log
@[Bug #20088]
Change sml_96.ps to sml_97.ps.
@
text
@d140 1
a140 1
	for f in README.TXT sml_97.ps bug-template.txt
@


1.11.1.8.1.2.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@@


1.11.1.8.1.2.1.2
log
@[Bug #30290]
Remove references to FI from Student Linux edition
@
text
@d267 1
a267 1
      echo "$script: library modules in $MLWORKSDIR/{basis,utils,motif,unix}"
d270 28
d639 2
d660 2
@


1.10
log
@[Bug #1845]
Stop trying to do chmods during installation as these can fail
Set permissions correctly on stuff which should/shouldn't be edited by the user
@
text
@d339 5
d351 8
d637 5
d653 6
@


1.9
log
@[Bug #1450]
Install executables with unique (per platform and architecture) names
@
text
@d100 1
d147 1
a147 1
	  $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
d175 1
a175 1
	$chmod_exec $BINDIR/$RUN_NAME
d200 1
a200 1
                cat - $s > $dest <<EOF &&
d224 1
a224 1
                $chmod_exec $dest;;
d228 1
d251 1
a251 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d280 1
a280 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d293 1
a293 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d301 1
a301 1
	    $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
d321 1
a321 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d329 1
a329 1
	    $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
d344 1
a344 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d364 1
a364 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d372 1
a372 1
	    $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
d387 1
a387 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d425 1
a425 1
	    $chmod_non_exec $dest
d466 1
a466 1
	    $rm $dest && $cp $f $dest && $chmod_exec $dest
d479 1
a479 1
	    $chmod_non_exec $dest
d514 1
a514 1
	    $rm $dest && $cp $f $dest && $chmod_non_exec $dest
d527 1
a527 1
	     $chmod_non_exec $dest
d568 1
a568 1
	      $chmod_non_exec $dest
d629 1
a629 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
d635 1
a635 1
	    $rm $dest && $cp -p $f $dest && $chmod_non_exec $dest
@


1.8
log
@Install basis, foreign, motif signatures in a subdirectory
@
text
@d89 1
a91 1
#zcat="/usr/ucb/zcat"
d93 6
a98 1

d141 1
a141 1
      echo "$script: top-level items"
d156 7
d171 4
a174 2
        $cp bin/$ARCH/$OS/$RUNTIME $BINDIR/mlrun &&
	$chmod_exec $BINDIR/mlrun
@


1.8.2.1
log
@branched from 1.8
@
text
@@


1.8.1.1
log
@branched from 1.8
@
text
@@


1.8.1.1.1.1
log
@branched from 1.8.1.1
@
text
@@


1.7
log
@Added toplevel package - copies sml96.ps, README, and bug-template.txt.
@
text
@d267 5
d284 1
a284 1
	    dest=$MLWORKSDIR/foreign/$f
d295 5
d312 1
a312 1
	    dest=$MLWORKSDIR/basis/$f
d338 5
d355 1
a355 1
	    dest=$MLWORKSDIR/motif/$f
@


1.7.1.1
log
@branched from 1.7
@
text
@@


1.6
log
@Must copy contents of examples/motif directory
@
text
@d125 1
a125 1
packages="binaries scripts pervasives libraries images emacs X11 manuals environments examples"
d134 15
@


1.6.1.1
log
@branched from 1.6
@
text
@@


1.6.1.2
log
@Install basis, foreign, motif signatures in a subdirectory
@
text
@a251 5
	if test \! -d $MLWORKSDIR/foreign/signatures
	then
          $mkdir $MLWORKSDIR/foreign/signatures &&
	  $chmod_exec $MLWORKSDIR/foreign/signatures
	fi &&
d264 1
a264 1
	    dest=$MLWORKSDIR/foreign/signatures/$f
a274 5
	if test \! -d $MLWORKSDIR/basis/signatures
	then
          $mkdir $MLWORKSDIR/basis/signatures &&
	  $chmod_exec $MLWORKSDIR/basis/signatures
	fi &&
d287 1
a287 1
	    dest=$MLWORKSDIR/basis/signatures/$f
a312 5
	if test \! -d $MLWORKSDIR/motif/signatures
	then
          $mkdir $MLWORKSDIR/motif/signatures &&
	  $chmod_exec $MLWORKSDIR/motif/signatures
	fi &&
d325 1
a325 1
	    dest=$MLWORKSDIR/motif/signatures/$f
@


1.6.1.3
log
@Added toplevel package - copies sml96.ps, README, and bug-template.txt.
@
text
@d125 1
a125 1
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples"
a133 15
    # Top level items
    toplevel)
      echo "$script: top-level items"
      {
      for f in README sml_96.ps bug-template.txt
      do
        dest=$MLWORKSDIR/$f
        $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
      done
      } ||
      {
        echo "$script: Failed to install top-level items"
        exit 70
      };;

@


1.6.1.1.1.1
log
@branched from 1.6.1.1
@
text
@@


1.6.1.1.1.2
log
@Install basis, foreign, motif signatures in a subdirectory
@
text
@a251 5
	if test \! -d $MLWORKSDIR/foreign/signatures
	then
          $mkdir $MLWORKSDIR/foreign/signatures &&
	  $chmod_exec $MLWORKSDIR/foreign/signatures
	fi &&
d264 1
a264 1
	    dest=$MLWORKSDIR/foreign/signatures/$f
a274 5
	if test \! -d $MLWORKSDIR/basis/signatures
	then
          $mkdir $MLWORKSDIR/basis/signatures &&
	  $chmod_exec $MLWORKSDIR/basis/signatures
	fi &&
d287 1
a287 1
	    dest=$MLWORKSDIR/basis/signatures/$f
a312 5
	if test \! -d $MLWORKSDIR/motif/signatures
	then
          $mkdir $MLWORKSDIR/motif/signatures &&
	  $chmod_exec $MLWORKSDIR/motif/signatures
	fi &&
d325 1
a325 1
	    dest=$MLWORKSDIR/motif/signatures/$f
@


1.6.1.1.1.3
log
@Added toplevel package - copies sml96.ps, README, and bug-template.txt.
@
text
@d125 1
a125 1
packages="toplevel binaries scripts pervasives libraries images emacs X11 manuals environments examples"
a133 15
    # Top level items
    toplevel)
      echo "$script: top-level items"
      {
      for f in README sml_96.ps bug-template.txt
      do
        dest=$MLWORKSDIR/$f
        $rm $dest && $cp -p $f $dest && $chmod_read_only $dest
      done
      } ||
      {
        echo "$script: Failed to install top-level items"
        exit 70
      };;

@


1.5
log
@Use main-static by default to reduce incidence of shared library incompatibilities
@
text
@d573 5
d583 6
@


1.5.1.1
log
@branched from 1.5
@
text
@@


1.4
log
@Removed old command handling stuff and related comments.
@
text
@d29 1
a29 1
#   RUNTIME=main, otherwise use RUNTIME=main-static.
d68 12
a79 1
RUNTIME=main
a81 2
ARCH=SPARC
OS=SunOS
d191 2
@


1.4.2.1
log
@branched from 1.4
@
text
@@


1.4.1.1
log
@branched from 1.4
@
text
@@


1.3
log
@Added examples directory.
@
text
@a70 3
#
# These two are defaults, and can be overridden from the command line
#
a72 1
packages=
a107 31
# Sort out command line arguments
# Not doing this any more

#if [ $# -ne 0 ]
#then
#  while getopts O:A: option
#  do
#    case $option in
#      O) OS=$OPTARG ;;
#      A) ARCH=$OPTARG ;;
#      ?) echo "Usage : install [-A <arch>] [-O <OS>] [<packages>]";exit 1
#    esac
#  done
#fi
#
#if [ $# -ne 0 ]
#then
#  while [ "$1" != "" ]
#  do
#    if [ "$1" = "-O" ]
#    then
#      shift 2
#    elif [ "$1" = "-A" ]
#    then
#      shift 2
#    else
#      packages="$packages $1"; shift
#    fi
#  done
#fi

a114 5
# The arguments are a list of packages to install.  If no arguments
# were specified then install all the packages.

#packages=${packages:-"binaries scripts pervasives libraries images emacs X11 manuals environments"}

d548 1
@


1.2
log
@Improve processing of installation directory
@
text
@d67 1
d156 1
a156 1
packages="binaries scripts pervasives libraries images emacs X11 manuals environments"
d586 27
@


1.1
log
@new unit
Name changed from install in order to avoid clashing with a Sun binary
@
text
@d41 15
a55 1
  MLWORKSDIR=$1
d59 2
a60 1
echo MLWORKSDIR=$MLWORKSDIR
@
