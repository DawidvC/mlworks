head	1.27;
access;
symbols
	MLW_daveb_inline_1_4_99:1.27.3
	MLWorks_21c0_1999_03_25:1.27
	MLWorks_20c1_1998_08_20:1.27
	MLWorks_20c0_1998_08_04:1.27
	MLWorks_20b2c2_1998_06_19:1.27
	MLWorks_20b2_Windows_1998_06_12:1.27
	MLWorks_20b1c1_1998_05_07:1.27
	MLWorks_20b0_1998_04_07:1.27
	MLWorks_20b0_1998_03_20:1.27
	MLWorks_20m2_1998_02_16:1.27
	MLWorks_20m1_1997_10_23:1.27
	MLWorks_11r1:1.26.6.1.1.1.1
	MLWorks_workspace_97:1.27.2
	MLWorks_dt_wizard:1.27.1
	MLWorks_11c0_1997_09_09:1.26.6.1.1.1
	MLWorks_10r3:1.26.6.1.3
	MLWorks_10r2_551:1.26.6.1.2
	MLWorks_11:1.26.6.1.1
	MLWorks_1_0_r2c2_1997_07_28:1.26.6.1
	MLWorks_20m0_1997_06_20:1.27
	MLWorks_1_0_r2c2_1997_06_14:1.26.6.1
	MLWorks_1_0_r2c1_released_1997_05_23:1.26.6.1
	MLWorks_1_0_r2c1_1997_05_12:1.26.6
	MLWorks_BugFix_1997_04_24:1.26
	MLWorks_1_0_r2_Win32_1997_04_11:1.26
	MLWorks_1_0_r2_Unix_1997_04_04:1.26
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.26.4.1.1
	MLWorks_gui_1996_12_18:1.26.5
	MLWorks_1_0_Win32_1996_12_17:1.26.4
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.26.2.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.26.2.1
	MLWorks_1_0_Irix_1996_11_28:1.26.2.1.1
	MLWorks_1_0_Win32_1996_11_22:1.26.3
	MLWorks_1_0_Unix_1996_11_14:1.26.2
	MLWorks_Open_Beta2_1996_10_11:1.26.1
	MLWorks_License_dev:1.25.2
	MLWorks_1_open_beta_1996_09_13:1.25.1
	MLWorks_Open_Beta_1996_08_22:1.25
	MLWorks_Beta_1996_07_02:1.24
	MLWorks_Beta_1996_06_07:1.24
	MLWorks_Beta_1996_06_06:1.24
	MLWorks_Beta_1996_06_05:1.24
	MLWorks_Beta_1996_06_03:1.24
	MLWorks_Beta_1996_05_31:1.24
	MLWorks_Beta_1996_05_30:1.24
	ML_beta_release_12/08/94:1.16
	ML_beta_release_03/08/94:1.16
	ML_revised_beta_release_25/05/94:1.16
	ML_final_beta_release_02/03/94:1.15
	mlworks-28-01-1994:1.14
	Release:1.12
	mlworks-beta-01-09-1993:1.12
	MLWorks-1-0-4-29/01/1993:1.8
	MLWorks-1-0-3-21/12/1992:1.8
	MLWorks-1-0-2-15/12/1992:1.8
	MLWorks-1-0-1-04/12/1992:1.8
	checkpoint_17_08_92:1.6
	Ten15_release_19-11-91:1.2.1.1
	Ten15_release_21-08-91:1.2
	Ten15_release_19-08-91:1.2
	ten15_release:1.2;
locks; strict;
comment	@ * @;


1.27
date	97.05.01.12.55.00;	author jont;	state Exp;
branches
	1.27.1.1
	1.27.2.1
	1.27.3.1;
next	1.26;

1.26
date	96.10.04.16.16.38;	author andreww;	state Exp;
branches
	1.26.1.1
	1.26.2.1
	1.26.3.1
	1.26.4.1
	1.26.5.1
	1.26.6.1;
next	1.25;

1.25
date	96.08.06.10.32.17;	author andreww;	state Exp;
branches
	1.25.1.1
	1.25.2.1;
next	1.24;

1.24
date	96.03.29.12.26.24;	author matthew;	state Exp;
branches;
next	1.23;

1.23
date	96.03.19.15.55.57;	author matthew;	state Exp;
branches;
next	1.22;

1.22
date	95.12.27.11.08.59;	author jont;	state Exp;
branches;
next	1.21;

1.21
date	95.12.18.12.16.13;	author matthew;	state Exp;
branches;
next	1.20;

1.20
date	95.03.23.12.03.11;	author matthew;	state Exp;
branches;
next	1.19;

1.19
date	95.02.07.16.09.58;	author matthew;	state Exp;
branches;
next	1.18;

1.18
date	95.01.17.13.36.48;	author matthew;	state Exp;
branches;
next	1.17;

1.17
date	94.09.22.15.47.50;	author matthew;	state Exp;
branches;
next	1.16;

1.16
date	94.05.11.14.17.28;	author daveb;	state Exp;
branches;
next	1.15;

1.15
date	94.02.21.23.12.34;	author nosa;	state Exp;
branches;
next	1.14;

1.14
date	93.12.16.13.01.58;	author matthew;	state Exp;
branches;
next	1.13;

1.13
date	93.08.11.12.35.23;	author nosa;	state Exp;
branches;
next	1.12;

1.12
date	93.04.26.16.19.35;	author jont;	state Exp;
branches
	1.12.1.1;
next	1.11;

1.11
date	93.03.09.13.00.24;	author matthew;	state Exp;
branches;
next	1.10;

1.10
date	93.02.08.16.04.13;	author matthew;	state Exp;
branches;
next	1.9;

1.9
date	93.02.01.14.20.29;	author matthew;	state Exp;
branches;
next	1.8;

1.8
date	92.12.01.16.00.16;	author matthew;	state Exp;
branches;
next	1.7;

1.7
date	92.10.01.12.02.34;	author richard;	state Exp;
branches;
next	1.6;

1.6
date	92.08.12.12.58.10;	author jont;	state Exp;
branches;
next	1.5;

1.5
date	92.02.11.10.03.03;	author clive;	state Exp;
branches;
next	1.4;

1.4
date	91.11.21.16.49.49;	author jont;	state Exp;
branches;
next	1.3;

1.3
date	91.11.19.12.18.39;	author jont;	state Exp;
branches;
next	1.2;

1.2
date	91.06.28.15.00.49;	author nickh;	state Exp;
branches
	1.2.1.1;
next	1.1;

1.1
date	91.06.07.11.42.18;	author colin;	state Exp;
branches;
next	;

1.2.1.1
date	91.11.19.11.12.52;	author jont;	state Exp;
branches;
next	;

1.12.1.1
date	93.04.26.16.19.35;	author jont;	state Exp;
branches;
next	;

1.25.1.1
date	96.09.13.11.41.06;	author hope;	state Exp;
branches;
next	;

1.25.2.1
date	96.10.07.16.34.08;	author hope;	state Exp;
branches;
next	;

1.26.1.1
date	96.10.17.11.53.16;	author hope;	state Exp;
branches;
next	;

1.26.2.1
date	96.11.14.13.20.52;	author hope;	state Exp;
branches
	1.26.2.1.1.1;
next	;

1.26.2.1.1.1
date	96.11.28.15.31.51;	author hope;	state Exp;
branches;
next	;

1.26.3.1
date	96.11.22.18.38.38;	author hope;	state Exp;
branches;
next	;

1.26.4.1
date	96.12.17.18.17.38;	author hope;	state Exp;
branches
	1.26.4.1.1.1;
next	;

1.26.4.1.1.1
date	97.02.24.12.11.54;	author hope;	state Exp;
branches;
next	;

1.26.5.1
date	96.12.18.10.12.54;	author hope;	state Exp;
branches;
next	;

1.26.6.1
date	97.05.12.10.51.13;	author hope;	state Exp;
branches
	1.26.6.1.1.1
	1.26.6.1.2.1
	1.26.6.1.3.1;
next	;

1.26.6.1.1.1
date	97.07.28.18.34.33;	author daveb;	state Exp;
branches
	1.26.6.1.1.1.1.1;
next	;

1.26.6.1.1.1.1.1
date	97.10.07.12.00.25;	author jkbrook;	state Exp;
branches;
next	;

1.26.6.1.2.1
date	97.09.08.17.27.29;	author daveb;	state Exp;
branches;
next	;

1.26.6.1.3.1
date	97.09.09.14.24.26;	author daveb;	state Exp;
branches;
next	;

1.27.1.1
date	97.09.10.19.43.22;	author brucem;	state Exp;
branches;
next	;

1.27.2.1
date	97.09.11.21.10.49;	author daveb;	state Exp;
branches;
next	;

1.27.3.1
date	99.04.01.18.09.07;	author daveb;	state Exp;
branches;
next	;


desc
@Datatypes for Basis and Context and associated functions
@


1.27
log
@[Bug #30088]
Get rid of MLWorks.Option
@
text
@(* basis.sml the signature *)
(*
$Log: basis.sml,v $
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
 * Revision 1.25  1996/08/06  10:32:17  andreww
 * [Bug #1521]
 * propagating changes to _types.sml
 *
 * Revision 1.24  1996/03/29  12:26:24  matthew
 * Adding env_to_context function
 *
 * Revision 1.23  1996/03/19  15:55:57  matthew
 * Adding value polymorphism option
 *
 * Revision 1.22  1995/12/27  11:08:59  jont
 * Removing Option in favour of MLWorks.Option
 *
Revision 1.21  1995/12/18  12:16:13  matthew
Passing error info into close

Revision 1.20  1995/03/23  12:03:11  matthew
Use Stamp instead of Tyname_id etc.

Revision 1.19  1995/02/07  16:09:58  matthew
Improvement to unbound long id errors

Revision 1.18  1995/01/17  13:36:48  matthew
Rationalizing debugger

Revision 1.17  1994/09/22  15:47:50  matthew
Changed type of lookup_val

Revision 1.16  1994/05/11  14:17:28  daveb
testing new overloading scheme.

Revision 1.15  1994/02/21  23:12:34  nosa
generate_moduler compiler option required in type variable instantiation.

Revision 1.14  1993/12/16  13:01:58  matthew
Added level field to Basis.
Renamed Basis.level to Basis.context_level

Revision 1.13  1993/08/11  12:35:23  nosa
lookup_val now returns runtime_instance for polymorphic debugger.

Revision 1.12  1993/04/26  16:19:35  jont
Added remove_str for getting rid of FullPervasiveLibrary_ from initial env

Revision 1.11  1993/03/09  13:00:24  matthew
Str to Structure

Revision 1.10  1993/02/08  16:04:13  matthew
Removed open Datatypes
Changes for BasisTypes

Revision 1.9  1993/02/01  14:20:29  matthew
Added sharing

Revision 1.8  1992/12/01  16:00:16  matthew
Changed handling of overloaded variable errors.

Revision 1.7  1992/10/01  12:02:34  richard
Moved chain reducing code here from _toplevel.

Revision 1.6  1992/08/12  12:58:10  jont
Removed some redundant structure arguments and sharing
Converted where relevant to use NewMap.{forall,exists,iterate}

Revision 1.5  1992/02/11  10:03:03  clive
New pervasive library code - cut some things out of the initial type basis

Revision 1.4  1991/11/21  16:49:49  jont
*** empty log message ***

Revision 1.3  91/11/19  12:18:39  jont
Merging in comments from Ten15 branch to main trunk

Revision 1.2.1.1  91/11/19  11:12:52  jont
Added comments for DRA on functions

Revision 1.2  91/06/28  15:00:49  nickh
Added empty_basis value.

Revision 1.1  91/06/07  11:42:18  colin
Initial revision

Copyright (c) 1991 Harlequin Ltd.
*)

(* The types Basis and Context correspond to the semantic object
classes Basis and Context respectively, as defined in the definition
(p17,31). This module defines the types (which are both product types
of other types) and the commonly used functions over them which are
all described in the Definition *)

require "basistypes";

signature BASIS =
  sig
    structure BasisTypes : BASISTYPES

    exception LookupValId of BasisTypes.Datatypes.Ident.ValId
    exception LookupTyCon of BasisTypes.Datatypes.Ident.TyCon
    exception LookupStrId of BasisTypes.Datatypes.Ident.StrId
    exception LookupTyvar
    exception LookupSigId
    exception LookupFunId

    type error_info
    type print_options
    type options
    (* sigenvs *)

    val empty_sigenv : BasisTypes.Sigenv
    val add_to_sigenv : BasisTypes.Datatypes.Ident.SigId * BasisTypes.Sigma * 
                        BasisTypes.Sigenv -> BasisTypes.Sigenv
    val sigenv_plus_sigenv : BasisTypes.Sigenv * BasisTypes.Sigenv 
                          -> BasisTypes.Sigenv 

    (* funenvs *)
    val empty_funenv : BasisTypes.Funenv
    val add_to_funenv : BasisTypes.Datatypes.Ident.FunId * BasisTypes.Phi 
                      * BasisTypes.Funenv -> BasisTypes.Funenv
    val funenv_plus_funenv : BasisTypes.Funenv * BasisTypes.Funenv 
                          -> BasisTypes.Funenv 

    val lookup_tyvar : BasisTypes.Datatypes.Ident.TyVar * BasisTypes.Context
                    -> BasisTypes.Datatypes.Type

    (* Can raise LookupStrid or LookupValId *)
    val lookup_val :
      BasisTypes.Datatypes.Ident.LongValId * 
      BasisTypes.Context * 
      BasisTypes.Datatypes.Ident.Location.T * 
      bool ->
      BasisTypes.Datatypes.Type * 
      (BasisTypes.Datatypes.InstanceInfo * 
       BasisTypes.Datatypes.Instance ref option)

    (* Can raise LookupTyCon *)
    val lookup_tycon : 
      BasisTypes.Datatypes.Ident.TyCon * BasisTypes.Context 
      -> BasisTypes.Datatypes.Tystr

    (* Can raise LookupStrid or LookupTyCon *)
    val lookup_longtycon : 
      BasisTypes.Datatypes.Ident.LongTyCon * BasisTypes.Context 
      -> BasisTypes.Datatypes.Tystr

    val get_tyvarset : BasisTypes.Context -> 
                       BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set

    val context_plus_env : BasisTypes.Context * BasisTypes.Datatypes.Env
                       -> BasisTypes.Context
    val context_plus_ve : BasisTypes.Context * BasisTypes.Datatypes.Valenv
                       -> BasisTypes.Context
    val context_plus_te : BasisTypes.Context * BasisTypes.Datatypes.Tyenv 
                       -> BasisTypes.Context

    val context_plus_tyvarset :
      BasisTypes.Context * 
      BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set ->
      BasisTypes.Context

    val context_plus_tyvarlist :
      BasisTypes.Context * BasisTypes.Datatypes.Ident.TyVar list 
   -> BasisTypes.Context

    val context_for_datbind : 
      BasisTypes.Context * string *
      (BasisTypes.Datatypes.Ident.TyVar list * 
       BasisTypes.Datatypes.Ident.TyCon) list -> 
       BasisTypes.Context

    val context_level : BasisTypes.Context -> int

    val close :
      (error_info * options * BasisTypes.Datatypes.Ident.Location.T) ->
      int * BasisTypes.Datatypes.Valenv * 
      BasisTypes.Datatypes.Ident.ValId list * 
      BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set * bool -> 
      BasisTypes.Datatypes.Valenv

    val basis_to_context : BasisTypes.Basis -> BasisTypes.Context
    val env_of_context : BasisTypes.Context -> BasisTypes.Datatypes.Env
    val te_of_context : BasisTypes.Context -> BasisTypes.Datatypes.Tyenv
    val env_to_context : BasisTypes.Datatypes.Env -> BasisTypes.Context

    (* Can raise LookupStrid *)
    val lookup_longstrid : 
         BasisTypes.Datatypes.Ident.LongStrId * BasisTypes.Basis
      -> BasisTypes.Datatypes.Structure
    val basis_plus_env : BasisTypes.Basis * BasisTypes.Datatypes.Env 
                      -> BasisTypes.Basis
    val env_in_basis : BasisTypes.Datatypes.Env -> BasisTypes.Basis

    val basis_plus_names : BasisTypes.Basis * BasisTypes.Nameset 
                        -> BasisTypes.Basis

    val basis_plus_sigenv : BasisTypes.Basis * BasisTypes.Sigenv 
                         -> BasisTypes.Basis
    val sigenv_in_basis : BasisTypes.Sigenv -> BasisTypes.Basis

    (* Can raise LookupSigId *)
    val lookup_sigid : BasisTypes.Datatypes.Ident.SigId * BasisTypes.Basis
                    -> BasisTypes.Sigma

    val basis_plus_funenv : BasisTypes.Basis * BasisTypes.Funenv 
                         -> BasisTypes.Basis
    val funenv_in_basis : BasisTypes.Funenv -> BasisTypes.Basis      

    (* Can raise LookupFunId *)
    val lookup_funid : BasisTypes.Datatypes.Ident.FunId * BasisTypes.Basis 
                    -> BasisTypes.Phi

(*
    val basis_plus_basis : BasisTypes.Basis * BasisTypes.Basis 
                         -> BasisTypes.Basis
*)
    val basis_circle_plus_basis : BasisTypes.Basis * BasisTypes.Basis 
                               -> BasisTypes.Basis

    val basis_level : BasisTypes.Basis -> int

    val initial_basis : BasisTypes.Basis
    val initial_basis_for_builtin_library : BasisTypes.Basis

    val empty_basis : BasisTypes.Basis

    val reduce_chains : BasisTypes.Basis -> unit

    val remove_str :
      BasisTypes.Basis * BasisTypes.Datatypes.Ident.StrId -> BasisTypes.Basis

    val add_str :
      BasisTypes.Basis * BasisTypes.Datatypes.Ident.StrId * 
      BasisTypes.Datatypes.Structure -> BasisTypes.Basis

    val add_val :
      BasisTypes.Basis * BasisTypes.Datatypes.Ident.ValId * 
      BasisTypes.Datatypes.Typescheme -> BasisTypes.Basis

    val pervasive_stamp_count : int

    val tynamesNotIn: BasisTypes.Datatypes.Type
                    * BasisTypes.Context
                   -> BasisTypes.Datatypes.Tyname list

    val valEnvTynamesNotIn: BasisTypes.Datatypes.Valenv
                       * BasisTypes.Context
                      -> BasisTypes.Datatypes.Tyname list

end;
@


1.27.3.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a3 4
 * Revision 1.27  1997/05/01  12:55:00  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
@


1.27.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a3 4
 * Revision 1.27  1997/05/01  12:55:00  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
@


1.27.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a3 4
 * Revision 1.27  1997/05/01  12:55:00  jont
 * [Bug #30088]
 * Get rid of MLWorks.Option
 *
@


1.26
log
@[Bug #1592]
adding an extra function, tynamesIncludedIn
@
text
@d4 4
d141 1
a141 1
       BasisTypes.Datatypes.Instance ref MLWorks.Option.option)
@


1.26.6.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.26.6.1.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a3 3
 * Revision 1.26.6.1  1997/05/12  10:51:13  hope
 * branched from 1.26
 *
@


1.26.6.1.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a3 3
 * Revision 1.26.6.1  1997/05/12  10:51:13  hope
 * branched from 1.26
 *
@


1.26.6.1.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a3 3
 * Revision 1.26.6.1  1997/05/12  10:51:13  hope
 * branched from 1.26
 *
@


1.26.6.1.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a3 3
 * Revision 1.26.6.1.1.1  1997/07/28  18:34:33  daveb
 * branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.26.5.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.26.4.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.26.4.1.1.1
log
@branched from 1.26.4.1
@
text
@a3 3
 * Revision 1.26.4.1  1996/12/17  18:17:38  hope
 * branched from 1.26
 *
@


1.26.3.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.26.2.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.26.2.1.1.1
log
@branched from 1.26.2.1
@
text
@a3 3
 * Revision 1.26.2.1  1996/11/14  13:20:52  hope
 * branched from 1.26
 *
@


1.26.1.1
log
@branched from 1.26
@
text
@a3 4
 * Revision 1.26  1996/10/04  16:16:38  andreww
 * [Bug #1592]
 * adding an extra function, tynamesIncludedIn
 *
@


1.25
log
@[Bug #1521]
propagating changes to _types.sml
@
text
@d4 4
d114 4
a117 2
    val add_to_sigenv : BasisTypes.Datatypes.Ident.SigId * BasisTypes.Sigma * BasisTypes.Sigenv -> BasisTypes.Sigenv
    val sigenv_plus_sigenv : BasisTypes.Sigenv * BasisTypes.Sigenv -> BasisTypes.Sigenv 
d121 4
a124 2
    val add_to_funenv : BasisTypes.Datatypes.Ident.FunId * BasisTypes.Phi * BasisTypes.Funenv -> BasisTypes.Funenv
    val funenv_plus_funenv : BasisTypes.Funenv * BasisTypes.Funenv -> BasisTypes.Funenv 
d126 2
a127 1
    val lookup_tyvar : BasisTypes.Datatypes.Ident.TyVar * BasisTypes.Context -> BasisTypes.Datatypes.Type
d141 2
a142 1
      BasisTypes.Datatypes.Ident.TyCon * BasisTypes.Context -> BasisTypes.Datatypes.Tystr
d146 5
a150 1
      BasisTypes.Datatypes.Ident.LongTyCon * BasisTypes.Context -> BasisTypes.Datatypes.Tystr
d152 6
a157 1
    val get_tyvarset : BasisTypes.Context -> BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set
a158 3
    val context_plus_env : BasisTypes.Context * BasisTypes.Datatypes.Env -> BasisTypes.Context
    val context_plus_ve : BasisTypes.Context * BasisTypes.Datatypes.Valenv -> BasisTypes.Context
    val context_plus_te : BasisTypes.Context * BasisTypes.Datatypes.Tyenv -> BasisTypes.Context
d160 4
a163 1
      BasisTypes.Context * BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set -> BasisTypes.Context
d165 2
a166 1
      BasisTypes.Context * BasisTypes.Datatypes.Ident.TyVar list -> BasisTypes.Context
d170 3
a172 2
      (BasisTypes.Datatypes.Ident.TyVar list * BasisTypes.Datatypes.Ident.TyCon) list -> 
      BasisTypes.Context
d178 2
a179 1
      int * BasisTypes.Datatypes.Valenv * BasisTypes.Datatypes.Ident.ValId list * 
d190 4
a193 2
      BasisTypes.Datatypes.Ident.LongStrId * BasisTypes.Basis -> BasisTypes.Datatypes.Structure
    val basis_plus_env : BasisTypes.Basis * BasisTypes.Datatypes.Env -> BasisTypes.Basis
d196 2
a197 1
    val basis_plus_names : BasisTypes.Basis * BasisTypes.Nameset -> BasisTypes.Basis
d199 2
a200 1
    val basis_plus_sigenv : BasisTypes.Basis * BasisTypes.Sigenv -> BasisTypes.Basis
d204 2
a205 1
    val lookup_sigid : BasisTypes.Datatypes.Ident.SigId * BasisTypes.Basis -> BasisTypes.Sigma
d207 2
a208 1
    val basis_plus_funenv : BasisTypes.Basis * BasisTypes.Funenv -> BasisTypes.Basis
d212 2
a213 1
    val lookup_funid : BasisTypes.Datatypes.Ident.FunId * BasisTypes.Basis -> BasisTypes.Phi
d215 6
a220 2
    val basis_plus_basis : BasisTypes.Basis * BasisTypes.Basis -> BasisTypes.Basis
    val basis_circle_plus_basis : BasisTypes.Basis * BasisTypes.Basis -> BasisTypes.Basis
d235 2
a236 2
      BasisTypes.Basis * BasisTypes.Datatypes.Ident.StrId * BasisTypes.Datatypes.Structure -> 
      BasisTypes.Basis
d239 2
a240 2
      BasisTypes.Basis * BasisTypes.Datatypes.Ident.ValId * BasisTypes.Datatypes.Typescheme -> 
      BasisTypes.Basis
d244 9
a252 1
  end;
@


1.25.2.1
log
@branched from 1.25
@
text
@a3 4
 * Revision 1.25  1996/08/06  10:32:17  andreww
 * [Bug #1521]
 * propagating changes to _types.sml
 *
@


1.25.1.1
log
@branched from 1.25
@
text
@a3 4
 * Revision 1.25  1996/08/06  10:32:17  andreww
 * [Bug #1521]
 * propagating changes to _types.sml
 *
@


1.24
log
@Adding env_to_context function
@
text
@d4 3
d106 1
a106 1

d156 1
a156 1
      (bool * error_info * print_options * BasisTypes.Datatypes.Ident.Location.T) ->
@


1.23
log
@Adding value polymorphism option
@
text
@d4 3
d161 1
@


1.22
log
@Removing Option in favour of MLWorks.Option
@
text
@d4 3
d150 1
a150 1
      (error_info * print_options * BasisTypes.Datatypes.Ident.Location.T) ->
@


1.21
log
@Passing error info into close
@
text
@d4 3
d119 1
a119 1
       BasisTypes.Datatypes.Instance ref BasisTypes.Datatypes.Option.opt)
@


1.20
log
@Use Stamp instead of Tyname_id etc.
@
text
@d4 3
d91 3
a93 1
    exception CloseError of (string * BasisTypes.Datatypes.Type)
d144 1
@


1.19
log
@Improvement to unbound long id errors
@
text
@d4 3
d190 1
a190 3
    val pervasive_strname_count : int
    val pervasive_tyname_count : int
    val pervasive_tyfun_count : int
@


1.18
log
@Rationalizing debugger
@
text
@d4 3
d79 4
a82 3
    exception LookupValId_in_Context
    exception LookupLongTyCon
    exception LookupTyCon
a83 1
    exception LookupLongStrId
d87 14
d102 15
a116 3
      BasisTypes.Datatypes.Ident.LongValId * BasisTypes.Context * BasisTypes.Datatypes.Ident.Location.T * bool
      -> BasisTypes.Datatypes.Type
	 * (BasisTypes.Datatypes.InstanceInfo * BasisTypes.Datatypes.Instance ref BasisTypes.Datatypes.Option.opt)
a117 2
    val lookup_tycon : BasisTypes.Datatypes.Ident.TyCon * BasisTypes.Context -> BasisTypes.Datatypes.Tystr
    val lookup_longtycon : BasisTypes.Datatypes.Ident.LongTyCon * BasisTypes.Context -> BasisTypes.Datatypes.Tystr
d119 1
d123 1
a123 1
    val context_plus_tyvarset_and_tyvarenv :
d125 8
d136 3
a138 1
      int * BasisTypes.Datatypes.Valenv * BasisTypes.Datatypes.Ident.ValId list * BasisTypes.Datatypes.Ident.TyVar BasisTypes.Set.Set * bool -> BasisTypes.Datatypes.Valenv
d144 3
a146 1
    val lookup_longstrid : BasisTypes.Datatypes.Ident.LongStrId * BasisTypes.Basis -> BasisTypes.Datatypes.Structure
d154 2
d160 2
d178 13
@


1.17
log
@Changed type of lookup_val
@
text
@d4 3
d87 1
a87 1
	 * (int list * BasisTypes.Datatypes.Instance ref BasisTypes.Datatypes.Option.opt)
@


1.16
log
@testing new overloading scheme.
@
text
@d4 3
d82 1
a82 2
      BasisTypes.Datatypes.Ident.Path * BasisTypes.Datatypes.Ident.ValId
      * BasisTypes.Context * BasisTypes.Datatypes.Ident.Location.T * bool
d84 1
a84 2
	 * (int list
	    * BasisTypes.Datatypes.Instance ref BasisTypes.Datatypes.Option.opt)
@


1.15
log
@generate_moduler compiler option required in type variable instantiation.
@
text
@d4 3
a75 1
    exception UnresolvedVar of BasisTypes.Datatypes.Ident.ValId
d78 7
a84 3
    val lookup_val : BasisTypes.Datatypes.Ident.Path * BasisTypes.Datatypes.Ident.ValId * BasisTypes.Context * bool ->
      BasisTypes.Datatypes.Type * (int list * BasisTypes.Datatypes.Instance ref 
                                   BasisTypes.Datatypes.Option.opt)
@


1.14
log
@Added level field to Basis.
Renamed Basis.level to Basis.context_level
@
text
@d4 4
d76 2
a77 2
    val lookup_val : BasisTypes.Datatypes.Ident.Path * BasisTypes.Datatypes.Ident.ValId * BasisTypes.Context ->
      BasisTypes.Datatypes.Type * (int list * BasisTypes.Datatypes.instance ref 
@


1.13
log
@lookup_val now returns runtime_instance for polymorphic debugger.
@
text
@d4 3
d83 2
a84 1
    val level : BasisTypes.Context -> int
d108 2
@


1.12
log
@Added remove_str for getting rid of FullPervasiveLibrary_ from initial env
@
text
@d4 3
d70 2
a71 1
      BasisTypes.Datatypes.Type
@


1.12.1.1
log
@Fork for bug fixing
@
text
@a3 3
Revision 1.12  1993/04/26  16:19:35  jont
Added remove_str for getting rid of FullPervasiveLibrary_ from initial env

@


1.11
log
@Str to Structure
@
text
@d4 3
d108 2
a110 1

@


1.10
log
@Removed open Datatypes
Changes for BasisTypes
@
text
@d4 4
d81 1
a81 1
    val lookup_longstrid : BasisTypes.Datatypes.Ident.LongStrId * BasisTypes.Basis -> BasisTypes.Datatypes.Str
@


1.9
log
@Added sharing
@
text
@d4 3
d44 1
a44 4
require "../utils/set";
require "tyvarenv";
require "sigenv";
require "funenv";
d48 1
a48 16
    structure Tyvarenv : TYVARENV
    structure Sigenv : SIGENV
    structure Funenv : FUNENV
    structure Set : SET

    sharing Tyvarenv.Datatypes = Sigenv.Sigma.Nameset.Datatypes
    sharing Sigenv.Sigma = Funenv.Phi.Sigma

    open Tyvarenv.Datatypes

    datatype Context = 
      CONTEXT of (int * Ident.TyVar Set.Set * Env * Tyvarenv.Tyvarenv)

    datatype Basis = 
      BASIS of (Funenv.Phi.Sigma.Nameset.Nameset * Funenv.Funenv *
		Sigenv.Sigenv * Env)
d56 2
a57 2
    exception UnresolvedVar of Ident.ValId
    exception CloseError of (string * Type)
d59 8
a66 7
    val lookup_val : Ident.Path * Ident.ValId * Context -> Type
    val lookup_tycon : Ident.TyCon * Context -> Tystr
    val lookup_longtycon : Ident.LongTyCon * Context -> Tystr
    val get_tyvarset : Context -> Ident.TyVar Set.Set
    val context_plus_env : Context * Env -> Context
    val context_plus_ve : Context * Valenv -> Context
    val context_plus_te : Context * Tyenv -> Context
d68 2
a69 2
      Context * Ident.TyVar Set.Set -> Context
    val level : Context -> int
d71 1
a71 1
      int * Valenv * Ident.ValId list * Ident.TyVar Set.Set * bool -> Valenv
d73 3
a75 3
    val basis_to_context : Basis -> Context
    val env_of_context : Context -> Env
    val te_of_context : Context -> Tyenv
d77 3
a79 3
    val lookup_longstrid : Ident.LongStrId * Basis -> Str
    val basis_plus_env : Basis * Env -> Basis
    val env_in_basis : Env -> Basis
d81 1
a81 1
    val basis_plus_names : Basis * Funenv.Phi.Sigma.Nameset.Nameset -> Basis
d83 3
a85 3
    val basis_plus_sigenv : Basis * Sigenv.Sigenv -> Basis
    val sigenv_in_basis : Sigenv.Sigenv -> Basis
    val lookup_sigid : Ident.SigId * Basis -> Sigenv.Sigma.Sigma
d87 3
a89 3
    val basis_plus_funenv : Basis * Funenv.Funenv -> Basis
    val funenv_in_basis : Funenv.Funenv -> Basis      
    val lookup_funid : Ident.FunId * Basis -> Funenv.Phi.Phi
d91 2
a92 2
    val basis_plus_basis : Basis * Basis -> Basis
    val basis_circle_plus_basis : Basis * Basis -> Basis
d94 2
a95 2
    val initial_basis : Basis
    val initial_basis_for_builtin_library : Basis
d97 1
a97 1
    val empty_basis : Basis
d99 1
a99 1
    val reduce_chains : Basis -> unit
@


1.8
log
@Changed handling of overloaded variable errors.
@
text
@d4 3
d53 1
a53 1
    sharing Tyvarenv.Datatypes = Funenv.Phi.Sigma.Nameset.Datatypes
@


1.7
log
@Moved chain reducing code here from _toplevel.
@
text
@d4 3
d68 1
@


1.6
log
@Removed some redundant structure arguments and sharing
Converted where relevant to use NewMap.{forall,exists,iterate}
@
text
@d4 4
d106 2
d109 1
@


1.5
log
@New pervasive library code - cut some things out of the initial type basis
@
text
@d4 3
a31 1
require "datatypes";
a32 3
require "nameset";
require "sigma";
require "phi";
a37 1
    structure Datatypes : DATATYPES
a38 2
    structure Sigma : SIGMA
    structure Phi : PHI
a40 1
    structure Nameset : NAMESET
d43 2
a44 15
    sharing Datatypes
      = Tyvarenv.Datatypes 
      = Sigma.Datatypes
      = Phi.Datatypes
      = Sigenv.Datatypes
      = Funenv.Datatypes
      = Nameset.Datatypes
    sharing Nameset 
      = Sigma.Nameset
      = Phi.Nameset
      = Funenv.Nameset
    sharing Sigma 
      = Phi.Sigma 
      = Sigenv.Sigma 
    sharing Phi = Funenv.Phi 
d46 1
a46 1
    open Datatypes
d52 2
a53 1
      BASIS of (Nameset.Nameset * Funenv.Funenv * Sigenv.Sigenv * Env)
d84 1
a84 1
    val basis_plus_names : Basis * Nameset.Nameset -> Basis
d88 1
a88 1
    val lookup_sigid : Ident.SigId * Basis -> Sigma.Sigma
d92 1
a92 1
    val lookup_funid : Ident.FunId * Basis -> Phi.Phi
@


1.4
log
@*** empty log message ***
@
text
@d3 4
a6 1
$Log:	basis.sml,v $
d115 1
@


1.3
log
@Merging in comments from Ten15 branch to main trunk
@
text
@d1 1
d4 3
d16 1
@


1.2
log
@Added empty_basis value.
@
text
@d3 6
d13 7
@


1.2.1.1
log
@Added comments for DRA on functions
@
text
@a2 3
Revision 1.2  91/06/28  15:00:49  nickh
Added empty_basis value.

a6 7

(* The types Basis and Context correspond to the semantic object
classes Basis and Context respectively, as defined in the definition
(p17,31). This module defines the types (which are both product types
of other types) and the commonly used functions over them which are
all described in the Definition *)

@


1.1
log
@Initial revision
@
text
@d2 4
a5 1
$Log$
d94 2
@
