head	1.81;
access;
symbols
	MLW_daveb_inline_1_4_99:1.81.1
	MLWorks_21c0_1999_03_25:1.81
	MLWorks_20c1_1998_08_20:1.72
	MLWorks_20c0_1998_08_04:1.71
	MLWorks_20b2c2_1998_06_19:1.71
	MLWorks_20b2_Windows_1998_06_12:1.69
	MLWorks_20b1c1_1998_05_07:1.68
	MLWorks_20b0_1998_04_07:1.66
	MLWorks_20b0_1998_03_20:1.63
	MLWorks_20m2_1998_02_16:1.62
	MLWorks_20m1_1997_10_23:1.59
	MLWorks_11r1:1.51.1.5.1.3.1
	MLWorks_workspace_97:1.56.2
	MLWorks_dt_wizard:1.56.1
	MLWorks_11c0_1997_09_09:1.51.1.5.1.3
	MLWorks_10r3:1.51.1.5.3
	MLWorks_10r2_551:1.51.1.5.2
	MLWorks_11:1.51.1.5.1
	MLWorks_1_0_r2c2_1997_07_28:1.51.1.5
	MLWorks_20m0_1997_06_20:1.54
	MLWorks_1_0_r2c2_1997_06_14:1.51.1.5
	MLWorks_1_0_r2c1_released_1997_05_23:1.51.1.3
	MLWorks_1_0_r2c1_1997_05_12:1.51.1
	MLWorks_BugFix_1997_04_24:1.51
	MLWorks_1_0_r2_Win32_1997_04_11:1.51
	MLWorks_1_0_r2_Unix_1997_04_04:1.50
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.46.1.1.1
	MLWorks_gui_1996_12_18:1.46.2
	MLWorks_1_0_Win32_1996_12_17:1.46.1
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.44.1.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.44.1.1
	MLWorks_1_0_Irix_1996_11_28:1.44.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.45.1
	MLWorks_1_0_Unix_1996_11_14:1.44.1
	MLWorks_Open_Beta2_1996_10_11:1.37.3
	MLWorks_License_dev:1.37.2
	MLWorks_1_open_beta_1996_09_13:1.37.1
	MLWorks_Open_Beta_1996_08_22:1.36
	MLWorks_Beta_1996_07_02:1.34
	MLWorks_Beta_1996_06_07:1.31
	MLWorks_Beta_1996_06_06:1.30
	MLWorks_Beta_1996_06_05:1.27
	MLWorks_Beta_1996_06_03:1.27
	MLWorks_Beta_1996_05_31:1.27
	MLWorks_Beta_1996_05_30:1.27
	ML_beta_release_12/08/94:1.9
	ML_beta_release_03/08/94:1.9
	ML_revised_beta_release_25/05/94:1.9
	ML_final_beta_release_02/03/94:1.8
	mlworks-28-01-1994:1.4
	Release:1.3
	mlworks-beta-01-09-1993:1.3;
locks; strict;
comment	@# @;


1.81
date	99.03.20.12.55.47;	author mitchell;	state Exp;
branches
	1.81.1.1;
next	1.80;

1.80
date	99.03.18.12.17.45;	author johnh;	state Exp;
branches;
next	1.79;

1.79
date	99.03.17.17.39.20;	author johnh;	state Exp;
branches;
next	1.78;

1.78
date	99.03.17.10.18.38;	author mitchell;	state Exp;
branches;
next	1.77;

1.77
date	99.03.16.12.53.20;	author mitchell;	state Exp;
branches;
next	1.76;

1.76
date	99.03.15.14.21.54;	author johnh;	state Exp;
branches;
next	1.75;

1.75
date	99.03.13.13.19.26;	author mitchell;	state Exp;
branches;
next	1.74;

1.74
date	99.03.12.15.17.30;	author mitchell;	state Exp;
branches;
next	1.73;

1.73
date	99.03.12.11.41.11;	author johnh;	state Exp;
branches;
next	1.72;

1.72
date	98.08.19.11.35.16;	author johnh;	state Exp;
branches;
next	1.71;

1.71
date	98.06.18.16.19.55;	author johnh;	state Exp;
branches;
next	1.70;

1.70
date	98.06.18.14.29.51;	author jkbrook;	state Exp;
branches;
next	1.69;

1.69
date	98.05.11.16.44.07;	author jkbrook;	state Exp;
branches;
next	1.68;

1.68
date	98.05.05.18.55.43;	author jkbrook;	state Exp;
branches;
next	1.67;

1.67
date	98.05.05.17.56.54;	author io;	state Exp;
branches;
next	1.66;

1.66
date	98.04.01.12.25.19;	author jont;	state Exp;
branches;
next	1.65;

1.65
date	98.03.26.14.38.05;	author jkbrook;	state Exp;
branches;
next	1.64;

1.64
date	98.03.26.12.07.51;	author jkbrook;	state Exp;
branches;
next	1.63;

1.63
date	98.03.20.20.35.33;	author jkbrook;	state Exp;
branches;
next	1.62;

1.62
date	98.02.16.17.25.05;	author jkbrook;	state Exp;
branches;
next	1.61;

1.61
date	98.01.13.18.21.46;	author jkbrook;	state Exp;
branches;
next	1.60;

1.60
date	97.11.24.13.58.10;	author daveb;	state Exp;
branches;
next	1.59;

1.59
date	97.10.10.09.52.00;	author daveb;	state Exp;
branches;
next	1.58;

1.58
date	97.10.01.14.33.56;	author jkbrook;	state Exp;
branches;
next	1.57;

1.57
date	97.09.29.17.19.37;	author jkbrook;	state Exp;
branches;
next	1.56;

1.56
date	97.07.23.12.52.32;	author jont;	state Exp;
branches
	1.56.1.1
	1.56.2.1;
next	1.55;

1.55
date	97.07.01.14.10.48;	author stephenb;	state Exp;
branches;
next	1.54;

1.54
date	97.06.13.17.26.37;	author jkbrook;	state Exp;
branches;
next	1.53;

1.53
date	97.05.21.12.07.05;	author stephenb;	state Exp;
branches;
next	1.52;

1.52
date	97.05.15.12.37.24;	author daveb;	state Exp;
branches;
next	1.51;

1.51
date	97.04.07.12.25.15;	author jont;	state Exp;
branches
	1.51.1.1;
next	1.50;

1.50
date	97.04.03.17.09.20;	author daveb;	state Exp;
branches;
next	1.49;

1.49
date	97.04.03.13.42.40;	author andreww;	state Exp;
branches;
next	1.48;

1.48
date	97.01.09.14.44.58;	author jont;	state Exp;
branches;
next	1.47;

1.47
date	97.01.08.16.11.23;	author jont;	state Exp;
branches;
next	1.46;

1.46
date	96.12.04.14.30.22;	author jont;	state Exp;
branches
	1.46.1.1
	1.46.2.1;
next	1.45;

1.45
date	96.11.19.17.30.51;	author jont;	state Exp;
branches
	1.45.1.1;
next	1.44;

1.44
date	96.11.13.18.08.04;	author jont;	state Exp;
branches
	1.44.1.1;
next	1.43;

1.43
date	96.11.13.10.52.55;	author daveb;	state Exp;
branches;
next	1.42;

1.42
date	96.11.08.18.15.25;	author jont;	state Exp;
branches;
next	1.41;

1.41
date	96.11.08.16.53.03;	author jont;	state Exp;
branches;
next	1.40;

1.40
date	96.11.07.15.44.13;	author andreww;	state Exp;
branches;
next	1.39;

1.39
date	96.11.06.11.30.24;	author jont;	state Exp;
branches;
next	1.38;

1.38
date	96.11.06.11.03.50;	author jont;	state Exp;
branches;
next	1.37;

1.37
date	96.08.29.16.51.49;	author jont;	state Exp;
branches
	1.37.1.1
	1.37.2.1
	1.37.3.1;
next	1.36;

1.36
date	96.08.22.10.45.05;	author jont;	state Exp;
branches;
next	1.35;

1.35
date	96.08.19.13.33.37;	author daveb;	state Exp;
branches;
next	1.34;

1.34
date	96.06.27.13.04.47;	author jont;	state Exp;
branches;
next	1.33;

1.33
date	96.06.20.16.20.23;	author brianm;	state Exp;
branches;
next	1.32;

1.32
date	96.06.14.13.10.49;	author jont;	state Exp;
branches;
next	1.31;

1.31
date	96.06.07.12.52.00;	author jont;	state Exp;
branches;
next	1.30;

1.30
date	96.06.06.15.30.29;	author jont;	state Exp;
branches;
next	1.29;

1.29
date	96.06.06.14.47.49;	author jont;	state Exp;
branches;
next	1.28;

1.28
date	96.06.06.11.48.56;	author jont;	state Exp;
branches;
next	1.27;

1.27
date	96.05.16.16.23.08;	author jont;	state Exp;
branches;
next	1.26;

1.26
date	96.05.02.17.31.44;	author jont;	state Exp;
branches;
next	1.25;

1.25
date	96.04.25.11.46.43;	author jont;	state Exp;
branches;
next	1.24;

1.24
date	96.04.23.10.45.24;	author jont;	state Exp;
branches;
next	1.23;

1.23
date	96.04.18.17.22.48;	author jont;	state Exp;
branches;
next	1.22;

1.22
date	96.04.11.11.17.31;	author stephenb;	state Exp;
branches;
next	1.21;

1.21
date	96.04.11.11.07.42;	author jont;	state Exp;
branches;
next	1.20;

1.20
date	96.03.08.15.14.06;	author jont;	state Exp;
branches;
next	1.19;

1.19
date	96.03.01.16.38.25;	author jont;	state Exp;
branches;
next	1.18;

1.18
date	96.02.28.17.37.28;	author jont;	state Exp;
branches;
next	1.17;

1.17
date	96.01.24.11.28.16;	author jont;	state Exp;
branches;
next	1.16;

1.16
date	96.01.18.16.33.58;	author stephenb;	state Exp;
branches;
next	1.15;

1.15
date	95.05.10.18.13.12;	author daveb;	state Exp;
branches;
next	1.14;

1.14
date	95.05.04.12.49.10;	author jont;	state Exp;
branches;
next	1.13;

1.13
date	95.05.03.11.09.25;	author jont;	state Exp;
branches;
next	1.12;

1.12
date	95.02.24.17.01.19;	author jont;	state Exp;
branches;
next	1.11;

1.11
date	95.02.24.15.57.17;	author jont;	state Exp;
branches;
next	1.10;

1.10
date	94.08.15.10.51.26;	author daveb;	state Exp;
branches;
next	1.9;

1.9
date	94.04.07.14.47.31;	author daveb;	state Exp;
branches;
next	1.8;

1.8
date	94.03.01.15.07.54;	author daveb;	state Exp;
branches;
next	1.7;

1.7
date	94.03.01.14.44.01;	author daveb;	state Exp;
branches;
next	1.6;

1.6
date	94.01.28.18.32.18;	author daveb;	state Exp;
branches;
next	1.5;

1.5
date	94.01.28.17.34.33;	author daveb;	state Exp;
branches;
next	1.4;

1.4
date	93.09.28.10.53.22;	author daveb;	state Exp;
branches;
next	1.3;

1.3
date	93.09.01.15.46.11;	author jont;	state Exp;
branches
	1.3.1.1;
next	1.2;

1.2
date	93.08.12.14.32.43;	author jont;	state Exp;
branches;
next	1.1;

1.1
date	93.05.12.14.40.55;	author richard;	state Exp;
branches;
next	;

1.3.1.1
date	93.09.01.15.46.11;	author jont;	state Exp;
branches;
next	1.3.1.2;

1.3.1.2
date	93.09.27.18.42.21;	author daveb;	state Exp;
branches;
next	;

1.37.1.1
date	96.09.13.11.08.13;	author hope;	state Exp;
branches;
next	;

1.37.2.1
date	96.10.07.15.59.24;	author hope;	state Exp;
branches;
next	;

1.37.3.1
date	96.10.17.11.17.45;	author hope;	state Exp;
branches;
next	;

1.44.1.1
date	96.11.14.12.41.16;	author hope;	state Exp;
branches
	1.44.1.1.1.1;
next	;

1.44.1.1.1.1
date	96.11.28.14.53.11;	author hope;	state Exp;
branches;
next	;

1.45.1.1
date	96.11.22.18.01.43;	author hope;	state Exp;
branches;
next	;

1.46.1.1
date	96.12.17.17.40.39;	author hope;	state Exp;
branches
	1.46.1.1.1.1;
next	;

1.46.1.1.1.1
date	97.02.24.11.28.16;	author hope;	state Exp;
branches;
next	;

1.46.2.1
date	96.12.18.09.34.33;	author hope;	state Exp;
branches;
next	;

1.51.1.1
date	97.05.12.10.26.33;	author hope;	state Exp;
branches;
next	1.51.1.2;

1.51.1.2
date	97.05.15.13.56.59;	author daveb;	state Exp;
branches;
next	1.51.1.3;

1.51.1.3
date	97.05.20.09.51.07;	author daveb;	state Exp;
branches;
next	1.51.1.4;

1.51.1.4
date	97.06.11.10.27.35;	author daveb;	state Exp;
branches;
next	1.51.1.5;

1.51.1.5
date	97.06.11.18.41.07;	author daveb;	state Exp;
branches
	1.51.1.5.1.1
	1.51.1.5.2.1
	1.51.1.5.3.1;
next	;

1.51.1.5.1.1
date	97.07.28.18.12.33;	author daveb;	state Exp;
branches;
next	1.51.1.5.1.2;

1.51.1.5.1.2
date	97.08.04.11.11.18;	author daveb;	state Exp;
branches;
next	1.51.1.5.1.3;

1.51.1.5.1.3
date	97.08.20.14.14.43;	author daveb;	state Exp;
branches
	1.51.1.5.1.3.1.1;
next	;

1.51.1.5.1.3.1.1
date	97.10.07.11.37.31;	author jkbrook;	state Exp;
branches;
next	;

1.51.1.5.2.1
date	97.09.08.17.05.49;	author daveb;	state Exp;
branches;
next	;

1.51.1.5.3.1
date	97.09.09.14.01.13;	author daveb;	state Exp;
branches;
next	;

1.56.1.1
date	97.09.10.19.15.40;	author brucem;	state Exp;
branches;
next	;

1.56.2.1
date	97.09.11.20.45.18;	author daveb;	state Exp;
branches;
next	;

1.81.1.1
date	99.04.01.17.51.23;	author daveb;	state Exp;
branches;
next	;


desc
@MLWORKS SOURCE MAKEFILE
@


1.81
log
@Replace incorrect uses of /$(ARCH)/$(OS) by /$(ARCH_OS)
@
text
@#	==== MLWORKS SOURCE MAKEFILE ==== 
# 
# Revision Log
# ------------
# $Log: Makefile,v $
# Revision 1.80  1999/03/18  12:17:45  johnh
# [Bug #190530]
# copy correct mutex mos (without batch precompiled).
#
# Revision 1.79  1999/03/17  17:39:20  johnh
# [Bug #190529]
# distribute FI stub generator
#
# Revision 1.78  1999/03/17  10:18:38  mitchell
# [Bug #190526]
# Abel doesn't understand touch --reference=file so use -r file instead
#
# Revision 1.77  1999/03/16  12:53:20  mitchell
# [Bug #190526]
# Move dependency files below the configuration subdirectory
#
# Revision 1.76  1999/03/15  14:21:54  johnh
# [Bug #190506]
# Copy correct gui mos into distribution.
#
# Revision 1.75  1999/03/13  13:19:26  mitchell
# [Bug #190526]
# Preserve file mod times when removing logs
#
# Revision 1.73  1999/03/12  11:41:11  johnh
# [Bug #190506]
# Remove old FI.
#
# Revision 1.72  1998/08/19  11:35:16  johnh
# [Bug #30472]
# Copy gui project file into distribution from scripts.
#
# Revision 1.71  1998/06/18  16:19:55  johnh
# [Bug #30425]
# Distribute basis project file.
#
# Revision 1.70  1998/06/18  14:29:51  jkbrook
# [Bug #50082]
# Make InstallShield source files writable so that they can
# be moved so as to avoid distributing them to users
#
# Revision 1.69  1998/05/11  16:44:07  jkbrook
# [Bug #50079]
# Fix copying of objects into distribution directory on Win95
#
# Revision 1.68  1998/05/05  18:55:43  jkbrook
# [Bug #30354]
# Temporarily restore old FI to distribution
#
# Revision 1.67  1998/05/05  17:56:54  io
# [Bug #50079]
# enable ARCH_OS for building shared distributions with NT mos and 95 runtimes
#
# Revision 1.66  1998/04/01  12:25:19  jont
# [Bug #70086]
# *windows has moved to *windows_gui
#
# Revision 1.65  1998/03/26  14:38:05  jkbrook
# [Bug #30362]
# Objects should be in objects/ARCH/OS/MODE
#
# Revision 1.64  1998/03/26  12:07:51  jkbrook
# [Bug #30374]
# {__}terminal.mo should be included in the distribution
#
# Revision 1.63  1998/03/20  20:35:33  jkbrook
# [Bug #30362]
# Need to copy object files from Mode subdirectory into distribution
#
# Revision 1.62  1998/02/16  17:25:05  jkbrook
# [Bug #30363]
# Change distribution directory structure to reflect flat object namespace
#
# Revision 1.61  1998/01/13  18:21:46  jkbrook
# [Bug #30306]
# Removing incomplete FI from 2.0m2 distribution
#
# Revision 1.60  1997/11/24  13:58:10  daveb
# [Bug #30304]
# Removed special treatment of SML90 files, as these are now part of the
# Basis Library.
#
# Revision 1.59  1997/10/10  09:52:00  daveb
# [Bug #20090]
# No longer need to call set_sml_time on object files.
#
# Revision 1.58  1997/10/01  14:33:56  jkbrook
# [Bug #50021]
# Merging from MLWorks_11:
# Make utils signatures read-only.
#
# Revision 1.57  1997/09/29  17:19:37  jkbrook
# [Bug #30153]
# Distribution must refer to sml90 instead of old
#
# Revision 1.56  1997/07/23  12:52:32  jont
# [Bug #20096]
# Ensure old MANIFEST files removed before moving in new one
#
# Revision 1.55  1997/07/01  14:10:48  stephenb
# [Bug #30029]
# The MLWorks<->C interface has grown.  Replace {__,}c.sml with
# {__,}mlworks_c_interface, {__,}mlworks_c_io, {__,}mlworks_dynamic_library,
# {__,}mlworks_c_resource and {_,}mlworks_c_pointer.sml
#
# Revision 1.54  1997/06/13  17:26:37  jkbrook
# [Bug #30149]
# Merging in changes from 1.0r2c2 into 2.0m0:
# On Windows, copy setup.rul and setup.lst to the distribution directory.
#
#
# Revision 1.53  1997/05/21  12:07:05  stephenb
# [Bug #30121]
# Move to new FI: update distribution mechanism to distribute
# the new FI rather than the old one.
#
# Revision 1.52  1997/05/15  12:37:24  daveb
# [Bug #30117]
# Copied foreign/samples/Win32/README to the distribution.
#
# Revision 1.51  1997/04/07  12:25:15  jont
# Set time stamps on object files explicitly, since cp -p
# seems to be failing under Win32
#
# Revision 1.50  1997/04/03  17:09:20  daveb
# Fixed mistake in previous change.
#
# Revision 1.49  1997/04/03  13:42:40  andreww
# [Bug #2016]
# adding mutexes to utils directory
#
# Revision 1.48  1997/01/09  14:44:58  jont
# [Bug #1845]
# Tidying up, and stuff to do with getting permissions
# correct in distribution so installer doesn't have to do it
#
# Revision 1.47  1997/01/08  16:11:23  jont
# [Bug #1816]
# Modify for use with beta-17 gnu tools
#
# Revision 1.46  1996/12/04  14:30:22  jont
# [Bug #0]
# Ensure .sml files are timestamp preserved when placed in distribution
#
# Revision 1.45  1996/11/19  17:30:51  jont
# Problem with add_copyright somewhere
#
# Revision 1.44  1996/11/13  18:08:04  jont
# [Bug #1762]
# Distribute basis/{,__}old.mo
#
# Revision 1.43  1996/11/13  10:52:55  daveb
# Added foreign/samples/$(PLATFORM)/README to distribution.
#
# Revision 1.42  1996/11/08  18:15:25  jont
# [Bug #1748]
# Run remove_log on distributed foreign sample files
#
# Revision 1.41  1996/11/08  16:53:03  jont
# [Bug #1747]
# Ensure only required stuff from foreign samples is distributed
#
# Revision 1.40  1996/11/07  15:44:13  andreww
# [Bug #1741]
# Removing foreign/samples/Unix/regexp.* from distribution.
#
# Revision 1.39  1996/11/06  11:30:24  jont
# Ensure only one Makefile distributed for foreign samples on unix
#
# Revision 1.38  1996/11/06  11:03:50  jont
# Remove spurious $/ in various shell lines
#
# Revision 1.37  1996/08/29  16:51:49  jont
# Fix problems of pervasive files losing timestamps on Win95 and NT
# when making distribution
#
# Revision 1.36  1996/08/22  10:45:05  jont
# Modify entry to demo directory to work better on NT and Win95
#
# Revision 1.35  1996/08/19  13:33:37  daveb
# Added call to make demos.
#
# Revision 1.34  1996/06/27  13:04:47  jont
# Change DESTDIR to DISTDIR
#
# Revision 1.33  1996/06/20  16:20:23  brianm
# Adding platform specific (Unix/Win32) foreign samples ...
#
# Revision 1.32  1996/06/14  13:10:49  jont
# Sort out problems on NT
#
# Revision 1.31  1996/06/07  12:52:00  jont
# Ensure all files and directories are made readable
#
# Revision 1.30  1996/06/06  15:30:29  jont
# Fix minor bungle when adding basis files to distribution
#
# Revision 1.29  1996/06/06  14:47:49  jont
# Add foreign samples to the distribution
#
# Revision 1.28  1996/06/06  11:48:56  jont
# Add stuff to put basis signatures in the distribution
#
# Revision 1.27  1996/05/16  16:23:08  jont
# Tidy up, add foreign to distribution
#
# Revision 1.26  1996/05/02  17:31:44  jont
# Get the basis files from the make process on images
#
# Revision 1.25  1996/04/25  11:46:43  jont
# Change maths to math
#
# Revision 1.24  1996/04/23  10:45:24  jont
# Tidying up for Win95 and NT distributions
#
# Revision 1.23  1996/04/18  17:22:48  jont
# initbasis becomes basis
#
# Revision 1.22  1996/04/11  11:17:31  stephenb
# Updated wrt process -> os_process name change in initbasis.
#
# Revision 1.21  1996/04/11  11:07:42  jont
# Modifications to file list for distribution
#
# Revision 1.20  1996/03/08  15:14:06  jont
# More distribution work
#
# Revision 1.19  1996/03/01  16:38:25  jont
# More changes to get distributions working under NT
#
# Revision 1.18  1996/02/28  17:37:28  jont
# Modifications to allow distributions to be built for NT and Win95
#
# Revision 1.17  1996/01/24  11:28:16  jont
# Move xm files into motif
#
# Revision 1.16  1996/01/18  16:33:58  stephenb
# OS reorganisation: add the UNIX/NT specific files that have
# been moved from the pervasive library.
#
# Revision 1.15  1995/05/10  18:13:12  daveb
# Added new files to the initial basis.
#
# Revision 1.14  1995/05/04  12:49:10  jont
# Add pervasive object files in architecture specific place
# Also add initial basis and xm library
#
# Revision 1.13  1995/05/03  11:09:25  jont
# Ensure ARCH and OS passed to emacs/etc make
#
# Revision 1.12  1995/02/24  17:01:19  jont
# Make image building for distribution OS and architecture specific
#
# Revision 1.11  1995/02/24  15:57:17  jont
# Modify for new /u directory structure
#
# Revision 1.10  1994/08/15  10:51:26  daveb
# Updated distribution command for new runtime organisation.
#
# Revision 1.9  1994/04/07  14:47:31  daveb
# Now removes DISTDIR/edlib before copying new edlib.
#
# Revision 1.8  1994/03/01  15:07:54  daveb
# Moving edlib source out of MLW directory.
#
# Revision 1.7  1994/03/01  14:44:01  daveb
# Added Edinburgh Library to distribution.
#
# Revision 1.6  1994/01/28  18:32:18  daveb
# Changed the src directory, instead of the root directory.  Ho hum.
#
# Revision 1.5  1994/01/28  17:34:33  daveb
# Changed location of src directory.
#
# Revision 1.4  1993/09/28  10:53:22  daveb
# Merged in bug fix.
#
# Revision 1.3.1.2  1993/09/27  18:42:21  daveb
# Ensure that target directory exists.  Added Makefiles for emacs/lisp &
# app-defaults directories.  Copy across pervasive .mo files, and finally
# create a MANIFEST.
#
# Revision 1.3.1.1  1993/09/01  15:46:11  jont
# Fork for bug fixing
#
# Revision 1.3  1993/09/01  15:46:11  jont
# Ensured scripts and man copied into distribution
#
# Revision 1.2  1993/08/12  14:32:43  jont
# Changed to remove lib/emacs/lisp/*.el before copying to avoid errors
#
# Revision 1.1  1993/05/12  14:40:55  richard
# Initial revision
#

chmod_exec=chmod 775
chmod_non_exec=chmod 664
chmod_read_only=chmod 444
remove_log	= ../tools/remove_log.sh

ifeq "$(OS)" "NT"
NTTYPE=TRUE
else
ifeq "$(OS)" "Win95"
NTTYPE=TRUE
else
NTTYPE=FALSE
endif
endif
SML_HOME	= /u/sml
ifeq "$(NTTYPE)" "TRUE"
SRC		= $(SML_HOME)/MLW/src
DISTDIR		= $(SML_HOME)/distribution
COUTALL		= $(SML_HOME)/tools/coutall
RM		= rm -rf
CP		= cp -p
TOUCH		= touch
MKDIR		= mkdir -p
PLATFORM	= Win32
else
SRC		= $(SML_HOME)/MLW/src
DISTDIR		= $(SML_HOME)/distribution
COUTALL		= $(SML_HOME)/tools/coutall
RM		= /bin/rm -rf
CP		= /bin/cp -p
LN		= /bin/ln
MKDIR		= /bin/mkdir
FIND		= /bin/find
TOUCH		= /bin/touch
PLATFORM	= Unix
endif

TERMINAL =      utils/terminal \
                utils/__terminal

XM = 		$(TERMINAL) motif/xm \
		motif/_xm \
		motif/__xm

WIN = 		$(TERMINAL) winsys/windows_gui \
		winsys/_windows_gui \
		winsys/__windows_gui

XMMO =		$(XM:%=%.mo)
XMSML =		$(XM:%=%.sml)
WINMO =		$(WIN:%=%.mo)
WINSML =	$(WIN:%=%.sml)

UTILS = 	utils/mutex \
		utils/__mutex

UTILSMO =	$(UTILS:%=%.mo)
UTILSML =	$(UTILS:%=%.sml)

ifeq "$(NTTYPE)" "TRUE"
FOREIGN_EG =	foreign/registry_spec.sml
else
FOREIGN_EG =    foreign/ndbm_fi_spec.sml
endif

FOREIGN = 	$(FOREIGN_EG) foreign/stub_gen.sml \
		foreign/__stub_gen_input.sml \
		foreign/mlworks_c_pointer.sml \
		foreign/mlworks_c_interface.sml \
		foreign/mlworks_c_resource.sml \
		foreign/mlworks_dynamic_library.sml \
		foreign/mlworks_c_io.sml

all:
	@@echo Make all does nothing here

check-out:
	cd .. && $(COUTALL)

distribution: $(DISTDIR)/touch

$(DISTDIR)/touch:
ifdef OS
ifdef ARCH
	-$(MKDIR) $(DISTDIR) $(DISTDIR)/objects $(DISTDIR)/objects/$(ARCH) $(DISTDIR)/objects/$(ARCH)/$(OS) $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND $(DISTDIR)/objects/$(ARCH)/$(OS)/Release
	-$(chmod_exec) $(DISTDIR)
	(cd rts && $(MAKE) -e ARCH=$(ARCH) OS=$(OS) DISTDIR=$(DISTDIR) distribution)
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files foreign-files)
ifeq "$(NTTYPE)" "TRUE"
else
	(cd emacs/etc && $(MAKE) ARCH=$(ARCH) OS=$(OS) DISTDIR=$(DISTDIR) distribution)
	(cd emacs/lisp && $(MAKE) DISTDIR=$(DISTDIR) distribution)
	(cd app-defaults && $(MAKE) DISTDIR=$(DISTDIR) distribution)
endif
	(cd .. && cd demo && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution)
	(cd scripts && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution)
	cd $(DISTDIR) && $(RM) pervasive/$(ARCH)/$(OS)
	-$(MKDIR) $(DISTDIR)/pervasive $(DISTDIR)/pervasive/$(ARCH) $(DISTDIR)/pervasive/$(ARCH)/$(OS) $(DISTDIR)/pervasive/$(ARCH)/$(OS)/DEPEND 
	-$(chmod_exec) $(DISTDIR)/pervasive $(DISTDIR)/pervasive/$(ARCH) $(DISTDIR)/pervasive/$(ARCH)/$(OS)
	for x in __pervasive_library __builtin_library; do $(CP) pervasive/$$x.mo $(DISTDIR)/pervasive/$(ARCH)/$(OS)/$$x.mo; $(CP) pervasive/DEPEND/$$x.sml $(DISTDIR)/pervasive/$(ARCH)/$(OS)/DEPEND/$$x.sml; done
	cd $(DISTDIR) && $(RM) basis foreign
ifeq "$(NTTYPE)" "TRUE"
	cd $(DISTDIR) && $(RM) winsys
	cd $(DISTDIR) && $(RM) win_nt/$(ARCH)/$(OS)
	cd $(DISTDIR) && $(RM) mswindows/$(ARCH)/$(OS)
else
	$(RM) $(DISTDIR)/motif/$(ARCH)/$(OS)
	$(RM) $(DISTDIR)/unix/$(ARCH)/$(OS)
	$(RM) $(DISTDIR)/motif/*.sml
endif
	cd $(DISTDIR) && $(RM) utils/$(ARCH)/$(OS)
	-$(MKDIR) $(DISTDIR)/basis $(DISTDIR)/basis/$(ARCH) $(DISTDIR)/basis/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/basis $(DISTDIR)/basis/$(ARCH) $(DISTDIR)/basis/$(ARCH)/$(OS)
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/examples/foreign
	-$(MKDIR) $(DISTDIR)/utils $(DISTDIR)/utils/$(ARCH) $(DISTDIR)/utils/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/utils $(DISTDIR)/utils/$(ARCH) $(DISTDIR)/utils/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/foreign $(DISTDIR)/examples/foreign
ifeq "$(NTTYPE)" "TRUE"
	-$(MKDIR) $(DISTDIR)/winsys $(DISTDIR)/winsys/$(ARCH) $(DISTDIR)/winsys/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/winsys $(DISTDIR)/winsys/$(ARCH) $(DISTDIR)/winsys/$(ARCH)/$(OS)
else
	-$(MKDIR) $(DISTDIR)/motif $(DISTDIR)/motif/$(ARCH) $(DISTDIR)/motif/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/motif $(DISTDIR)/motif/$(ARCH) $(DISTDIR)/motif/$(ARCH)/$(OS)
endif
	(cd scripts && $(CP) basis-inst.mlp $(DISTDIR)/basis/basis.mlp)
ifeq "$(NTTYPE)" "TRUE"
	for x in $(WINSML); do $(CP) mswindows/objects/$(ARCH_OS)/DEPEND/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/`basename $$x`; done
	for x in $(WINMO); do $(CP) mswindows/objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
	for x in mswindows/windows_gui.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/winsys/`basename $$x`; done
	for x in mswindows/windows_gui.sml; do $(TOUCH) -r $$x $(DISTDIR)/winsys/`basename $$x`; done
	$(CP) scripts/mswindows-gui.mlp $(DISTDIR)/winsys/gui.mlp
else
	for x in $(XMSML); do $(CP) motif/objects/$(ARCH_OS)/DEPEND/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/`basename $$x`; done
	for x in $(XMMO); do $(CP) motif/objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
	for x in motif/xm.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/motif/`basename $$x`; done
	for x in motif/xm.sml; do $(TOUCH) -r $$x $(DISTDIR)/motif/`basename $$x`; done
	$(CP) scripts/motif-gui.mlp $(DISTDIR)/motif/gui.mlp
endif
	perl -pe "s?../../../??g;print;" images/$(ARCH_OS)/basis-files > poo
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
	for x in basis/[a-z]*.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/basis/`basename $$x`; done
	for x in basis/[a-z]*.sml; do $(TOUCH) -r $$x $(DISTDIR)/basis/`basename $$x`; done
	perl -pe "s?../../../../objects/$(ARCH_OS)/Release/??g;print;" images/$(ARCH_OS)/basis-files > poo
	perl -pe "s?\.mo?\.sml?g;print;" poo > poo1
	for x in `cat poo1`; do $(CP) ../objects/$(ARCH_OS)/DEPEND/$$x $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/$$x; done

	for x in $(UTILSML); do $(CP) utils/objects/$(ARCH_OS)/DEPEND/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/`basename $$x`; done
	for x in $(UTILSMO); do $(CP) utils/objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
	for x in utils/mutex.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/utils/`basename $$x`; done
	for x in utils/mutex.sml; do $(TOUCH) -r $$x $(DISTDIR)/utils/`basename $$x`; done

	for x in $(FOREIGN); do ../tools/add_copyright.sh $$x > $(DISTDIR)/foreign/`basename $$x`; done
	for x in $(FOREIGN); do $(TOUCH) -r $$x $(DISTDIR)/foreign/`basename $$x`; done
	$(CP) rts/src/mlw_ci.h $(DISTDIR)/foreign/mlw_ci.h

	perl -pe "s?../../../../objects/$(ARCH_OS)/Release/??g;print;" images/$(ARCH_OS)/foreign-files > poo
	perl -pe "s?\.mo?\.sml?g;print;" poo > poo1
	for x in `cat poo1`; do $(CP) ../objects/$(ARCH_OS)/DEPEND/$$x $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/$$x; done

	(cd ../demo/foreign && sh dist_foreign_files.sh $(DISTDIR)/examples/foreign $(OS) $(ARCH))
	(cd scripts && sh make_foreign_mlp.sh $(DISTDIR) $(ARCH_OS))
	perl -pe "s?../../../??g;print" images/$(ARCH)/$(OS)/foreign-files > poo
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done

	-$(RM) poo
	-$(RM) poo1
ifeq "$(NTTYPE)" "TRUE"
	cp ../tools/setup.rul ../tools/setup.lst $(DISTDIR)
else
	-$(RM) $(DISTDIR)/MANIFEST
	(cd $(DISTDIR) && ls -lR > /tmp/MANIFEST && mv /tmp/MANIFEST $(DISTDIR) && $(chmod_read_only) $(DISTDIR)/MANIFEST)
endif
	$(chmod_exec) $(DISTDIR)/bin $(DISTDIR)/bin/$(ARCH) $(DISTDIR)/bin/$(ARCH)/$(OS)
	$(chmod_exec) $(DISTDIR)/images $(DISTDIR)/images/$(ARCH) $(DISTDIR)/images/$(ARCH)/$(OS)
	$(chmod_exec) $(DISTDIR)/scripts
	$(chmod_read_only) $(DISTDIR)/basis/*.sml 
	$(chmod_read_only) $(DISTDIR)/foreign/*.sml

	$(chmod_read_only) $(DISTDIR)/pervasive/$(ARCH)/$(OS)/*.mo
	$(chmod_read_only) $(DISTDIR)/utils/*.sml 
	$(chmod_read_only) $(DISTDIR)/images/$(ARCH)/$(OS)/*
	$(chmod_read_only) $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/*.mo
ifeq "$(NTTYPE)" "TRUE"
	$(chmod_read_only) $(DISTDIR)/winsys/*.sml 
	$(chmod_exec) $(DISTDIR)/setup.rul $(DISTDIR)/setup.lst
else
	$(chmod_exec) $(DISTDIR)/env
	$(chmod_exec) $(DISTDIR)/man $(DISTDIR)/man/man1
	$(chmod_exec) $(DISTDIR)/lib $(DISTDIR)/lib/emacs $(DISTDIR)/lib/emacs $(DISTDIR)/lib/emacs/etc $(DISTDIR)/lib/emacs/lisp $(DISTDIR)/lib/emacs/etc/$(ARCH) $(DISTDIR)/lib/emacs/etc/$(ARCH)/$(OS) $(DISTDIR)/lib/emacs/etc/$(ARCH)/$(OS)/*
	$(chmod_exec) $(DISTDIR)/lib/X11 $(DISTDIR)/lib/X11/app-defaults $(DISTDIR)/lib/X11/bitmaps
	$(chmod_read_only) $(DISTDIR)/lib/X11/app-defaults/*  $(DISTDIR)/lib/X11/bitmaps/*
	$(chmod_read_only) $(DISTDIR)/motif/*.sml 
	$(chmod_read_only) $(DISTDIR)/lib/emacs/lisp/*
endif
else
	@@echo Cannot make distribution, ARCH not set
	exit 1
endif
else
	@@echo Cannot make distribution, OS not set
	exit 1
endif

force:
@


1.81.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a5 3
# Revision 1.81  1999/03/20  12:55:47  mitchell
# Replace incorrect uses of /$(ARCH)/$(OS) by /$(ARCH_OS)
#
@


1.80
log
@[Bug #190530]
copy correct mutex mos (without batch precompiled).
@
text
@d6 4
d443 1
a443 1
	perl -pe "s?../../../../objects/$(ARCH)/$(OS)/Release/??g;print;" images/$(ARCH_OS)/basis-files > poo
d445 1
a445 1
	for x in `cat poo1`; do $(CP) ../objects/$(ARCH)/$(OS)/DEPEND/$$x $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/$$x; done
d456 1
a456 1
	perl -pe "s?../../../../objects/$(ARCH)/$(OS)/Release/??g;print;" images/$(ARCH_OS)/foreign-files > poo
d458 1
a458 1
	for x in `cat poo1`; do $(CP) ../objects/$(ARCH)/$(OS)/DEPEND/$$x $(DISTDIR)/objects/$(ARCH)/$(OS)/DEPEND/$$x; done
@


1.79
log
@[Bug #190529]
distribute FI stub generator
@
text
@d6 4
d350 5
a354 3
UTILSMO =	utils/mutex.mo \
		utils/__mutex.mo
UTILSML =	utils/mutex.sml
d443 4
a446 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
a459 3

	for x in $(UTILSML); do ../tools/add_copyright.sh $$x > $(DISTDIR)/utils/`basename $$x`; done
	for x in $(UTILSML); do $(TOUCH) -r $$x $(DISTDIR)/utils/`basename $$x`; done
@


1.78
log
@[Bug #190526]
Abel doesn't understand touch --reference=file so use -r file instead
@
text
@d6 4
d350 8
a357 1
FOREIGN = 	rts/src/mlw_ci.h \
d390 1
a390 2
	$(CP) pervasive/*.mo $(DISTDIR)/pervasive/$(ARCH)/$(OS)
	$(CP) pervasive/DEPEND/* $(DISTDIR)/pervasive/$(ARCH)/$(OS)/DEPEND
a435 1
	cd $(DISTDIR) && rm basis/require_all.sml
d441 6
@


1.77
log
@[Bug #190526]
Move dependency files below the configuration subdirectory
@
text
@d6 4
d410 1
a410 1
	for x in mswindows/windows_gui.sml; do $(TOUCH) --reference=$$x $(DISTDIR)/winsys/`basename $$x`; done
d416 1
a416 1
	for x in motif/xm.sml; do $(TOUCH) --reference=$$x $(DISTDIR)/motif/`basename $$x`; done
d422 1
a422 1
	for x in basis/[a-z]*.sml; do $(TOUCH) --reference=$$x $(DISTDIR)/basis/`basename $$x`; done
d431 1
a431 1
	for x in $(FOREIGN); do $(TOUCH) --reference=$$x $(DISTDIR)/foreign/`basename $$x`; done
d438 1
a438 1
	for x in $(UTILSML); do $(TOUCH) --reference=$$x $(DISTDIR)/utils/`basename $$x`; done
@


1.76
log
@[Bug #190506]
Copy correct gui mos into distribution.
@
text
@d6 4
d360 1
a360 1
	-$(MKDIR) $(DISTDIR) $(DISTDIR)/objects $(DISTDIR)/objects/DEPEND $(DISTDIR)/objects/$(ARCH) $(DISTDIR)/objects/$(ARCH)/$(OS) $(DISTDIR)/objects/$(ARCH)/$(OS)/Release
d373 1
a373 1
	-$(MKDIR) $(DISTDIR)/pervasive $(DISTDIR)/pervasive/DEPEND $(DISTDIR)/pervasive/$(ARCH) $(DISTDIR)/pervasive/$(ARCH)/$(OS)
d376 1
a376 1
	$(CP) pervasive/DEPEND/* $(DISTDIR)/pervasive/DEPEND
d403 1
a403 1
	for x in $(WINSML); do $(CP) mswindows/objects/DEPEND/`basename $$x` $(DISTDIR)/objects/DEPEND/`basename $$x`; done
d409 1
a409 1
	for x in $(XMSML); do $(CP) motif/objects/DEPEND/`basename $$x` $(DISTDIR)/objects/DEPEND/`basename $$x`; done
d421 1
a421 1
	for x in `cat poo1`; do $(CP) ../objects/DEPEND/$$x $(DISTDIR)/objects/DEPEND/$$x; done
@


1.75
log
@[Bug #190526]
Preserve file mod times when removing logs
@
text
@d6 4
d399 2
a400 2
	for x in $(WINSML); do $(CP) ../objects/DEPEND/`basename $$x` $(DISTDIR)/objects/DEPEND/`basename $$x`; done
	for x in $(WINMO); do $(CP) ../objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
d405 2
a406 2
	for x in $(XMSML); do $(CP) ../objects/DEPEND/`basename $$x` $(DISTDIR)/objects/DEPEND/`basename $$x`; done
	for x in $(XMMO); do $(CP) ../objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
@


1.74
log
@[Bug #190526]
Move precis files to distribution
@
text
@d298 1
d326 1
d328 1
d395 1
d398 1
d401 1
d404 1
d409 2
a413 1
	for x in basis/[a-z]*.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/basis/`basename $$x`; done
d419 1
d426 1
@


1.73
log
@[Bug #190506]
Remove old FI.
@
text
@d6 4
d349 1
a349 1
	-$(MKDIR) $(DISTDIR) $(DISTDIR)/objects $(DISTDIR)/objects/$(ARCH) $(DISTDIR)/objects/$(ARCH)/$(OS) $(DISTDIR)/objects/$(ARCH)/$(OS)/Release
d362 1
a362 1
	-$(MKDIR) $(DISTDIR)/pervasive $(DISTDIR)/pervasive/$(ARCH) $(DISTDIR)/pervasive/$(ARCH)/$(OS)
d365 1
d402 3
d419 1
@


1.72
log
@[Bug #30472]
Copy gui project file into distribution from scripts.
@
text
@d6 4
d327 7
d374 1
a374 2
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/foreign/samples
	-$(chmod_exec) $(DISTDIR)/foreign/samples
d377 1
d402 3
a409 12
	for x in foreign/interface.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/foreign/`basename $$x`; done
	for x in foreign/interface.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/foreign/`basename $$x`; done
ifeq "$(NTTYPE)" "TRUE"
	for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/README foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c foreign/samples/$(PLATFORM)/foreign_samples.mlp ; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
	mv $(DISTDIR)/foreign/samples/README $(DISTDIR)/foreign/samples/README.TXT
else
	for x in foreign/samples/$(PLATFORM)/Makefile.$(OS) foreign/samples/$(PLATFORM)/README foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c foreign/samples/$(PLATFORM)/foreign_samples.mlp; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
	mv $(DISTDIR)/foreign/samples/Makefile.$(OS) $(DISTDIR)/foreign/samples/Makefile
	rm $(DISTDIR)/foreign/samples/regexp.*
endif
	$(chmod_non_exec) $(DISTDIR)/foreign/samples/*

d421 1
a421 1
	$(chmod_read_only) $(DISTDIR)/foreign/*.sml $(DISTDIR)/foreign/samples/*
@


1.71
log
@[Bug #30425]
Distribute basis project file.
@
text
@d6 4
d378 1
d382 1
@


1.70
log
@[Bug #50082]
Make InstallShield source files writable so that they can
be moved so as to avoid distributing them to users
@
text
@d6 5
d370 1
@


1.69
log
@[Bug #50079]
Fix copying of objects into distribution directory on Win95
@
text
@d6 4
d415 1
a415 1
	$(chmod_read_only) $(DISTDIR)/setup.rul $(DISTDIR)/setup.lst
@


1.68
log
@[Bug #30354]
Temporarily restore old FI to distribution
@
text
@d6 4
d373 1
a373 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH_OS)/Release/`basename $$x`; done
d376 1
a376 1
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/objects/$(ARCH_OS)/Release/`basename $$x`; done
@


1.67
log
@[Bug #50079]
enable ARCH_OS for building shared distributions with NT mos and 95 runtimes
@
text
@d1 2
a2 2
#	==== MLWORKS SOURCE MAKEFILE ====
#
d6 4
d320 1
a320 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files)
d333 1
a333 1
	cd $(DISTDIR) && $(RM) basis 
d346 2
d368 6
a373 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH_OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
d375 13
d399 2
@


1.66
log
@[Bug #70086]
*windows has moved to *windows_gui
@
text
@d6 4
d269 1
a269 1
MKDIR		= mkdir
d352 1
a352 1
	for x in $(WINMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
d355 1
a355 1
	for x in $(XMMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
d358 1
a358 1
	perl -pe "s?../../../??g;print;" images/$(ARCH)/$(OS)/basis-files > poo
d362 1
a362 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/Release/`basename $$x`; done
@


1.65
log
@[Bug #30362]
Objects should be in objects/ARCH/OS/MODE
@
text
@d6 4
d287 3
a289 3
WIN = 		$(TERMINAL) winsys/windows \
		winsys/_windows \
		winsys/__windows
d349 1
a349 1
	for x in mswindows/windows.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/winsys/`basename $$x`; done
@


1.64
log
@[Bug #30374]
{__}terminal.mo should be included in the distribution
@
text
@d6 4
d305 1
a305 1
	-$(MKDIR) $(DISTDIR) $(DISTDIR)/objects $(DISTDIR)/objects/$(ARCH) $(DISTDIR)/objects/$(ARCH)/$(OS)
d344 1
a344 1
	for x in $(WINMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
d347 1
a347 1
	for x in $(XMMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
d351 1
a351 1
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
d354 1
a354 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH)/$(OS)/Release/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
d370 1
a370 1
	$(chmod_read_only) $(DISTDIR)/objects/$(ARCH)/$(OS)/*.mo
@


1.63
log
@[Bug #30362]
Need to copy object files from Mode subdirectory into distribution
@
text
@d6 4
d272 4
a275 1
XM = 		motif/xm \
d279 1
a279 1
WIN = 		winsys/windows \
@


1.62
log
@[Bug #30363]
Change distribution directory structure to reflect flat object namespace
@
text
@d6 4
d333 1
a333 1
	for x in $(WINMO); do $(CP) $$x ../objects/$(ARCH)/$(OS)/`basename $$x`; done
d336 1
a336 1
	for x in $(XMMO); do $(CP) ../objects/$(ARCH)/$(OS)/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
d343 1
a343 1
	for x in $(UTILSMO); do $(CP) ../objects/$(ARCH)/$(OS)/`basename $$x` $(DISTDIR)/objects/$(ARCH)/$(OS)/`basename $$x`; done
@


1.61
log
@[Bug #30306]
Removing incomplete FI from 2.0m2 distribution
@
text
@d6 4
d290 1
a290 1
	-$(MKDIR) $(DISTDIR)
a310 1
	cd $(DISTDIR) && $(RM) system/$(ARCH)/$(OS)
a323 2
	-$(MKDIR) $(DISTDIR)/system $(DISTDIR)/system/$(ARCH) $(DISTDIR)/system/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/system $(DISTDIR)/system/$(ARCH) $(DISTDIR)/system/$(ARCH)/$(OS)
a326 2
	-$(MKDIR) $(DISTDIR)/unix $(DISTDIR)/unix/$(ARCH) $(DISTDIR)/unix/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/unix $(DISTDIR)/unix/$(ARCH) $(DISTDIR)/unix/$(ARCH)/$(OS)
d329 1
a329 1
	for x in $(WINMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d332 1
a332 1
	for x in $(XMMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d335 2
a336 2
	sed -e "s?../../../??g" images/$(ARCH)/$(OS)/basis-files > poo
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d339 1
a339 1
	for x in $(UTILSMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d351 1
a351 1
	$(chmod_read_only) $(DISTDIR)/basis/*.sml $(DISTDIR)/basis/$(ARCH)/$(OS)/*.mo
d353 1
a353 1
	$(chmod_read_only) $(DISTDIR)/utils/*.sml $(DISTDIR)/utils/$(ARCH)/$(OS)/*.mo
d355 1
d357 1
a357 2
	$(chmod_read_only) $(DISTDIR)/system/$(ARCH)/$(OS)/*.mo
	$(chmod_read_only) $(DISTDIR)/winsys/*.sml $(DISTDIR)/winsys/$(ARCH)/$(OS)/*.mo
d365 1
a365 2
	$(chmod_read_only) $(DISTDIR)/unix/$(ARCH)/$(OS)/*.mo
	$(chmod_read_only) $(DISTDIR)/motif/*.sml $(DISTDIR)/motif/$(ARCH)/$(OS)/*.mo
@


1.60
log
@[Bug #30304]
Removed special treatment of SML90 files, as these are now part of the
Basis Library.
@
text
@d6 5
d302 1
a302 1
	cd $(DISTDIR) && $(RM) basis foreign
a315 3
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH) $(DISTDIR)/foreign/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH)
	-$(chmod_exec) $(DISTDIR)/foreign/$(ARCH)/$(OS)
a341 2
	for x in `cat images/$(ARCH)/$(OS)/foreign-sigs`; do $(remove_log) < $$x > $(DISTDIR)/foreign/`basename $$x`; done
	for x in `cat images/$(ARCH)/$(OS)/foreign-objects`; do $(CP) $$x $(DISTDIR)/foreign/$(ARCH)/$(OS)/`basename $$x`; done
@


1.59
log
@[Bug #20090]
No longer need to call set_sml_time on object files.
@
text
@d6 4
a277 2
SML90MO	= basis/sml90.mo basis/__sml90.mo

d335 1
a335 1
	for x in `cat poo` $(SML90MO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
@


1.58
log
@[Bug #50021]
Merging from MLWorks_11:
Make utils signatures read-only.
@
text
@d6 5
a294 3
ifeq "$(NTTYPE)" "TRUE"
	for x in pervasive/*.mo; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
endif
a326 1
	for x in $(WINMO); do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
a327 1
	for x in mswindows/windows.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/winsys/`basename $$x`; done
a330 1
	for x in motif/xm.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/motif/`basename $$x`; done
a333 3
ifeq "$(NTTYPE)" "TRUE"
	for x in `cat poo` $(SML90MO); do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
endif
a334 1
	for x in basis/[a-z]*.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/basis/`basename $$x`; done
a335 3
ifeq "$(NTTYPE)" "TRUE"
	for x in `cat poo`; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
endif
a336 3
ifeq "$(NTTYPE)" "TRUE"
	for x in $(UTILSMO); do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
endif
a339 4
ifeq "$(NTTYPE)" "TRUE"
	for x in `cat images/$(ARCH)/$(OS)/foreign-objects`; do ../tools/set_sml_time.sh $(ARCH) $(OS) $xx $(DISTDIR)/foreign/$(ARCH)/$(OS)/`basename $$x`; done
	for x in `cat images/$(ARCH)/$(OS)/foreign-sigs`; do ../tools/set_sml_time.sh $(ARCH) $(OS) $xx $(DISTDIR)/foreign/`basename $$x`; done
endif
@


1.57
log
@[Bug #30153]
Distribution must refer to sml90 instead of old
@
text
@d6 4
d367 1
a367 1
	$(chmod_read_only) $(DISTDIR)/utils/$(ARCH)/$(OS)/*.mo
@


1.56
log
@[Bug #20096]
Ensure old MANIFEST files removed before moving in new one
@
text
@d6 4
d265 1
a265 1
OLDMO	= basis/old.mo basis/__old.mo
d330 1
a330 1
	for x in `cat poo` $(OLDMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d332 1
a332 1
	for x in `cat poo` $(OLDMO); do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
@


1.56.2.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a5 4
# Revision 1.56  1997/07/23  12:52:32  jont
# [Bug #20096]
# Ensure old MANIFEST files removed before moving in new one
#
@


1.56.1.1
log
@branched from trunk for label MLWorks_dt_wizard
@
text
@a5 4
# Revision 1.56  1997/07/23  12:52:32  jont
# [Bug #20096]
# Ensure old MANIFEST files removed before moving in new one
#
@


1.55
log
@[Bug #30029]
The MLWorks<->C interface has grown.  Replace {__,}c.sml with
{__,}mlworks_c_interface, {__,}mlworks_c_io, {__,}mlworks_dynamic_library,
{__,}mlworks_c_resource and {_,}mlworks_c_pointer.sml
@
text
@d6 6
d351 1
@


1.54
log
@[Bug #30149]
Merging in changes from 1.0r2c2 into 2.0m0:
On Windows, copy setup.rul and setup.lst to the distribution directory.
@
text
@d6 5
d335 2
a336 2
	for x in foreign/c.mo foreign/__c.mo; do $(CP) $$x $(DISTDIR)/foreign/$(ARCH)/$(OS)/`basename $$x`; done
	$(remove_log) < foreign/c.sml > $(DISTDIR)/foreign/c.sml
d338 2
a339 2
	for x in foreign/c.mo foreign/__c.mo; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/foreign/$(ARCH)/$(OS)/`basename $$x`; done
	../tools/set_sml_time.sh $(ARCH) $(OS) foreign/c.sml $(DISTDIR)/foreign/c.sml
@


1.53
log
@[Bug #30121]
Move to new FI: update distribution mechanism to distribute
the new FI rather than the old one.
@
text
@d6 6
d338 1
d352 1
@


1.52
log
@[Bug #30117]
Copied foreign/samples/Win32/README to the distribution.
@
text
@d6 4
d252 1
a252 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files foreign-files)
d282 1
a282 1
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH) $(DISTDIR)/foreign/$(ARCH)/$(OS) $(DISTDIR)/foreign/samples
d284 1
a284 1
	-$(chmod_exec) $(DISTDIR)/foreign/$(ARCH)/$(OS) $(DISTDIR)/foreign/samples
a315 2
	sed -e "s?../../../??g" images/$(ARCH)/$(OS)/foreign-files > poo
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d324 2
a325 2
	for x in foreign/interface.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/foreign/`basename $$x`; done
	for x in foreign/interface.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/foreign/`basename $$x`; done
d327 2
a328 6
	for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/README foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
	mv $(DISTDIR)/foreign/samples/README $(DISTDIR)/foreign/samples/README.TXT
else
	for x in foreign/samples/$(PLATFORM)/Makefile.$(OS) foreign/samples/$(PLATFORM)/README foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
	mv $(DISTDIR)/foreign/samples/Makefile.$(OS) $(DISTDIR)/foreign/samples/Makefile
	rm $(DISTDIR)/foreign/samples/regexp.*
a329 1
	$(chmod_non_exec) $(DISTDIR)/foreign/samples/*
a338 1
	$(chmod_read_only) $(DISTDIR)/foreign/*.sml $(DISTDIR)/foreign/$(ARCH)/$(OS)/*.mo $(DISTDIR)/foreign/samples/*
@


1.51
log
@Set time stamps on object files explicitly, since cp -p
seems to be failing under Win32
@
text
@d6 4
d325 2
a326 1
	for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
@


1.51.1.1
log
@branched from 1.51
@
text
@a5 4
# Revision 1.51  1997/04/07  12:25:15  jont
# Set time stamps on object files explicitly, since cp -p
# seems to be failing under Win32
#
@


1.51.1.2
log
@[Bug #30117]
Copied foreign/samples/Win32/README to the distribution.
@
text
@a5 7
# Revision 1.51.1.1  1997/05/12  10:26:33  hope
# branched from 1.51
#
# Revision 1.52  1997/05/15  12:37:24  daveb
# [Bug #30117]
# Copied foreign/samples/Win32/README to the distribution.
#
d325 1
a325 2
	for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/README foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
	mv $(DISTDIR)/foreign/samples/README $(DISTDIR)/foreign/samples/README.TXT
@


1.51.1.3
log
@[Bug #30074]
Added /usr/lib/X11/nls to SunOS distribution.
@
text
@a5 4
# Revision 1.51.1.2  1997/05/15  13:56:59  daveb
# [Bug #30117]
# Copied foreign/samples/Win32/README to the distribution.
#
a260 3
ifeq "$(OS)" "SunOS"
	cp -pr /usr/lib/X11/nls $(DISTDIR)/lib/X11
endif
@


1.51.1.4
log
@[Bug #30149]
On Windows, copy setup.rul and setup.lst to the distribution directory.
@
text
@a5 4
# Revision 1.51.1.3  1997/05/20  09:51:07  daveb
# [Bug #30074]
# Added /usr/lib/X11/nls to SunOS distribution.
#
a348 1
	cp ../tools/setup.rul ../tools/setup.lst $(DISTDIR)
a362 1
	$(chmod_read_only) $(DISTDIR)/setup.rul $(DISTDIR)/setup.lst
@


1.51.1.5
log
@[Bug #30149]
Remove any existing setup.rul and setup.lst files before copying them.
@
text
@a5 4
# Revision 1.51.1.4  1997/06/11  10:27:35  daveb
# [Bug #30149]
# On Windows, copy setup.rul and setup.lst to the distribution directory.
#
a352 1
	$(RM) $(DISTDIR)/setup.*
@


1.51.1.5.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a5 4
# Revision 1.51.1.5  1997/06/11  18:41:07  daveb
# [Bug #30149]
# Remove any existing setup.rul and setup.lst files before copying them.
#
@


1.51.1.5.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a5 4
# Revision 1.51.1.5  1997/06/11  18:41:07  daveb
# [Bug #30149]
# Remove any existing setup.rul and setup.lst files before copying them.
#
@


1.51.1.5.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a5 4
# Revision 1.51.1.5  1997/06/11  18:41:07  daveb
# [Bug #30149]
# Remove any existing setup.rul and setup.lst files before copying them.
#
@


1.51.1.5.1.2
log
@[Bug #30190]
Removed FI from Student Edition.
@
text
@a5 3
# Revision 1.51.1.5.1.1  1997/07/28  18:12:33  daveb
# branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
#
d271 1
a271 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files)
d304 3
d338 5
d348 12
d370 1
@


1.51.1.5.1.3
log
@[Bug #50021]
Make utils signatures read-only.
@
text
@a5 4
# Revision 1.51.1.5.1.2  1997/08/04  11:11:18  daveb
# [Bug #30190]
# Removed FI from Student Edition.
#
d354 1
a354 1
	$(chmod_read_only) $(DISTDIR)/utils/*.sml $(DISTDIR)/utils/$(ARCH)/$(OS)/*.mo
@


1.51.1.5.1.3.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a5 4
# Revision 1.51.1.5.1.3  1997/08/20  14:14:43  daveb
# [Bug #50021]
# Make utils signatures read-only.
#
@


1.50
log
@Fixed mistake in previous change.
@
text
@d6 3
d257 3
d292 1
d302 3
d310 3
d314 3
@


1.49
log
@[Bug #2016]
adding mutexes to utils directory
@
text
@d6 4
d290 1
a290 1
	for x in motif/xm.sml; do /u/sml/MLW/tools/add_copyright.sh $$x > $(DISTDIR)/motif/`basename $$x`; done
d301 1
a301 1
	for x in $(UTILSML); do /u/sml/MLW/tools/add_copyright.sh $$x > $(DISTDIR)/utils/`basename $$x`; done
@


1.48
log
@[Bug #1845]
Tidying up, and stuff to do with getting permissions
correct in distribution so installer doesn't have to do it
@
text
@d6 5
d216 5
d296 2
@


1.47
log
@[Bug #1816]
[Bug #1816]
Modify for use with beta-17 gnu tools
@
text
@d6 4
d247 3
a249 3
	$(RM) -r $(DISTDIR)/motif/$(ARCH)/$(OS)
	$(RM) -r $(DISTDIR)/unix/$(ARCH)/$(OS)
	$(RM) -f $(DISTDIR)/motif/*.sml
d293 1
a293 1
	rm -f $(DISTDIR)/foreign/samples/regexp.*
d295 1
a295 1
	$(chmod_read_only) $(DISTDIR)/foreign/samples/*
@


1.46
log
@[Bug #0]
Ensure .sml files are timestamp preserved when placed in distribution
@
text
@d6 4
a178 2
STABLEDIR	= $(SML_HOME)/table
STABLEBATCH	= $(STABLEDIR)/shell/stable-batch
d180 1
a180 1
RM		= c:/usr/local/bin/rm -rf
a186 2
STABLEDIR	= $(SML_HOME)/stable
STABLEBATCH	= $(STABLEDIR)/shell/stable-batch
d188 1
a188 1
RM		= /bin/rm -f
a212 10
stable:	$(STABLEDIR)/touch

$(STABLEDIR)/touch: rts pervasive-modules images/pervasive.img images/batch.img
	(cd rts && $(MAKE) STABLEDIR=$(STABLEDIR) stable)
	$(RM) $(STABLEDIR)/pervasive/*.mo
	$(LN) pervasive/*.mo $(STABLEDIR)/pervasive || $(CP) pervasive/*.mo $(STABLEDIR)/pervasive
	$(RM) $(STABLEDIR)/images/*.img
	$(LN) images/pervasive.img images/batch.img $(STABLEDIR)/images || $(CP) images/pervasive.img images/batch.img $(STABLEDIR)/images
	$(TOUCH) $(STABLEDIR)/touch

d223 1
a223 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files foreign-files RM="$(RM)")
d230 3
a232 3
	(cd .. && cd demo && $(MAKE) DISTDIR=$(DISTDIR) distribution)
	(cd scripts && $(MAKE) DISTDIR=$(DISTDIR) distribution)
	$(RM) -r $(DISTDIR)/pervasive/$(ARCH)/$(OS)
d235 2
a236 4
	sh -c "$(CP) pervasive/*.mo $(DISTDIR)/pervasive/$(ARCH)/$(OS)"
	$(RM) -r $(DISTDIR)/basis
	$(RM) -r $(DISTDIR)/foreign
	$(RM) -r $(DISTDIR)/foreign/samples
d238 4
a241 4
	$(RM) -r $(DISTDIR)/winsys
	$(RM) -r $(DISTDIR)/win_nt/$(ARCH)/$(OS)
	$(RM) -r $(DISTDIR)/mswindows/$(ARCH)/$(OS)
	$(RM) -r $(DISTDIR)/system/$(ARCH)/$(OS)
d247 1
a247 1
	$(RM) -r $(DISTDIR)/utils/$(ARCH)/$(OS)
d267 3
a269 3
	sh -c "for x in $(WINMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
	sh -c "for x in mswindows/windows.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/winsys/`basename $$x`; done"
	sh -c "for x in mswindows/windows.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/winsys/`basename $$x`; done"
a275 5
ifeq "$(NTTYPE)" "TRUE"
	sh -c "for x in `cat poo` $(OLDMO); do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
	sh -c "for x in basis/[a-z]*.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/basis/`basename $$x`; done"
	sh -c "for x in basis/[a-z]*.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/basis/`basename $$x`; done"
else
d277 1
a277 1
	for x in basis/[a-z]*.sml; do /u/sml/MLW/tools/add_copyright.sh $$x > $(DISTDIR)/basis/`basename $$x`; done
d279 1
a279 2
endif
	rm -f $(DISTDIR)/basis/require_all.sml
d281 3
d285 1
a285 4
	sh -c "for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
	sh -c "	for x in foreign/interface.sml; do ../tools/add_copyright.sh $$x > $(DISTDIR)/foreign/`basename $$x`; done"
	sh -c "for x in foreign/interface.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/foreign/`basename $$x`; done"
	sh -c "for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done"
a286 3
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
	for x in foreign/interface.sml; do /u/sml/MLW/tools/add_copyright.sh $$x > $(DISTDIR)/foreign/`basename $$x`; done
	for x in foreign/interface.sml; do ../tools/set_sml_time.sh $(ARCH) $(OS) $$x $(DISTDIR)/foreign/`basename $$x`; done
@


1.46.2.1
log
@branched from 1.46
@
text
@a5 4
# Revision 1.46  1996/12/04  14:30:22  jont
# [Bug #0]
# Ensure .sml files are timestamp preserved when placed in distribution
#
@


1.46.1.1
log
@branched from 1.46
@
text
@a5 4
# Revision 1.46  1996/12/04  14:30:22  jont
# [Bug #0]
# Ensure .sml files are timestamp preserved when placed in distribution
#
@


1.46.1.1.1.1
log
@branched from 1.46.1.1
@
text
@a5 3
# Revision 1.46.1.1  1996/12/17  17:40:39  hope
# branched from 1.46
#
@


1.45
log
@Problem with add_copyright somewhere
@
text
@d6 3
d281 1
d284 2
a285 1
	for x in motif/xm.sml; do /u/sml/MLW/tools/add_copyright.sh  $$x > $(DISTDIR)/motif/`basename $$x`; done
d291 1
d295 1
d302 1
d307 1
@


1.45.1.1
log
@branched from 1.45
@
text
@a5 3
# Revision 1.45  1996/11/19  17:30:51  jont
# Problem with add_copyright somewhere
#
@


1.44
log
@[Bug #1762]
Distribute basis/{,__}old.mo
@
text
@d6 4
a277 1
#	sh -c "for x in mswindows/windows.sml; do ../tools/add_copyright.sh $$x ; done"
@


1.44.1.1
log
@branched from 1.44
@
text
@a5 4
# Revision 1.44  1996/11/13  18:08:04  jont
# [Bug #1762]
# Distribute basis/{,__}old.mo
#
@


1.44.1.1.1.1
log
@branched from 1.44.1.1
@
text
@a5 3
# Revision 1.44.1.1  1996/11/14  12:41:16  hope
# branched from 1.44
#
@


1.43
log
@Added foreign/samples/$(PLATFORM)/README to distribution.
@
text
@d6 3
d218 2
d281 1
a281 1
	sh -c "for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
d284 1
a284 1
	for x in `cat poo`; do $(CP) $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
@


1.42
log
@[Bug #1748]
Run remove_log on distributed foreign sample files
@
text
@d6 4
d291 1
a291 1
	for x in foreign/samples/$(PLATFORM)/Makefile.$(OS) foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(remove_log) < $$x > $(DISTDIR)/foreign/samples/`basename $$x`; done
@


1.41
log
@[Bug #1747]
Ensure only required stuff from foreign samples is distributed
@
text
@d6 4
d146 1
d283 1
a283 1
	sh -c "for x in foreign/samples/$(PLATFORM)/Makefile foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(CP) $$x $(DISTDIR)/foreign/samples; done"
d287 1
a287 1
	for x in foreign/samples/$(PLATFORM)/Makefile.$(OS) foreign/samples/$(PLATFORM)/*.sml foreign/samples/$(PLATFORM)/*.h foreign/samples/$(PLATFORM)/*.c; do $(CP) $$x $(DISTDIR)/foreign/samples; done
@


1.40
log
@[Bug #1741]
Removing foreign/samples/Unix/regexp.* from distribution.
@
text
@d6 4
d278 1
a278 1
	sh -c "	for x in foreign/samples/$(PLATFORM)/*; do $(CP) $$x $(DISTDIR)/foreign/samples; done"
d282 1
a282 1
	for x in foreign/samples/$(PLATFORM)/*; do $(CP) $$x $(DISTDIR)/foreign/samples; done
a283 1
	rm -f $(DISTDIR)/foreign/samples/Makefile.*
@


1.39
log
@Ensure only one Makefile distributed for foreign samples on unix
@
text
@d6 3
d281 1
@


1.38
log
@Remove spurious $/ in various shell lines
@
text
@d6 3
d276 2
@


1.37
log
@Fix problems of pervasive files losing timestamps on Win95 and NT
when making distribution
@
text
@d6 4
d229 3
a231 3
	-$(MKDIR) $(DISTDIR)/basis $(DISTDIR)/basis/$(ARCH) $(DISTDIR)/basis/$/$(ARCH)/$(OS)
	-$(chmod_exec) $(DISTDIR)/basis $(DISTDIR)/basis/$(ARCH) $(DISTDIR)/basis/$/$(ARCH)/$(OS)
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH) $(DISTDIR)/foreign/$/$(ARCH)/$(OS) $(DISTDIR)/foreign/samples
d233 1
a233 1
	-$(chmod_exec) $(DISTDIR)/foreign/$/$(ARCH)/$(OS) $(DISTDIR)/foreign/samples
@


1.37.3.1
log
@branched from 1.37
@
text
@a5 4
# Revision 1.37  1996/08/29  16:51:49  jont
# Fix problems of pervasive files losing timestamps on Win95 and NT
# when making distribution
#
@


1.37.2.1
log
@branched from 1.37
@
text
@a5 4
# Revision 1.37  1996/08/29  16:51:49  jont
# Fix problems of pervasive files losing timestamps on Win95 and NT
# when making distribution
#
@


1.37.1.1
log
@branched from 1.37
@
text
@a5 4
# Revision 1.37  1996/08/29  16:51:49  jont
# Fix problems of pervasive files losing timestamps on Win95 and NT
# when making distribution
#
@


1.36
log
@Modify entry to demo directory to work better on NT and Win95
@
text
@d6 3
d146 1
a146 1
CP		= cp
d210 1
a210 1
	$(CP) pervasive/*.mo $(DISTDIR)/pervasive/$(ARCH)/$(OS)
d244 1
a244 1
	sh -c "for x in $(WINMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
d248 1
a248 1
	for x in $(XMMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d253 1
a253 1
	sh -c "for x in `cat poo`; do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
d256 1
a256 1
	for x in `cat poo`; do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d262 1
a262 1
	sh -c "for x in `cat poo`; do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
d264 1
a264 1
	sh -c "	for x in foreign/samples/$(PLATFORM)/*; do cp -p $$x $(DISTDIR)/foreign/samples; done"
d266 1
a266 1
	for x in `cat poo`; do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d268 1
a268 1
	for x in foreign/samples/$(PLATFORM)/*; do cp -p $$x $(DISTDIR)/foreign/samples; done
@


1.35
log
@Added call to make demos.
@
text
@d6 3
d202 1
a202 1
	(cd ../demo && $(MAKE) DISTDIR=$(DISTDIR) distribution)
@


1.34
log
@Change DESTDIR to DISTDIR
@
text
@d6 3
d199 1
@


1.33
log
@Adding platform specific (Unix/Win32) foreign samples ...
@
text
@d6 3
d270 1
a270 1
	$(chmod_read_only) $(DISTDIR)/foreign/*.sml $(DISTDIR)/foreign/$(ARCH)/$(OS)/*.mo $(DESTDIR)/foreign/samples/*
@


1.32
log
@Sort out problems on NT
@
text
@d6 3
d136 1
d149 1
d251 1
a251 1
	sh -c "	for x in foreign/auxfiles/*; do cp -p $$x $(DISTDIR)/foreign/samples; done"
d255 1
a255 1
	for x in foreign/auxfiles/*; do cp -p $$x $(DISTDIR)/foreign/samples; done
d267 1
a267 1
	$(chmod_read_only) $(DISTDIR)/foreign/*.sml $(DISTDIR)/foreign/$(ARCH)/$(OS)/*.mo
@


1.31
log
@Ensure all files and directories are made readable
@
text
@d6 3
d193 2
a194 2
	$(RM) -r $(DISTDIR)/basis/$(ARCH)/$(OS)
	$(RM) -r $(DISTDIR)/foreign/$(ARCH)/$(OS)
d197 1
a197 1
	$(RM) -r $(DISTDIR)/winsys/$(ARCH)/$(OS)
a200 1
	$(RM) -f $(DISTDIR)/winsys/*.sml
a205 2
	$(RM) -f $(DISTDIR)/basis/*.sml
	$(RM) -f $(DISTDIR)/foreign/*.sml
d210 2
a211 1
	-$(chmod_exec) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH) $(DISTDIR)/foreign/$/$(ARCH)/$(OS) $(DISTDIR)/foreign/samples
d227 2
a228 1
	sh -c "for x in mswindows/windows.sml; do /u/sml/MLW/tools/add_copyright $$x > $(DISTDIR)/winsys/`basename $$x`; done"
d231 1
a231 1
	for x in motif/xm.sml; do /u/sml/MLW/tools/add_copyright  $$x > $(DISTDIR)/motif/`basename $$x`; done
d236 1
a236 1
	sh -c "for x in basis/[a-z]*.sml; do /u/sml/MLW/tools/add_copyright $$x > $(DISTDIR)/basis/`basename $$x`; done"
d239 1
a239 1
	for x in basis/[a-z]*.sml; do /u/sml/MLW/tools/add_copyright $$x > $(DISTDIR)/basis/`basename $$x`; done
d245 1
a245 1
	sh -c "	for x in foreign/interface.sml; do /u/sml/MLW/tools/add_copyright $$x > $(DISTDIR)/foreign/`basename $$x`; done"
d249 1
a249 1
	for x in foreign/interface.sml; do /u/sml/MLW/tools/add_copyright $$x > $(DISTDIR)/foreign/`basename $$x`; done
@


1.30
log
@Fix minor bungle when adding basis files to distribution
@
text
@d6 3
d107 4
d176 1
d188 1
d208 1
d210 1
d212 1
d215 1
d217 1
d220 1
d222 1
d250 1
d254 22
a275 1
	(cd $(DISTDIR) && ls -lR > /tmp/MANIFEST && mv /tmp/MANIFEST $(DISTDIR))
@


1.29
log
@Add foreign samples to the distribution
@
text
@d6 3
d223 1
a223 1
	rm -f basis/require_all.sml
@


1.28
log
@Add stuff to put basis signatures in the distribution
@
text
@d6 3
d180 1
d196 1
a196 1
	-$(MKDIR) $(DISTDIR)/foreign $(DISTDIR)/foreign/$(ARCH) $(DISTDIR)/foreign/$/$(ARCH)/$(OS)
d225 1
d229 1
@


1.27
log
@Tidy up, add foreign to distribution
@
text
@d6 3
d182 1
d186 1
d188 2
d203 1
d206 1
d211 1
d214 1
d216 1
d220 1
d223 1
@


1.26
log
@Get the basis files from the make process on images
@
text
@d6 3
a127 123
BASIS1 =        basis/arrays \
		basis/general \
		basis/__general \
		basis/word \
		basis/__word \
		basis/__word8 \
		basis/chars \
		basis/__chars \
		basis/mono_arrays \
		basis/mono_vectors \
		basis/toplevel \
		basis/__charvector \
		basis/__word8vector \
		basis/__word8array \
		basis/__chararray \
		basis/bytes \
		basis/time \
		basis/__time \
		basis/date \
		basis/fileposint \
		basis/__preinteger \
		basis/__prereal \
		basis/real \
		basis/float \
		basis/__date \
		basis/fmt_date \
		basis/integer \
		basis/primio \
		basis/streamio \
		basis/io \
		basis/list_pairs \
		basis/lists \
		basis/math \
		utils/lists \
		utils/_lists \
		utils/__lists \
		basis/__integer \
		basis/__fileposint \
		basis/_primio \
		basis/_streamio \
		basis/_io \
		basis/os_process \
		basis/filesys \
		basis/path \
		basis/os \
		basis/osprimio \
		basis/textbin \
		basis/_textbinio 

ifeq "$(NTTYPE)" "TRUE"
BASIS2 =	utils/getenv \
		system/_win_ntgetenv \
		system/__getenv \
		basis/path \
		system/_win_ntpath \
		system/__path \
		basis/filesys \
		system/_win_ntfilesys \
		system/__filesys \
		system/win32 \
		system/_win32 \
		system/__win32
else
BASIS2 =	utils/getenv \
		unix/_unixgetenv \
		unix/__getenv \
		basis/path \
		unix/_unixpath \
		unix/__path \
		basis/filesys \
		unix/_unixfilesys \
		unix/__filesys \
		unix/__unixprimio \
		unix/__unixtextbinio \
		unix/unixos \
		unix/_unixos \
		unix/__unixos
endif

BASIS3 =        basis/pack_words \
		basis/strings \
		basis/timer \
		basis/vectors \
		basis/_mono_arrays \
		basis/_mono_vectors \
		basis/_pack_words_big \
		basis/_pack_words_little \
		basis/__bytes \
		basis/__word32 \
		basis/__word16 \
		basis/__fmt_date \
		basis/__lists \
		basis/__list_pairs \
		basis/__math \
		basis/__os_process

ifeq "$(NTTYPE)" "TRUE"
BASIS4=		system/__path \
		system/__filesys \
		system/_os \
		system/__os
else
BASIS4=		unix/__path \
		unix/__filesys \
		unix/_os \
		unix/__os
endif

BASIS5=		basis/__pack16big \
                basis/__pack16little \
                basis/__pack32big \
                basis/__pack32little \
                basis/__pack8big \
                basis/__pack8little \
                basis/__real \
                basis/__timer \
                basis/__word16vector \
                basis/__word16array \
                basis/__word32vector \
                basis/__word32array

BASIS =		$(BASIS1) $(BASIS2) $(BASIS3) $(BASIS4) $(BASIS5)

a135 4
BASISMO =	$(BASIS:%=%.mo)
BASIS1MO =	$(BASIS1:%=%.mo)
BASIS2MO =	$(BASIS2:%=%.mo)
BASIS3MO =	$(BASIS3:%=%.mo)
d161 1
a161 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution basis-files RM="$(RM)")
d173 1
d185 1
d194 5
a200 1
	sh -c "for x in $(WINMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
a202 1
	for x in $(XMMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
d205 7
@


1.25
log
@Change maths to math
@
text
@d6 3
d285 1
a285 1
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution RM="$(RM)")
d316 1
d318 2
a319 1
	sh -c "for x in $(BASISMO) $(WINMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
d321 2
a322 1
	for x in $(BASISMO) $(XMMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done
@


1.24
log
@Tidying up for Win95 and NT distributions
@
text
@d6 3
d154 1
a154 1
		basis/maths \
d215 1
a215 1
		basis/__maths \
@


1.23
log
@initbasis becomes basis
@
text
@d6 3
d284 1
a286 4
ifeq "$(NTTYPE)" "TRUE"
else
	(cd app-defaults && $(MAKE) DISTDIR=$(DISTDIR) distribution)
endif
d291 6
a297 1
	$(RM) -r $(DISTDIR)/winsys/$(ARCH)/$(OS)
d299 1
a299 1
	$(RM) -r $(DISTDIR)/system/$(ARCH)/$(OS)
d302 5
a307 1
	-$(MKDIR) $(DISTDIR)/winsys $(DISTDIR)/winsys/$(ARCH) $(DISTDIR)/winsys/$(ARCH)/$(OS)
d309 1
a309 2
	-$(MKDIR) $(DISTDIR)/system $(DISTDIR)/system/$(ARCH) $(DISTDIR)/system/$(ARCH)/$(OS)
	-$(MKDIR) $(DISTDIR)/utils $(DISTDIR)/utils/$(ARCH) $(DISTDIR)/utils/$(ARCH)/$(OS)
@


1.22
log
@Updated wrt process -> os_process name change in initbasis.
@
text
@d6 3
d116 33
a148 33
BASIS1 =        initbasis/arrays \
		initbasis/general \
		initbasis/__general \
		initbasis/word \
		initbasis/__word \
		initbasis/__word8 \
		initbasis/chars \
		initbasis/__chars \
		initbasis/mono_arrays \
		initbasis/mono_vectors \
		initbasis/toplevel \
		initbasis/__charvector \
		initbasis/__word8vector \
		initbasis/__word8array \
		initbasis/__chararray \
		initbasis/bytes \
		initbasis/time \
		initbasis/__time \
		initbasis/date \
		initbasis/fileposint \
		initbasis/__preinteger \
		initbasis/__prereal \
		initbasis/real \
		initbasis/float \
		initbasis/__date \
		initbasis/fmt_date \
		initbasis/integer \
		initbasis/primio \
		initbasis/streamio \
		initbasis/io \
		initbasis/list_pairs \
		initbasis/lists \
		initbasis/maths \
d152 12
a163 12
		initbasis/__integer \
		initbasis/__fileposint \
		initbasis/_primio \
		initbasis/_streamio \
		initbasis/_io \
		initbasis/os_process \
		initbasis/filesys \
		initbasis/path \
		initbasis/os \
		initbasis/osprimio \
		initbasis/textbin \
		initbasis/_textbinio 
d169 1
a169 1
		initbasis/path \
d172 1
a172 1
		initbasis/filesys \
d182 1
a182 1
		initbasis/path \
d185 1
a185 1
		initbasis/filesys \
d195 16
a210 16
BASIS3 =        initbasis/pack_words \
		initbasis/strings \
		initbasis/timer \
		initbasis/vectors \
		initbasis/_mono_arrays \
		initbasis/_mono_vectors \
		initbasis/_pack_words_big \
		initbasis/_pack_words_little \
		initbasis/__bytes \
		initbasis/__word32 \
		initbasis/__word16 \
		initbasis/__fmt_date \
		initbasis/__lists \
		initbasis/__list_pairs \
		initbasis/__maths \
		initbasis/__os_process
d224 12
a235 12
BASIS5=		initbasis/__pack16big \
                initbasis/__pack16little \
                initbasis/__pack32big \
                initbasis/__pack32little \
                initbasis/__pack8big \
                initbasis/__pack8little \
                initbasis/__real \
                initbasis/__timer \
                initbasis/__word16vector \
                initbasis/__word16array \
                initbasis/__word32vector \
                initbasis/__word32array
d290 1
a290 1
	$(RM) -r $(DISTDIR)/initbasis/$(ARCH)/$(OS)
d296 1
a296 1
	-$(MKDIR) $(DISTDIR)/initbasis $(DISTDIR)/initbasis/$(ARCH) $(DISTDIR)/initbasis/$/$(ARCH)/$(OS)
@


1.21
log
@Modifications to file list for distribution
@
text
@d6 3
d154 1
a154 1
		initbasis/process \
d207 1
a207 1
		initbasis/__process
@


1.20
log
@More distribution work
@
text
@d6 3
d111 47
a157 47
                initbasis/general \
                initbasis/__general \
                initbasis/words \
                initbasis/_words \
                initbasis/__word8 \
                initbasis/chars \
                initbasis/__chars \
                initbasis/mono_arrays \
                initbasis/mono_vectors \
                initbasis/toplevel \
                initbasis/__charvector \
                initbasis/__word8vector \
                initbasis/__word8array \
                initbasis/__chararray \
                initbasis/bytes \
                initbasis/time \
                initbasis/__time \
                initbasis/date \
                initbasis/fileposint \
                initbasis/__preinteger \
                initbasis/__prereal \
                initbasis/real \
                initbasis/float \
                initbasis/__date \
                initbasis/fmt_date \
                initbasis/integer \
                initbasis/primio \
                initbasis/streamio \
                initbasis/io \
                initbasis/list_pairs \
                initbasis/lists \
                initbasis/maths \
                utils/lists \
                utils/_lists \
                utils/__lists \
                initbasis/__integer \
                initbasis/__fileposint \
                initbasis/_primio \
                initbasis/_streamio \
                initbasis/_io \
                initbasis/process \
                initbasis/filesys \
                initbasis/path \
                initbasis/os \
                initbasis/osprimio \
                initbasis/textbin \
                initbasis/_textbinio 
d160 3
a162 4
BASIS2 =	\
		utils/getenv \
		win_nt/_win_ntgetenv \
		win_nt/__getenv \
d164 2
a165 2
		win_nt/_win_ntpath \
		win_nt/__path \
d167 5
a171 5
		win_nt/_win_ntfilesys \
		win_nt/__filesys \
		win_nt/win32 \
		win_nt/_win32 \
		win_nt/__win32
d173 1
a173 2
BASIS2 =	\
		utils/getenv \
d190 29
a218 17
                initbasis/strings \
                initbasis/timer \
                initbasis/vectors \
                initbasis/_mono_arrays \
                initbasis/_mono_vectors \
                initbasis/_pack_words_big \
                initbasis/_pack_words_little \
                initbasis/__bytes \
                initbasis/__word32 \
                initbasis/__word16 \
                initbasis/__fmt_date \
                initbasis/__lists \
                initbasis/__list_pairs \
                initbasis/__maths \
                initbasis/__process \
                initbasis/__os \
                initbasis/__pack16big \
d231 1
a231 1
BASIS =		$(BASIS1) $(BASIS2) $(BASIS3)
d288 1
a288 1
	$(RM) -r $(DISTDIR)/win_nt/$(ARCH)/$(OS)
d294 1
a294 1
	-$(MKDIR) $(DISTDIR)/win_nt $(DISTDIR)/win_nt/$(ARCH) $(DISTDIR)/win_nt/$(ARCH)/$(OS)
@


1.19
log
@More changes to get distributions working under NT
@
text
@d6 3
d224 4
d233 1
d273 1
d279 1
d284 1
a284 1
	sh -c "for x in $(BASISMO); do cp -p $$x $(DISTDIR)/`dirname $$x`/$(ARCH)/$(OS)/`basename $$x`; done"
@


1.18
log
@Modifications to allow distributions to be built for NT and Win95
@
text
@d6 3
d82 7
a88 7
SRC		= $(SML_HOME)\\MLW\\src
DISTDIR		= $(SML_HOME)\\distribution
STABLEDIR	= $(SML_HOME)\\table
STABLEBATCH	= $(STABLEDIR)\\shell\\stable-batch
COUTALL		= $(SML_HOME)\\tools\\coutall
RM		= rm -f
CP		= cp -p
a122 1
                initbasis/convert_words \
a188 1
                initbasis/_convert_words \
a194 1
                initbasis/__word24 \
a195 1
                initbasis/__convert \
a203 2
                initbasis/__pack24big \
                initbasis/__pack24little \
a211 2
                initbasis/__word24vector \
                initbasis/__word24array \
d222 3
a247 2
	-$(RM) -rf $(DISTDIR)/edlib
	-$(CP) -r $(SML_HOME)/edlib $(DISTDIR)
d249 3
a251 2
	pwd
	(cd images && cd $(ARCH) && cd $(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution)
d254 1
d256 2
d259 1
d261 1
a261 1
	- $(MKDIR) $(DISTDIR)/pervasive $(DISTDIR)/pervasive/$(ARCH) $(DISTDIR)/pervasive/$(ARCH)/$(OS)
d268 8
a275 5
	- $(MKDIR) $(DISTDIR)/initbasis $(DISTDIR)/initbasis/$(ARCH) $(DISTDIR)/initbasis/$/$(ARCH)/$(OS)
	- $(MKDIR) $(DISTDIR)/motif $(DISTDIR)/motif/$(ARCH) $(DISTDIR)/motif/$(ARCH)/$(OS)
	- $(MKDIR) $(DISTDIR)/unix $(DISTDIR)/unix/$(ARCH) $(DISTDIR)/unix/$(ARCH)/$(OS)
	- $(MKDIR) $(DISTDIR)/win_nt $(DISTDIR)/win_nt/$(ARCH) $(DISTDIR)/win_nt/$(ARCH)/$(OS)
	- $(MKDIR) $(DISTDIR)/utils $(DISTDIR)/utils/$(ARCH) $(DISTDIR)/utils/$(ARCH)/$(OS)
d277 3
d281 1
@


1.17
log
@Move xm files into motif
@
text
@d6 3
d68 9
d78 10
d99 1
d151 1
a151 1
ifeq "$(OS)" "NT"
d249 2
a250 2
	-mkdir $(DISTDIR)
	-/bin/rm -rf $(DISTDIR)/edlib
d253 2
a254 1
	(cd images/$(ARCH)/$(OS) && $(MAKE) DISTDIR=$(DISTDIR) OS=$(OS) ARCH=$(ARCH) distribution)
@


1.16
log
@OS reorganisation: add the UNIX/NT specific files that have
been moved from the pervasive library.
@
text
@d6 4
d199 3
a201 3
XM = 		library/xm \
		library/_xm \
		library/__xm
d239 1
a239 1
	$(RM) -r $(DISTDIR)/library/$(ARCH)/$(OS)
d244 1
a244 1
	- $(MKDIR) $(DISTDIR)/library $(DISTDIR)/library/$(ARCH) $(DISTDIR)/library/$(ARCH)/$(OS)
@


1.15
log
@Added new files to the initial basis.
@
text
@d6 3
d134 4
a137 1
		win_nt/__filesys
d150 4
a153 1
		unix/__unixtextbinio
@


1.14
log
@Add pervasive object files in architecture specific place
Also add initial basis and xm library
@
text
@d6 4
d71 49
a119 35
BASIS1 =	initbasis/arrays \
		initbasis/chars \
		initbasis/__chars \
		initbasis/general \
		initbasis/__general \
		initbasis/words \
		initbasis/_words \
		initbasis/__word8 \
		initbasis/mono_arrays \
		initbasis/mono_vectors \
		initbasis/__word8vector \
		initbasis/__word8array \
		initbasis/bytes \
		initbasis/time \
		initbasis/__time \
		initbasis/date \
		initbasis/convert_words \
		initbasis/fileposint \
		initbasis/toplevel \
		initbasis/__preinteger \
		initbasis/__prereal \
		initbasis/real \
		initbasis/float \
		initbasis/__date \
		initbasis/fmt_date \
		initbasis/integer \
		initbasis/primio \
		initbasis/streamio \
		initbasis/io \
		initbasis/list_pairs \
		initbasis/lists \
		initbasis/maths \
		utils/lists \
		utils/_lists \
		utils/__lists
d142 3
a144 1
		unix/__filesys
d147 36
a182 48
BASIS3 =	initbasis/process \
		initbasis/os \
		initbasis/osprimio \
		initbasis/pack_words \
		initbasis/strings \
		initbasis/textbin \
		initbasis/timer \
		initbasis/vectors \
		initbasis/_convert_words \
		initbasis/_mono_arrays \
		initbasis/_mono_vectors \
		initbasis/_io \
		initbasis/_pack_words_big \
		initbasis/_pack_words_little \
		initbasis/__charvector \
		initbasis/__chararray \
		initbasis/__integer \
		initbasis/__fileposint \
		initbasis/_primio \
		initbasis/_streamio \
		initbasis/_textbinio \
		initbasis/__bytes \
		initbasis/__word32 \
		initbasis/__word24 \
		initbasis/__word16 \
		initbasis/__convert \
		initbasis/__fmt_date \
		initbasis/__lists \
		initbasis/__list_pairs \
		initbasis/__maths \
		initbasis/__process \
		initbasis/__os \
		initbasis/__pack16big \
		initbasis/__pack16little \
		initbasis/__pack24big \
		initbasis/__pack24little \
		initbasis/__pack32big \
		initbasis/__pack32little \
		initbasis/__pack8big \
		initbasis/__pack8little \
		initbasis/__real \
		initbasis/__timer \
		initbasis/__word16vector \
		initbasis/__word16array \
		initbasis/__word24vector \
		initbasis/__word24array \
		initbasis/__word32vector \
		initbasis/__word32array
@


1.13
log
@Ensure ARCH and OS passed to emacs/etc make
@
text
@d6 3
d67 117
d214 14
a227 2
	($(RM) -r $(DISTDIR)/pervasive && $(MKDIR) $(DISTDIR)/pervasive && \
	$(CP) pervasive/*.mo $(DISTDIR)/pervasive)
@


1.12
log
@Make image building for distribution OS and architecture specific
@
text
@d6 3
d90 1
a90 1
	(cd emacs/etc && $(MAKE) DISTDIR=$(DISTDIR) distribution)
@


1.11
log
@Modify for new /u directory structure
@
text
@d6 3
d70 1
a70 1
	(cd rts && make STABLEDIR=$(STABLEDIR) stable)
d80 2
d85 6
a90 6
	(cd rts && gnumake -e ARCH=SPARC OS=SunOS DISTDIR=$(DISTDIR) distribution)
	(cd images/SPARC/SunOS && gnumake DISTDIR=$(DISTDIR) distribution)
	(cd emacs/etc && make DISTDIR=$(DISTDIR) distribution)
	(cd emacs/lisp && make DISTDIR=$(DISTDIR) distribution)
	(cd scripts && make DISTDIR=$(DISTDIR) distribution)
	(cd app-defaults && make DISTDIR=$(DISTDIR) distribution)
d94 8
@


1.10
log
@Updated distribution command for new runtime organisation.
@
text
@d6 3
d45 4
a48 4
MLHOME		= /usr/sml
SRC		= $(MLHOME)/MLW/src
DISTDIR		= $(MLHOME)/distribution
STABLEDIR	= $(MLHOME)/stable
d50 1
a50 1
COUTALL		= $(MLHOME)/tools/coutall
d58 2
a59 1
all:	rts images
d62 1
a62 1
	$(COUTALL)
d79 3
a81 3
	-$(CP) -r $(MLHOME)/edlib $(DISTDIR)
	(cd rts && /usr/sml/bin/make -e ARCH=SPARC OS=SunOS DISTDIR=$(DISTDIR) distribution)
	(cd images && make DISTDIR=$(DISTDIR) distribution)
d87 1
a87 1
	 $(CP) pervasive/*.mo $(DISTDIR)/pervasive)
a88 37

rts:
	cd rts
	make


images: images/pervasive.img images/batch.img images/tty.img images/motif.img

images/pervasive.img: pervasive-modules
	cd images
	make pervasive.img

images/batch.img: images/pervasive.img batch-modules
	cd images
	make batch.img

images/tty.img: images/pervasive.img tty-modules
	cd images
	make tty.img

images/motif.img: images/pervasive.img motif-modules
	cd images
	make motif.img

modules: batch-modules tty-modules motif-modules

pervasive-modules:
	$(STABLEBATCH) pervasive/__pervasive_library

batch-modules:
	$(STABLEBATCH) main/__batch

tty-modules:
	$(STABLEBATCH) interpreter/interpreter

motif-modules:
	$(STABLEBATCH) interpreter/xinterpreter
@


1.9
log
@Now removes DISTDIR/edlib before copying new edlib.
@
text
@d6 3
d76 1
a76 1
	(cd rts && make DISTDIR=$(DISTDIR) distribution)
@


1.8
log
@Moving edlib source out of MLW directory.
@
text
@d6 3
d71 2
a72 1
	-$(CP) -r $(MLHOME)/edlib $(DISTDIR)/edlib
@


1.7
log
@Added Edinburgh Library to distribution.
@
text
@d6 3
d68 1
a68 1
	-$(CP) -r ../edlib $(DISTDIR)/edlib
@


1.6
log
@Changed the src directory, instead of the root directory.  Ho hum.
@
text
@d6 3
d65 1
@


1.5
log
@Changed location of src directory.
@
text
@d6 3
d30 2
a31 2
MLHOME		= /usr/sml/MLW
SRC		= $(MLHOME)/src
@


1.4
log
@Merged in bug fix.
@
text
@d6 3
d27 1
a27 1
MLHOME		= /usr/sml
@


1.3
log
@Ensured scripts and man copied into distribution
@
text
@d6 11
d33 1
d55 1
d59 1
d61 4
a64 2
	$(RM) $(DISTDIR)/lib/emacs/lisp/*.el
	$(CP) emacs/lisp/*.el $(DISTDIR)/lib/emacs/lisp
@


1.3.1.1
log
@Fork for bug fixing
@
text
@a5 3
# Revision 1.3  1993/09/01  15:46:11  jont
# Ensured scripts and man copied into distribution
#
@


1.3.1.2
log
@Ensure that target directory exists.  Added Makefiles for emacs/lisp &
app-defaults directories.  Copy across pervasive .mo files, and finally
create a MANIFEST.
@
text
@a5 3
# Revision 1.3.1.1  1993/09/01  15:46:11  jont
# Fork for bug fixing
#
a24 1
MKDIR		= /bin/mkdir
a45 1
	-mkdir $(DISTDIR)
a48 1
	(cd emacs/lisp && make DISTDIR=$(DISTDIR) distribution)
d50 2
a51 4
	(cd app-defaults && make DISTDIR=$(DISTDIR) distribution)
	($(RM) -r $(DISTDIR)/pervasive && $(MKDIR) $(DISTDIR)/pervasive && \
	 $(CP) pervasive/*.mo $(DISTDIR)/pervasive)
	(cd $(DISTDIR) && ls -lR > /tmp/MANIFEST && mv /tmp/MANIFEST $(DISTDIR))
@


1.2
log
@Changed to remove lib/emacs/lisp/*.el before copying to avoid errors
@
text
@d6 3
d46 1
@


1.1
log
@Initial revision
@
text
@d5 4
a8 1
# $Log$
d43 1
@
