head	1.2;
access;
symbols
	MLW_daveb_inline_1_4_99:1.2.1
	MLWorks_21c0_1999_03_25:1.2;
locks; strict;
comment	@ *  @;


1.2
date	99.02.16.09.31.30;	author mitchell;	state Exp;
branches
	1.2.1.1;
next	1.1;

1.1
date	99.02.15.14.07.58;	author mitchell;	state Exp;
branches;
next	;

1.2.1.1
date	99.04.01.17.51.57;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
[Bug #190508]
Add socket support to the basis library
@


1.2
log
@[Bug #190508]
Improve layout
@
text
@(* __serv-db.sml
 *
 * This file includes parts which are Copyright (c) 1995 AT&T Bell 
 * Laboratories. All rights reserved.  
 *
 * $Log: __serv_db.sml,v $
 *  Revision 1.1  1999/02/15  14:07:58  mitchell
 *  new unit
 *  [Bug #190508]
 *  Add socket support to the basis library
 *
 *)

require "serv_db.sml";

structure NetServDB : NET_SERV_DB =
  struct

    val netdbFun = MLWorks.Internal.Runtime.environment

    datatype entry = SERVENT of {
          name : string,
          aliases : string list,
          port : int,
          protocol : string
        }

    local
      fun conc field (SERVENT a) = field a
    in
      val name = conc #name
      val aliases = conc #aliases
      val port = conc #port
      val protocol = conc #protocol
    end (* local *)

    (* Server DB query functions *)
    local
      type servent = (string * string list * int * string)
      fun getServEnt NONE = NONE
        | getServEnt (SOME(name, aliases, port, protocol)) = SOME(SERVENT{
              name = name, aliases = aliases, port = port, protocol = protocol
            })
      val getServerByName' : (string  * string option) -> servent option
            = netdbFun "system os getServByName"
      val getServerByPort' : (int  * string option) -> servent option
            = netdbFun "system os getServByPort"
    in
      val getByName = getServEnt o getServerByName'
      val getByPort = getServEnt o getServerByPort'
    end (* local *)
  end

@


1.2.1.1
log
@branched from trunk for label MLW_daveb_inline_1_4_99
@
text
@a6 4
 *  Revision 1.2  1999/02/16  09:31:30  mitchell
 *  [Bug #190508]
 *  Improve layout
 *
@


1.1
log
@new unit
[Bug #190508]
Add socket support to the basis library
@
text
@d6 5
a10 1
 * $Log$
d22 5
a26 5
	  name : string,
	  aliases : string list,
	  port : int,
	  protocol : string
	}
d31 4
a34 4
    val name = conc #name
    val aliases = conc #aliases
    val port = conc #port
    val protocol = conc #protocol
d37 1
a37 1
  (* Server DB query functions *)
d41 3
a43 3
	| getServEnt (SOME(name, aliases, port, protocol)) = SOME(SERVENT{
	      name = name, aliases = aliases, port = port, protocol = protocol
	    })
d45 1
a45 1
	    = netdbFun "system os getServByName"
d47 1
a47 1
	    = netdbFun "system os getServByPort"
d49 2
a50 2
    val getByName = getServEnt o getServerByName'
    val getByPort = getServEnt o getServerByPort'
a51 1

@
