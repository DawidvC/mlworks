head	1.6;
access;
symbols
	hope_poo:1.3.1
	ML_beta_release_12/08/94:1.3.1.1
	ML_beta_release_03/08/94:1.2;
locks; strict;
comment	@ * @;


1.6
date	95.03.02.15.31.19;	author matthew;	state Exp;
branches;
next	1.5;

1.5
date	94.11.23.17.07.45;	author nickb;	state Exp;
branches;
next	1.4;

1.4
date	94.10.19.16.33.12;	author nickb;	state Exp;
branches;
next	1.3;

1.3
date	94.08.03.13.38.24;	author jont;	state Exp;
branches
	1.3.1.1;
next	1.2;

1.2
date	94.07.19.09.28.07;	author jont;	state Exp;
branches;
next	1.1;

1.1
date	94.07.12.12.05.45;	author jont;	state Exp;
branches;
next	;

1.3.1.1
date	95.07.05.10.31.57;	author hope;	state Exp;
branches;
next	;


desc
@new file
@


1.6
log
@Added stack_top to ml_state
@
text
@/*
 * state.c
 * The ML and C states are stored here.
 * $Log: src:arch:MIPS:state.c,v $
 * Revision 1.5  1994/11/23  17:07:45  nickb
 * Remove reference to GC_CLOSURE, which no longer exists.
 *
 * Revision 1.4  1994/10/19  16:33:12  nickb
 * Put in cast to avoid compiler warning.
 *
 * Revision 1.3  1994/08/03  13:38:24  jont
 * Add closure to ml_state
 *
 * Revision 1.2  1994/07/19  09:28:07  jont
 * MIPS specific state initialisation
 *
 * Revision 1.1  1994/07/12  12:05:45  jont
 * new file
 *
 *
 * Copyright (c) 1994 Harlequin Ltd.
 */

#include "mltypes.h"
#include "mem.h"
#include "implicit.h"
#include "state.h"
#include "tags.h"
#include "gc.h"

struct ml_state ml_state;
struct c_state c_state;

unsigned int stack_extension_count;
unsigned int raise_count;

extern void state_initialise(struct stack *initial_stack)
{
  GC_STACK = STACK_LIMIT(initial_stack);
  ml_state.base = initial_stack->top;
  GC_SP = initial_stack->top;
  ml_state.stack_top = initial_stack->top;

  c_state.sp = (word) NULL; /* Required by MIPS for spotting top of stack */

  ml_state.implicit = &implicit_vector;
  GC_MODIFIED_LIST = NULL;
}
@


1.5
log
@Remove reference to GC_CLOSURE, which no longer exists.
@
text
@d5 3
d42 1
@


1.4
log
@Put in cast to avoid compiler warning.
@
text
@d5 3
a43 1
  declare_root(&GC_CLOSURE); /* Ensure this gets fixed if necessary */
@


1.3
log
@Add closure to ml_state
@
text
@d5 3
d37 1
a37 1
  c_state.sp = NULL; /* Required by MIPS for spotting top of stack */
@


1.3.1.1
log
@branched from 1.3
@
text
@a4 3
 * Revision 1.3  1994/08/03  13:38:24  jont
 * Add closure to ml_state
 *
@


1.2
log
@MIPS specific state initialisation
@
text
@d5 3
d38 1
@


1.1
log
@new file
@
text
@d4 3
a6 1
 * $Log$
d8 1
d13 2
d16 2
d24 12
@
