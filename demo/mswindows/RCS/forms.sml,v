head	1.3;
access;
symbols
	MLWorks_21c0_1999_03_25:1.3
	MLWorks_20c1_1998_08_20:1.3
	MLWorks_20c0_1998_08_04:1.3
	MLWorks_20b2c2_1998_06_19:1.3
	MLWorks_20b2_Windows_1998_06_12:1.3
	MLWorks_20b1c1_1998_05_07:1.3
	MLWorks_20b0_1998_04_07:1.3
	MLWorks_20b0_1998_03_20:1.3
	MLWorks_20m2_1998_02_16:1.3
	MLWorks_workspace_97:1.3.1
	MLWorks_20m1_1997_10_23:1.3
	MLWorks_11r1:1.2.4.2.1.1.1
	MLWorks_11c0_1997_09_09:1.2.4.2.1.1
	MLWorks_10r3:1.2.4.2.3
	MLWorks_10r2_551:1.2.4.2.2
	MLWorks_11:1.2.4.2.1
	MLWorks_1_0_r2c2_1997_07_28:1.2.4.2
	MLWorks_20m0_1997_06_20:1.3
	MLWorks_1_0_r2c2_1997_06_14:1.2.4.2
	MLWorks_1_0_r2c1_released_1997_05_23:1.2.4.2
	MLWorks_1_0_r2c1_1997_05_12:1.2.4
	MLWorks_BugFix_1997_04_24:1.2
	MLWorks_1_0_r2_Win32_1997_04_11:1.2
	MLWorks_1_0_r2_Unix_1997_04_04:1.2
	MLWorks_1_0_1_ULTRASPARC_1997_02_24:1.2.3.1.1
	MLWorks_1_0_Win32_1996_12_17:1.2.3
	MLWorks_1_0_Irix_1996_11_28_released_1996_12_17:1.2.1.1.1.1
	MLWorks_1_0_Unix_1996_11_14_released_1996_12_17:1.2.1.1
	MLWorks_1_0_Irix_1996_11_28:1.2.1.1.1
	MLWorks_1_0_Win32_1996_11_22:1.2.2
	MLWorks_1_0_Unix_1996_11_14:1.2.1
	MLWorks_Open_Beta2_1996_10_11:1.1.1;
locks; strict;
comment	@ *  @;


1.3
date	97.06.16.12.36.46;	author jkbrook;	state Exp;
branches
	1.3.1.1;
next	1.2;

1.2
date	96.11.07.16.49.08;	author jkbrook;	state Exp;
branches
	1.2.1.1
	1.2.2.1
	1.2.3.1
	1.2.4.1;
next	1.1;

1.1
date	96.10.11.14.14.22;	author johnh;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.10.17.11.16.20;	author hope;	state Exp;
branches;
next	;

1.2.1.1
date	96.11.14.12.39.22;	author hope;	state Exp;
branches
	1.2.1.1.1.1;
next	;

1.2.1.1.1.1
date	96.11.28.14.51.24;	author hope;	state Exp;
branches;
next	;

1.2.2.1
date	96.11.22.18.00.00;	author hope;	state Exp;
branches;
next	;

1.2.3.1
date	96.12.17.17.38.56;	author hope;	state Exp;
branches
	1.2.3.1.1.1;
next	;

1.2.3.1.1.1
date	97.02.24.11.26.06;	author hope;	state Exp;
branches;
next	;

1.2.4.1
date	97.05.12.10.23.53;	author hope;	state Exp;
branches;
next	1.2.4.2;

1.2.4.2
date	97.05.15.13.21.37;	author daveb;	state Exp;
branches
	1.2.4.2.1.1
	1.2.4.2.2.1
	1.2.4.2.3.1;
next	;

1.2.4.2.1.1
date	97.07.28.18.10.35;	author daveb;	state Exp;
branches
	1.2.4.2.1.1.1.1;
next	;

1.2.4.2.1.1.1.1
date	97.10.07.11.34.47;	author jkbrook;	state Exp;
branches;
next	;

1.2.4.2.2.1
date	97.09.08.17.03.53;	author daveb;	state Exp;
branches;
next	;

1.2.4.2.3.1
date	97.09.09.13.58.53;	author daveb;	state Exp;
branches;
next	;

1.3.1.1
date	97.11.30.16.47.35;	author daveb;	state Exp;
branches;
next	;


desc
@new unit
Reorganised demo directory to include separate demos for mswindows and motif.
@


1.3
log
@[Bug #30127]
Merging changes from 1.0r2c1 into 2.0m0
@
text
@(*  ==== Needed for Life demo  ====
 *
 *  Copyright (C) 1997 The Harlequin Group Limited.  All rights reserved.
 *
 * $Log: mswindows:forms.sml,v $
 *
 *  Revision 1.2  1996/11/07  16:49:08  jkbrook
 *  Needs to require String basis library
 *
 *  Revision 1.1  1996/10/11  14:14:22  johnh
 *  new unit
 *  Reorganised demo directory to include separate demos for mswindows and motif.
 *
 *
 *)

require "$.basis.__string";

fun conv sl =
  let
    fun scan1 (s,i,acc) =
      let
        val ss = size s
        fun aux (j,acc) =
          if j = ss then acc
          else 
            if String.substring (s,j,1) = "*"
              then aux (j+1,(j,i)::acc)
            else aux (j+1,acc)
      in
        aux (0,acc)
      end
    fun scan2 ([],i,acc) = rev acc
      | scan2 (s::rest,i,acc) =
        scan2 (rest,i+1,scan1 (s,i,acc))
  in
    scan2 (sl,0,[])
  end

val crash =
conv
["                                  *       ",
 "                                  * *     ",
 "*                     * *         **      ",
 "* *                   **                  ",
 "**      * *            *            ***   ",
 "        **                          *     ",
 "  ***    *             **            *    ",
 "  *                    * *   *            ",
 "   *     **            *    **            ",
 "         * *   *            * *           ",
 "         *    **    **                    ",
 "              * *   * *                   ",
 "                    *                     ",
 "                                       ** ",
 "                                       * *",
 "                                       *  ",
 "                                          ",
 "                                          ",
 "                            ***           ",
 "                            *             ",
 "                             *            "]


val small_spaceship =
conv
["**** ",
 "*   *",
 "*    ",
 " *   "]

val medium_spaceship=

conv
["***** ",
 "*    *",
 "*     ",
 " *    "]

val wide_ship =
conv
["        *       ",
 " ** *** ***     ",
 " **    *  ** ** ",
 "*  * **   *  ** ",
 "            *  *"]

val stuff = 
conv
[" ****        ",
 "*   *        ",
 "    *        ",
 "   *         ",
 "         ****",
 "        *   *",
 "            *",
 "    **  *  * ",
 "    ***      ",
 "    **  *  * ",
 "            *",
 "        *   *",
 "         ****",
 "   *         ",
 "    *        ",
 "*   *        ",
 " ****        "]

val rabbit =
conv
["*   ***",
 "***  * ",
 " *     "]

val big_glider =
conv
["    *  *          ",
"    *** *         ",
"   **             ",
"  * **   *        ",
"****   ** *       ",
" * *   ****       ",
" *       *        ",
"*   **    * **    ",
" *  **      * *   ",
"   * **         * ",
"    ** *     *  * ",
"               ** ",
"       **        *",
"       *  *    * *",
"        *       **",
"           * *    ",
"         ***  *   ",
"            ***   "]

val slow_ship =
conv
["                                 **      * * ",
"                 *               **     *** *",
"       **       ******           *     **    ",
"       *  *** *       **      *  *  *   *    ",
"      *          *  * **   *    *   *  *     ",
"     **** * *    *   ***   ** *** * *   *    ",
"     **      ***       ***      **   ***     ",
"    *                                  **    ",
" *** *                                       ",
"*  *                                         ",
" *** *                                       ",
"    *                                        ",
"     **      ***       ***      **           ",
"     **** * *    *   ***   ** *** *          ",
"      *          *  * **   *    *            ",
"       *  *** *       **      *  *           ",
"       **       ******           *           ",
"                 *               **          ",
"                                 **          "]
@


1.3.1.1
log
@branched from trunk for label MLWorks_workspace_97
@
text
@a5 4
 *  Revision 1.3  1997/06/16  12:36:46  jkbrook
 *  [Bug #30127]
 *  Merging changes from 1.0r2c1 into 2.0m0
 *
@


1.2
log
@Needs to require String basis library
@
text
@d1 155
a155 151
(*  ==== Needed for Life demo  ====
 *
 *  Copyright (C) 1996 Harlequin Ltd
 *
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.1  1996/10/11  14:14:22  johnh
 *  new unit
 *  Reorganised demo directory to include separate demos for mswindows and motif.
 *
 *
 *)

require "$.basis.__string";

fun conv sl =
  let
    fun scan1 (s,i,acc) =
      let
        val ss = size s
        fun aux (j,acc) =
          if j = ss then acc
          else 
            if String.substring (s,j,1) = "*"
              then aux (j+1,(j,i)::acc)
            else aux (j+1,acc)
      in
        aux (0,acc)
      end
    fun scan2 ([],i,acc) = rev acc
      | scan2 (s::rest,i,acc) =
        scan2 (rest,i+1,scan1 (s,i,acc))
  in
    scan2 (sl,0,[])
  end

val crash =
conv
["                                  *       ",
 "                                  * *     ",
 "*                     * *         **      ",
 "* *                   **                  ",
 "**      * *            *            ***   ",
 "        **                          *     ",
 "  ***    *             **            *    ",
 "  *                    * *   *            ",
 "   *     **            *    **            ",
 "         * *   *            * *           ",
 "         *    **    **                    ",
 "              * *   * *                   ",
 "                    *                     ",
 "                                       ** ",
 "                                       * *",
 "                                       *  ",
 "                                          ",
 "                                          ",
 "                            ***           ",
 "                            *             ",
 "                             *            "]


val small_spaceship =
conv
["**** ",
 "*   *",
 "*    ",
 " *   "]

val medium_spaceship=

conv
["***** ",
 "*    *",
 "*     ",
 " *    "]

val wide_ship =
conv
["        *       ",
 " ** *** ***     ",
 " **    *  ** ** ",
 "*  * **   *  ** ",
 "            *  *"]

val stuff = 
conv
[" ****        ",
 "*   *        ",
 "    *        ",
 "   *         ",
 "         ****",
 "        *   *",
 "            *",
 "    **  *  * ",
 "    ***      ",
 "    **  *  * ",
 "            *",
 "        *   *",
 "         ****",
 "   *         ",
 "    *        ",
 "*   *        ",
 " ****        "]

val rabbit =
conv
["*   ***",
 "***  * ",
 " *     "]

val big_glider =
conv
["    *  *          ",
"    *** *         ",
"   **             ",
"  * **   *        ",
"****   ** *       ",
" * *   ****       ",
" *       *        ",
"*   **    * **    ",
" *  **      * *   ",
"   * **         * ",
"    ** *     *  * ",
"               ** ",
"       **        *",
"       *  *    * *",
"        *       **",
"           * *    ",
"         ***  *   ",
"            ***   "]

val slow_ship =
conv
["                                 **      * * ",
"                 *               **     *** *",
"       **       ******           *     **    ",
"       *  *** *       **      *  *  *   *    ",
"      *          *  * **   *    *   *  *     ",
"     **** * *    *   ***   ** *** * *   *    ",
"     **      ***       ***      **   ***     ",
"    *                                  **    ",
" *** *                                       ",
"*  *                                         ",
" *** *                                       ",
"    *                                        ",
"     **      ***       ***      **           ",
"     **** * *    *   ***   ** *** *          ",
"      *          *  * **   *    *            ",
"       *  *** *       **      *  *           ",
"       **       ******           *           ",
"                 *               **          ",
"                                 **          "]
@


1.2.4.1
log
@branched from 1.2
@
text
@d5 1
a5 4
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.2  1996/11/07  16:49:08  jkbrook
 *  Needs to require String basis library
 *
@


1.2.4.2
log
@[Bug #30127]
Updated copyright.
@
text
@d1 4
a4 4
(*  ==== Needed for Life demo  ====
 *
 *  Copyright (C) 1997 The Harlequin Group Limited.  All rights reserved.
 *
a5 3
 *  Revision 1.2.4.1  1997/05/12  10:23:53  hope
 *  branched from 1.2
 *
d8 147
a154 147
 *
 *  Revision 1.1  1996/10/11  14:14:22  johnh
 *  new unit
 *  Reorganised demo directory to include separate demos for mswindows and motif.
 *
 *
 *)

require "$.basis.__string";

fun conv sl =
  let
    fun scan1 (s,i,acc) =
      let
        val ss = size s
        fun aux (j,acc) =
          if j = ss then acc
          else 
            if String.substring (s,j,1) = "*"
              then aux (j+1,(j,i)::acc)
            else aux (j+1,acc)
      in
        aux (0,acc)
      end
    fun scan2 ([],i,acc) = rev acc
      | scan2 (s::rest,i,acc) =
        scan2 (rest,i+1,scan1 (s,i,acc))
  in
    scan2 (sl,0,[])
  end

val crash =
conv
["                                  *       ",
 "                                  * *     ",
 "*                     * *         **      ",
 "* *                   **                  ",
 "**      * *            *            ***   ",
 "        **                          *     ",
 "  ***    *             **            *    ",
 "  *                    * *   *            ",
 "   *     **            *    **            ",
 "         * *   *            * *           ",
 "         *    **    **                    ",
 "              * *   * *                   ",
 "                    *                     ",
 "                                       ** ",
 "                                       * *",
 "                                       *  ",
 "                                          ",
 "                                          ",
 "                            ***           ",
 "                            *             ",
 "                             *            "]


val small_spaceship =
conv
["**** ",
 "*   *",
 "*    ",
 " *   "]

val medium_spaceship=

conv
["***** ",
 "*    *",
 "*     ",
 " *    "]

val wide_ship =
conv
["        *       ",
 " ** *** ***     ",
 " **    *  ** ** ",
 "*  * **   *  ** ",
 "            *  *"]

val stuff = 
conv
[" ****        ",
 "*   *        ",
 "    *        ",
 "   *         ",
 "         ****",
 "        *   *",
 "            *",
 "    **  *  * ",
 "    ***      ",
 "    **  *  * ",
 "            *",
 "        *   *",
 "         ****",
 "   *         ",
 "    *        ",
 "*   *        ",
 " ****        "]

val rabbit =
conv
["*   ***",
 "***  * ",
 " *     "]

val big_glider =
conv
["    *  *          ",
"    *** *         ",
"   **             ",
"  * **   *        ",
"****   ** *       ",
" * *   ****       ",
" *       *        ",
"*   **    * **    ",
" *  **      * *   ",
"   * **         * ",
"    ** *     *  * ",
"               ** ",
"       **        *",
"       *  *    * *",
"        *       **",
"           * *    ",
"         ***  *   ",
"            ***   "]

val slow_ship =
conv
["                                 **      * * ",
"                 *               **     *** *",
"       **       ******           *     **    ",
"       *  *** *       **      *  *  *   *    ",
"      *          *  * **   *    *   *  *     ",
"     **** * *    *   ***   ** *** * *   *    ",
"     **      ***       ***      **   ***     ",
"    *                                  **    ",
" *** *                                       ",
"*  *                                         ",
" *** *                                       ",
"    *                                        ",
"     **      ***       ***      **           ",
"     **** * *    *   ***   ** *** *          ",
"      *          *  * **   *    *            ",
"       *  *** *       **      *  *           ",
"       **       ******           *           ",
"                 *               **          ",
"                                 **          "]
@


1.2.4.2.3.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r3
@
text
@a5 4
 *  Revision 1.2.4.2  1997/05/15  13:21:37  daveb
 *  [Bug #30127]
 *  Updated copyright.
 *
@


1.2.4.2.2.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_10r2_551
@
text
@a5 4
 *  Revision 1.2.4.2  1997/05/15  13:21:37  daveb
 *  [Bug #30127]
 *  Updated copyright.
 *
@


1.2.4.2.1.1
log
@branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
@
text
@a5 4
 *  Revision 1.2.4.2  1997/05/15  13:21:37  daveb
 *  [Bug #30127]
 *  Updated copyright.
 *
@


1.2.4.2.1.1.1.1
log
@branched from MLWorks_11 for label MLWorks_11r1
@
text
@a5 3
 *  Revision 1.2.4.2.1.1  1997/07/28  18:10:35  daveb
 *  branched from MLWorks_1_0_r2c1_1997_05_12 for label MLWorks_11
 *
@


1.2.3.1
log
@branched from 1.2
@
text
@d5 1
a5 4
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.2  1996/11/07  16:49:08  jkbrook
 *  Needs to require String basis library
 *
@


1.2.3.1.1.1
log
@branched from 1.2.3.1
@
text
@a5 3
 *  Revision 1.2.3.1  1996/12/17  17:38:56  hope
 *  branched from 1.2
 *
@


1.2.2.1
log
@branched from 1.2
@
text
@d5 1
a5 4
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.2  1996/11/07  16:49:08  jkbrook
 *  Needs to require String basis library
 *
@


1.2.1.1
log
@branched from 1.2
@
text
@d5 1
a5 4
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.2  1996/11/07  16:49:08  jkbrook
 *  Needs to require String basis library
 *
@


1.2.1.1.1.1
log
@branched from 1.2.1.1
@
text
@a5 3
 *  Revision 1.2.1.1  1996/11/14  12:39:22  hope
 *  branched from 1.2
 *
@


1.1
log
@new unit
Reorganised demo directory to include separate demos for mswindows and motif.
@
text
@d1 151
a151 145
(*  ==== Needed for Life demo  ====
 *
 *  Copyright (C) 1996 Harlequin Ltd
 *
 * $Log$
 *
 *)

fun conv sl =
  let
    fun scan1 (s,i,acc) =
      let
        val ss = size s
        fun aux (j,acc) =
          if j = ss then acc
          else 
            if String.substring (s,j,1) = "*"
              then aux (j+1,(j,i)::acc)
            else aux (j+1,acc)
      in
        aux (0,acc)
      end
    fun scan2 ([],i,acc) = rev acc
      | scan2 (s::rest,i,acc) =
        scan2 (rest,i+1,scan1 (s,i,acc))
  in
    scan2 (sl,0,[])
  end

val crash =
conv
["                                  *       ",
 "                                  * *     ",
 "*                     * *         **      ",
 "* *                   **                  ",
 "**      * *            *            ***   ",
 "        **                          *     ",
 "  ***    *             **            *    ",
 "  *                    * *   *            ",
 "   *     **            *    **            ",
 "         * *   *            * *           ",
 "         *    **    **                    ",
 "              * *   * *                   ",
 "                    *                     ",
 "                                       ** ",
 "                                       * *",
 "                                       *  ",
 "                                          ",
 "                                          ",
 "                            ***           ",
 "                            *             ",
 "                             *            "]


val small_spaceship =
conv
["**** ",
 "*   *",
 "*    ",
 " *   "]

val medium_spaceship=

conv
["***** ",
 "*    *",
 "*     ",
 " *    "]

val wide_ship =
conv
["        *       ",
 " ** *** ***     ",
 " **    *  ** ** ",
 "*  * **   *  ** ",
 "            *  *"]

val stuff = 
conv
[" ****        ",
 "*   *        ",
 "    *        ",
 "   *         ",
 "         ****",
 "        *   *",
 "            *",
 "    **  *  * ",
 "    ***      ",
 "    **  *  * ",
 "            *",
 "        *   *",
 "         ****",
 "   *         ",
 "    *        ",
 "*   *        ",
 " ****        "]

val rabbit =
conv
["*   ***",
 "***  * ",
 " *     "]

val big_glider =
conv
["    *  *          ",
"    *** *         ",
"   **             ",
"  * **   *        ",
"****   ** *       ",
" * *   ****       ",
" *       *        ",
"*   **    * **    ",
" *  **      * *   ",
"   * **         * ",
"    ** *     *  * ",
"               ** ",
"       **        *",
"       *  *    * *",
"        *       **",
"           * *    ",
"         ***  *   ",
"            ***   "]

val slow_ship =
conv
["                                 **      * * ",
"                 *               **     *** *",
"       **       ******           *     **    ",
"       *  *** *       **      *  *  *   *    ",
"      *          *  * **   *    *   *  *     ",
"     **** * *    *   ***   ** *** * *   *    ",
"     **      ***       ***      **   ***     ",
"    *                                  **    ",
" *** *                                       ",
"*  *                                         ",
" *** *                                       ",
"    *                                        ",
"     **      ***       ***      **           ",
"     **** * *    *   ***   ** *** *          ",
"      *          *  * **   *    *            ",
"       *  *** *       **      *  *           ",
"       **       ******           *           ",
"                 *               **          ",
"                                 **          "]
@


1.1.1.1
log
@branched from 1.1
@
text
@d5 1
a5 5
 * $Log: mswindows:forms.sml,v $
 *  Revision 1.1  1996/10/11  14:14:22  johnh
 *  new unit
 *  Reorganised demo directory to include separate demos for mswindows and motif.
 *
@
